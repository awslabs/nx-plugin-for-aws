---
title: "TypeScript Nx 插件"
description: "生成你自己的 Nx 插件！通过 MCP 自动构建可用于 AI 氛围编码的自定义生成器"
---



import { FileTree } from '@astrojs/starlight/components';
import RunGenerator from '@components/run-generator.astro';
import NxCommands from '@components/nx-commands.astro';
import GeneratorParameters from '@components/generator-parameters.astro';
import Link from '@components/link.astro';
import Snippet from '@components/snippet.astro';
import InstallCommand from '@components/install-command.astro';

生成一个完整的TypeScript [Nx插件](https://nx.dev/extending-nx/intro/getting-started)，包含集成的[模型上下文协议（MCP）](https://modelcontextprotocol.io/)服务器。该生成器为构建自定义生成器奠定基础，这些生成器可被AI助手无缝用于自动化代码生成和项目脚手架。

## 使用方式

### 生成Nx插件

您可以通过两种方式生成TypeScript Nx插件：

<RunGenerator generator="ts#nx-plugin" />

### 选项参数

<GeneratorParameters generator="ts#nx-plugin" />

## 生成器输出

生成器将创建以下项目结构：

<FileTree>
- your-plugin/
  - src/
    - index.ts 插件入口文件
    - mcp-server/
      - index.ts 服务器导出文件
      - server.ts MCP服务器主配置
      - stdio.ts 使用STDIO传输的MCP服务器入口
      - http.ts 使用可流式HTTP传输的MCP服务器入口
      - tools/
        - create-workspace-command.ts 工作区创建指导工具
        - general-guidance.ts Nx通用指导工具
        - list-generators.ts 生成器列表工具
        - generator-guide.ts 生成器详细指南工具
      - utils.ts MCP服务器工具函数
  - generators.json Nx生成器配置（初始为空）
  - package.json 插件包配置（含MCP服务器二进制）
  - tsconfig.json TypeScript配置（兼容Nx的CommonJS）
  - project.json Nx项目配置（含构建和打包目标）
</FileTree>

## 开发Nx插件

### 添加生成器

创建插件项目后，可使用<Link path="/guides/ts-nx-generator">`ts#nx-generator`</Link>生成器添加新生成器：

<RunGenerator generator="ts#nx-generator" requiredParameters={{ pluginProject: 'your-plugin' }} />

:::tip
阅读<Link path="/guides/ts-nx-generator">`ts#nx-generator`指南</Link>了解如何实现生成器
:::

请确保为生成器编写详细的`README.md`，该文件将被MCP服务器的`generator-guide`工具使用。

### 项目目标

生成的插件包含以下重要构建目标：

#### 构建目标
编译TypeScript代码并准备插件：

<NxCommands commands={['build your-plugin']} />

#### 打包目标
创建可发布的NPM包：

<NxCommands commands={['package your-plugin']} />

打包内容包含：
- 编译后的JavaScript文件
- TypeScript声明文件
- 生成器/执行器配置文件
- 文档和许可文件

## MCP服务器集成

插件使用<Link path="/guides/ts-mcp-server">`ts#mcp-server`</Link>生成器配置MCP服务器。

### 工具集

内置MCP服务器为AI助手提供以下工具：

- `general-guidance`: 获取Nx和插件的最佳实践
- `create-workspace-command`: 学习如何创建支持插件的工作区
- `list-generators`: 列出所有可用生成器
- `generator-guide`: 获取生成器详细信息（含模式和使用说明）

### AI助手配置

<Snippet name="mcp/configuration" parentHeading="Configuring with AI Assistants" />

### 自定义MCP服务器

可通过修改`server.ts`添加特定领域的工具或资源。更多细节请参考<Link path="/guides/ts-mcp-server">`ts#mcp-server`指南</Link>。

## 发布插件

### 发布准备

1. **更新包信息**：编辑[`package.json`](https://docs.npmjs.com/cli/v10/configuring-npm/package-json)中的名称、版本、描述和仓库信息

2. **构建包**：
   <NxCommands commands={['package your-plugin']} />

3. **本地测试**：
   ```bash
   npm install /path/to/your/workspace/dist/your-plugin/package
   ```

### 发布到NPM

准备就绪后执行：

```bash
cd dist/your-plugin/package
npm publish
```

### 使用已发布插件

用户可通过以下方式安装：

<InstallCommand pkg="your-plugin-name" />

使用生成器：

<RunGenerator namespace="your-plugin-name" generator="your-generator-name" />

#### 配置AI助手使用插件

已发布插件的MCP服务器配置示例：

```json {3-6}
{
  "mcpServers": {
    "aws-nx-mcp": {
      "command": "npx",
      "args": ["-y", "-p", "your-plugin-name", "your-plugin-name-mcp-server"]
    }
  }
}
```