---
title: "HÆ°á»›ng Dáº«n Báº¯t Äáº§u Nhanh"
description: "HÆ°á»›ng dáº«n nhanh vá» cÃ¡ch sá»­ dá»¥ng @aws/nx-plugin."
---

import { Steps } from '@astrojs/starlight/components';
import Link from '@components/link.astro';
import Snippet from '@components/snippet.astro';
import CreateNxWorkspaceCommand from '@components/create-nx-workspace-command.astro';
import PackageManagerShortCommand from '@components/package-manager-short-command.astro';
import InstallCommand from '@components/install-command.astro';
import RunGenerator from '@components/run-generator.astro';
import NxCommands from '@components/nx-commands.astro';
import Infrastructure from '@components/infrastructure.astro';

HÆ°á»›ng dáº«n nÃ y sáº½ hÆ°á»›ng dáº«n báº¡n cÃ¡c bÆ°á»›c cÆ¡ báº£n Ä‘á»ƒ cÃ i Ä‘áº·t vÃ  sá»­ dá»¥ng `@aws/nx-plugin` Ä‘á»ƒ xÃ¢y dá»±ng nhanh cÃ¡c dá»± Ã¡n trÃªn AWS.

:::tip
Äá»ƒ cÃ³ hÆ°á»›ng dáº«n chi tiáº¿t hÆ¡n vá» viá»‡c xÃ¢y dá»±ng má»™t á»©ng dá»¥ng full-stack, hÃ£y xem <Link path="get_started/tutorials/dungeon-game/overview">HÆ°á»›ng dáº«n Dungeon Adventure</Link>.
:::

## YÃªu cáº§u trÆ°á»›c

CÃ¡c phá»¥ thuá»™c toÃ n cá»¥c sau lÃ  cáº§n thiáº¿t trÆ°á»›c khi tiáº¿p tá»¥c:

<Snippet name="prerequisites" />

## BÆ°á»›c 1: Khá»Ÿi táº¡o Nx Workspace má»›i

Cháº¡y lá»‡nh sau Ä‘á»ƒ táº¡o má»™t Nx workspace vá»›i trÃ¬nh quáº£n lÃ½ gÃ³i mÃ  báº¡n chá»n:

<CreateNxWorkspaceCommand workspace="my-project" />

:::tip
Báº¡n sáº½ Ä‘Æ°á»£c nháº¯c chá»n nhÃ  cung cáº¥p infrastructure as code (IaC) Æ°a thÃ­ch, cÃ³ thá»ƒ lÃ  [CDK](https://docs.aws.amazon.com/cdk/) hoáº·c [Terraform](https://developer.hashicorp.com/terraform). Báº¡n cÃ³ thá»ƒ bá» qua lá»i nháº¯c báº±ng cÃ¡ch cháº¡y lá»‡nh vá»›i `--iacProvider`, vÃ­ dá»¥:

<Infrastructure>
<Fragment slot="cdk">
<CreateNxWorkspaceCommand workspace="my-project" iacProvider="CDK" />
</Fragment>
<Fragment slot="terraform">
<CreateNxWorkspaceCommand workspace="my-project" iacProvider="Terraform" />
</Fragment>
</Infrastructure>
:::

Sau khi hoÃ n táº¥t, Ä‘iá»u hÆ°á»›ng Ä‘áº¿n thÆ° má»¥c dá»± Ã¡n:

```sh
cd my-project
```

## BÆ°á»›c 2: Sá»­ dá»¥ng Generators Ä‘á»ƒ Táº¡o khung Dá»± Ã¡n

ChÃºng ta sáº½ thÃªm má»™t tRPC API, React Website, Cognito Authentication, vÃ  CDK hoáº·c Terraform Infrastructure trong hÆ°á»›ng dáº«n nhanh nÃ y. TÃ¹y thuá»™c vÃ o loáº¡i dá»± Ã¡n báº¡n Ä‘ang xÃ¢y dá»±ng, báº¡n cÃ³ thá»ƒ chá»n báº¥t ká»³ tá»• há»£p nÃ o cá»§a cÃ¡c generators Ä‘á»ƒ nhanh chÃ³ng khá»Ÿi táº¡o dá»± Ã¡n cá»§a mÃ¬nh. Xem pháº§n __Guides__ trong thanh Ä‘iá»u hÆ°á»›ng bÃªn trÃ¡i Ä‘á»ƒ xem danh sÃ¡ch Ä‘áº§y Ä‘á»§ cÃ¡c tÃ¹y chá»n.

### ThÃªm tRPC API

<RunGenerator generator="ts#trpc-api" requiredParameters={{ name: 'demo-api', auth: 'IAM' }} />

Lá»‡nh nÃ y sáº½ táº¡o API bÃªn trong thÆ° má»¥c `packages/demo-api`.

### ThÃªm React Website

<RunGenerator generator="ts#react-website" requiredParameters={{ name: 'demo-website' }} />

Lá»‡nh nÃ y táº¡o khung má»™t React website má»›i trong `packages/demo-website`.

### ThÃªm Cognito Authentication

<RunGenerator generator="ts#react-website#auth" requiredParameters={{ project: '@my-project/demo-website', cognitoDomain: 'my-demo' }} />

Lá»‡nh nÃ y thiáº¿t láº­p cÆ¡ sá»Ÿ háº¡ táº§ng cáº§n thiáº¿t vÃ  mÃ£ React Ä‘á»ƒ thÃªm Cognito Authentication vÃ o website cá»§a báº¡n.

### Káº¿t ná»‘i Frontend vá»›i Backend

<RunGenerator generator="connection" requiredParameters={{ sourceProject: '@my-project/demo-website', targetProject: '@my-project/demo-api' }} />

Lá»‡nh nÃ y cáº¥u hÃ¬nh cÃ¡c providers cáº§n thiáº¿t Ä‘á»ƒ Ä‘áº£m báº£o website cá»§a báº¡n cÃ³ thá»ƒ gá»i tRPC API.

### ThÃªm Infrastructure

ThÃªm dá»± Ã¡n infrastructure dá»±a trÃªn nhÃ  cung cáº¥p IAC báº¡n Ä‘Ã£ chá»n.

<Infrastructure>
<Fragment slot="cdk">
<RunGenerator generator="ts#infra" requiredParameters={{ name: 'infra' }} />

Lá»‡nh nÃ y cáº¥u hÃ¬nh má»™t CDK App mÃ  báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘á»ƒ triá»ƒn khai cÆ¡ sá»Ÿ háº¡ táº§ng cá»§a mÃ¬nh trÃªn AWS.
</Fragment>
<Fragment slot="terraform">
<RunGenerator generator="terraform#project" requiredParameters={{ name: 'infra' }} />

Lá»‡nh nÃ y cáº¥u hÃ¬nh má»™t dá»± Ã¡n Terraform mÃ  báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘á»ƒ triá»ƒn khai cÆ¡ sá»Ÿ háº¡ táº§ng cá»§a mÃ¬nh trÃªn AWS.
</Fragment>
</Infrastructure>

## BÆ°á»›c 3: Cháº¡y Website vÃ  API cá»§a báº¡n á»Ÿ Local

Sá»­ dá»¥ng lá»‡nh sau Ä‘á»ƒ khá»Ÿi Ä‘á»™ng cÃ¡c dev server local cho website vÃ  cÃ¡c API Ä‘Æ°á»£c káº¿t ná»‘i:

<NxCommands commands={['run demo-website:serve-local']} />

Website cá»§a báº¡n sáº½ cÃ³ sáºµn táº¡i `http://localhost:4200`.

CÃ¡c thay Ä‘á»•i Ä‘á»‘i vá»›i cáº£ website vÃ  API cá»§a báº¡n sáº½ Ä‘Æ°á»£c pháº£n Ã¡nh theo thá»i gian thá»±c vÃ¬ cáº£ website local vÃ  API server Ä‘á»u sáº½ hot-reload.

## BÆ°á»›c 4: Äá»‹nh nghÄ©a Cloud Resources vÃ  Triá»ƒn khai lÃªn AWS

<Infrastructure>
<Fragment slot="cdk">
Má»Ÿ `packages/infra/src/stacks/application-stack.ts` vÃ  thÃªm Ä‘oáº¡n mÃ£ sau:

```typescript
import * as cdk from 'aws-cdk-lib';
import { DemoApi, DemoWebsite, UserIdentity } from ':my-project/common-constructs';
import { Construct } from 'constructs';

export class ApplicationStack extends cdk.Stack {
  constructor(scope: Construct, id: string, props?: cdk.StackProps) {
    super(scope, id, props);

    const identity = new UserIdentity(this, 'identity');
    const api = new DemoApi(this, 'api', {
      integrations: DemoApi.defaultIntegrations(this).build(),
    });
    api.grantInvokeAccess(identity.identityPool.authenticatedRole);

    new DemoWebsite(this, 'website');
  }
}
```

ÄÃ¢y lÃ  táº¥t cáº£ CDK chÃºng ta cáº§n viáº¿t Ä‘á»ƒ triá»ƒn khai á»©ng dá»¥ng full stack cá»§a mÃ¬nh.
</Fragment>
<Fragment slot="terraform">
Má»Ÿ `packages/infra/src/main.tf` vÃ  thÃªm Ä‘oáº¡n mÃ£ sau:

```hcl
# Include metrics tracking for @aws/nx-plugin usage
module "metrics" {
  source = "../../common/terraform/src/metrics"
}

# Deploy user identity
module "user_identity" {
  source = "../../common/terraform/src/core/user-identity"
}

# Deploy API
module "demo_api" {
  source = "../../common/terraform/src/app/apis/demo-api"
}

# Grant authenticated users access to invoke the API
resource "aws_iam_policy" "api_invoke_policy" {
  name        = "DemoApiInvokePolicy"
  description = "Policy to allow authenticated users to invoke the API"

  policy = jsonencode({
    Version = "2012-10-17"
    Statement = [
      {
        Effect = "Allow"
        Action = "execute-api:Invoke"
        Resource = "${module.demo_api.api_execution_arn}/*/*"
      }
    ]
  })
}

resource "aws_iam_role_policy_attachment" "authenticated_api_access" {
  role       = module.user_identity.authenticated_role_name
  policy_arn = aws_iam_policy.api_invoke_policy.arn
}

# Deploy website
provider "aws" {
  alias  = "us_east_1"
  region = "us-east-1"
}

module "demo_website" {
  source = "../../common/terraform/src/app/static-websites/demo-website"

  providers = {
    aws.us_east_1 = aws.us_east_1
  }

  depends_on = [module.user_identity, module.demo_api]
}
```

ÄÃ¢y lÃ  táº¥t cáº£ Terraform chÃºng ta cáº§n viáº¿t Ä‘á»ƒ triá»ƒn khai á»©ng dá»¥ng full stack cá»§a mÃ¬nh.
</Fragment>
</Infrastructure>

### Build vÃ  Deploy Infrastructure

Tiáº¿p theo, cháº¡y lá»‡nh sau Ä‘á»ƒ build dá»± Ã¡n cá»§a báº¡n:

<PackageManagerShortCommand commands={["build"]} />

:::tip
Náº¿u báº¡n gáº·p báº¥t ká»³ lá»—i lint nÃ o, báº¡n cÃ³ thá»ƒ cháº¡y lá»‡nh sau Ä‘á»ƒ tá»± Ä‘á»™ng sá»­a chÃºng.

<PackageManagerShortCommand commands={["lint"]} />
:::

Bootstrap cÆ¡ sá»Ÿ háº¡ táº§ng cá»§a báº¡n:

<Infrastructure>
<Fragment slot="cdk">
<NxCommands commands={['run infra:bootstrap']} />

:::tip
CDK bootstrapping lÃ  báº¯t buá»™c cho cáº£ AWS region triá»ƒn khai má»¥c tiÃªu cá»§a báº¡n vÃ  `us-east-1` Ä‘á»ƒ cho phÃ©p triá»ƒn khai AWS WAF WebACL cho website.
:::
</Fragment>
<Fragment slot="terraform">
<NxCommands commands={['run infra:bootstrap']} />

:::tip
Terraform bootstrapping táº¡o má»™t S3 bucket Ä‘á»ƒ lÆ°u trá»¯ cÃ¡c tá»‡p state Terraform cá»§a báº¡n. Äiá»u nÃ y chá»‰ cáº§n thá»±c hiá»‡n má»™t láº§n cho má»—i tá»• há»£p AWS account/region.
:::
</Fragment>
</Infrastructure>

Triá»ƒn khai dá»± Ã¡n cá»§a báº¡n:

<Infrastructure>
<Fragment slot="cdk">
<NxCommands commands={['run infra:deploy "my-project-sandbox/*"']} />
</Fragment>
<Fragment slot="terraform">
<NxCommands commands={['run infra:apply']} />

:::tip
Lá»‡nh nÃ y trÆ°á»›c tiÃªn sáº½ cháº¡y `terraform plan` Ä‘á»ƒ hiá»ƒn thá»‹ nhá»¯ng thay Ä‘á»•i sáº½ Ä‘Æ°á»£c thá»±c hiá»‡n, sau Ä‘Ã³ Ã¡p dá»¥ng cÃ¡c thay Ä‘á»•i Ä‘Ã³ Ä‘á»ƒ triá»ƒn khai cÆ¡ sá»Ÿ háº¡ táº§ng cá»§a báº¡n.
:::
</Fragment>
</Infrastructure>

## BÆ°á»›c 5: Kiá»ƒm tra Website vá»›i Cloud Resources Ä‘Ã£ Triá»ƒn khai

<Steps>
1. Láº¥y tá»‡p `runtime-config.json`:

    <NxCommands commands={['run demo-website:load:runtime-config']} />

2. Khá»Ÿi Ä‘á»™ng local website server

    <NxCommands commands={['run demo-website:serve']} />
</Steps>

Website cá»§a báº¡n sáº½ cÃ³ sáºµn táº¡i `http://localhost:4200`, vÃ  sáº½ trá» Ä‘áº¿n cÃ¡c tÃ i nguyÃªn báº¡n Ä‘Ã£ triá»ƒn khai cho API vÃ  authentication.

---

ChÃºc má»«ng! ğŸ‰ Báº¡n Ä‘Ã£ xÃ¢y dá»±ng vÃ  triá»ƒn khai thÃ nh cÃ´ng má»™t á»©ng dá»¥ng full-stack báº±ng cÃ¡ch sá»­ dá»¥ng `@aws/nx-plugin`!