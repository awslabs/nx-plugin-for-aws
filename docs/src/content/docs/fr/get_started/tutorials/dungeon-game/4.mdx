---
title: "Jeu de Donjon IA"
description: "Un guide pas √† pas pour construire un jeu d'aventure de donjon aliment√© par l'IA en utilisant le @aws/nx-plugin."
---



import { Aside, Code, FileTree, Steps, Tabs, TabItem } from '@astrojs/starlight/components';
import { Image } from 'astro:assets';
import Drawer from '@components/drawer.astro';
import RunGenerator from '@components/run-generator.astro';
import NxCommands from '@components/nx-commands.astro';
import InstallCommand from '@components/install-command.astro';
import E2ECode from '@components/e2e-code.astro';
import E2EDiff from '@components/e2e-diff.astro';

import dungeonAdventureArchitecturePng from '@assets/dungeon-game-architecture.png'
import dungeonAdventureErPng from '@assets/dungeon-adventure-er.png'
import baselineWebsitePng from '@assets/baseline-website.png'
import baselineGamePng from '@assets/baseline-game.png'
import nxGraphPng from '@assets/nx-graph.png'
import gameSelectPng from '@assets/game-select.png'
import gameConversationPng from '@assets/game-conversation.png'

## Module 4 : Impl√©mentation de l'interface utilisateur

Pour commencer √† d√©velopper l'interface utilisateur, nous devons configurer notre serveur de d√©veloppement local pour pointer vers notre sandbox d√©ploy√©. Ex√©cutez la commande suivante :

<NxCommands commands={["run @dungeon-adventure/game-ui:load:runtime-config"]} />

Cette commande r√©cup√©rera le fichier `runtime-config.json` d√©ploy√© et le stockera localement dans le dossier `packages/game-ui/public`.

D√©marrez maintenant le serveur de d√©veloppement avec la commande suivante :

<NxCommands commands={["run @dungeon-adventure/game-ui:serve"]} />

Vous pouvez ensuite ouvrir le site local dans un navigateur. Vous serez invit√© √† vous connecter et √† cr√©er un nouvel utilisateur. Une fois termin√©, vous devriez voir le site de base :

<Image src={baselineWebsitePng} alt="baseline-website.png" width="800" height="600" />

<Aside type="caution">
_Nous garderons le serveur de d√©veloppement en fonctionnement pendant le reste de ce module, car il rechargera automatiquement toutes les modifications apport√©es._
</Aside>

### Cr√©er une nouvelle route '/game'

D√©montrons les capacit√©s de `@tanstack/react-router` en cr√©ant une nouvelle route typ√©e. Cr√©ez simplement un fichier vide √† l'emplacement suivant : `packages/game-ui/src/routes/game/index.tsx`. Surveillez les logs du serveur :

```bash
‚ôªÔ∏è  Regenerating routes...
üü° Updating /Users/dimecha/dungeon-adventure/packages/game-ui/src/routes/game/index.tsx
üü° Updating /Users/dimecha/dungeon-adventure/packages/game-ui/src/routeTree.gen.ts
‚úÖ Processed routes in 27ms
```

Le routeur `@tanstack/react-router` a automatiquement configur√© votre nouvelle route. Le fichier cr√©√© contient d√©j√† le chemin de la route :

```tsx
import { createFileRoute } from '@tanstack/react-router'

export const Route = createFileRoute('/game/')({
  component: RouteComponent,
})

function RouteComponent() {
  return <div>Hello "/game/"!</div>
}
```

Naviguez maintenant vers `http://localhost:4200/game` pour voir votre nouvelle page !

<Image src={baselineGamePng} alt="baseline-game.png" width="800" height="600" />

Mettons √©galement √† jour le fichier `index.tsx` pour charger notre nouvelle route `/game` par d√©faut. Notez que le champ `to` propose une liste de routes typ√©es.

<E2EDiff before="dungeon-adventure/4/routes/index.tsx.old.template" after="dungeon-adventure/4/routes/index.tsx.template" lang="tsx" />

Supprimez enfin le dossier `packages/game-ui/src/routes/welcome/` qui n'est plus n√©cessaire.

### Modifications du layout

Le layout par d√©faut est plus adapt√© √† une application SaaS qu'√† un jeu. Reconfigurons-le avec un th√®me style donjon.

Apportez ces modifications dans `packages/game-ui/src` :

<Tabs>
<TabItem label="config.ts">
<E2EDiff before="dungeon-adventure/4/config.ts.old.template" after="dungeon-adventure/4/config.ts.template" lang="typescript" />
</TabItem>
<TabItem label="components/AppLayout/index.tsx">
<E2ECode path="dungeon-adventure/4/AppLayout/index.tsx.template" lang="tsx" />
</TabItem>
<TabItem label="styles.css">
<E2ECode path="dungeon-adventure/4/styles.css.template" lang="css" />
</TabItem>
</Tabs>

Supprimez les fichiers `packages/game-ui/src/components/AppLayout/navitems.ts` et `packages/game-ui/src/hooks/useAppLayout.tsx` qui ne sont plus utilis√©s.

### Pages du jeu

Cr√©ons les pages du jeu qui appelleront nos APIs :

<Tabs>
<TabItem label="index.tsx">
<E2ECode path="dungeon-adventure/4/routes/game/index.tsx.template" lang="tsx" />
</TabItem>
<TabItem label="$playerName.tsx">

<E2ECode path="dungeon-adventure/4/routes/game/$playerName.tsx.template" lang="tsx" />

<Aside type="tip">
La syntaxe `$playerName` indique √† `@tanstack/react-router` de traiter `playerName` comme un [param√®tre de chemin](https://tanstack.com/router/v1/docs/framework/react/guide/path-params). La m√©thode `validateSearch` garantit que le param√®tre `genre` est fortement typ√© selon notre enum.
</Aside>
</TabItem>
</Tabs>

Apr√®s ces modifications, votre serveur local (http://localhost:4200/) devrait afficher le jeu pr√™t √† √™tre jou√© !

<Drawer title="Build et d√©ploiement" trigger="Vous pouvez √©galement construire & d√©ployer votre code sur Cloudfront si vous pr√©f√©rez.">

Pour construire le code :

<NxCommands commands={['run-many --target build --all']} />

D√©ployez l'application avec :

<NxCommands commands={['run @dungeon-adventure/infra:deploy dungeon-adventure-infra-sandbox/*']} />

Une fois d√©ploy√©, acc√©dez √† l'URL Cloudfront via les sorties du d√©ploiement CDK.

</Drawer>

<Image src={gameSelectPng} alt="game-select.png" width="500" height="400" />
<div style="margin-top: -100px; margin-left: 100px;">
<Image src={gameConversationPng} alt="game-conversation.png" width="500" height="400" />
</div>

F√©licitations. Vous avez construit et d√©ploy√© votre jeu Dungeon Adventure ! üéâüéâüéâ