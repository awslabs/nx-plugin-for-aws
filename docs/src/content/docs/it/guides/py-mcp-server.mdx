---
title: "Server MCP Python"
description: "Genera un server del Protocollo di Contesto del Modello (MCP) Python per fornire contesto ai Modelli di Linguaggio di Grandi Dimensioni"
---



import { FileTree } from '@astrojs/starlight/components';
import RunGenerator from '@components/run-generator.astro';
import NxCommands from '@components/nx-commands.astro';
import Link from '@components/link.astro';
import Snippet from '@components/snippet.astro';
import GeneratorParameters from '@components/generator-parameters.astro';

Genera un server Python [Model Context Protocol (MCP)](https://modelcontextprotocol.io/) per fornire contesto a Large Language Models (LLMs), con opzione di deploy su [Amazon Bedrock AgentCore](https://docs.aws.amazon.com/bedrock-agentcore/latest/devguide/).

## Cos'è l'MCP?

Il [Model Context Protocol (MCP)](https://modelcontextprotocol.io/) è uno standard aperto che permette agli assistenti AI di interagire con strumenti e risorse esterne. Fornisce un modo consistente per i LLM di:

- Eseguire strumenti (funzioni) che compiono azioni o recuperano informazioni
- Accedere a risorse che forniscono contesto o dati

## Utilizzo

### Genera un server MCP

Puoi generare un server MCP Python in due modi:

<RunGenerator generator="py#mcp-server" />

:::tip
Prima utilizza il generatore <Link path="/guides/python-project">`py#project`</Link> per creare un progetto a cui aggiungere il tuo server MCP.
:::

### Opzioni

<GeneratorParameters generator="py#mcp-server" />

## Output del generatore

Il generatore aggiungerà questi file al tuo progetto Python esistente:

<FileTree>
  - your-project/
    - your_module/
      - mcp_server/ (o nome personalizzato se specificato)
        - \_\_init\_\_.py Inizializzazione pacchetto Python
        - server.py Definizione principale del server con strumenti e risorse di esempio
        - stdio.py Punto d'ingresso per trasporto STDIO, utile per server MCP locali semplici
        - http.py Punto d'ingresso per trasporto HTTP Streamable, utile per hostare il server MCP
        - Dockerfile Punto d'ingresso per hostare il server MCP (escluso quando `computeType` è impostato a `None`)
    - pyproject.toml Aggiornato con dipendenze MCP
    - project.json Aggiornato con target di servizio del server MCP
</FileTree>

:::note
A meno che non sia stato selezionato `None` per `computeType`, il generatore creerà anche un costrutto CDK per deployare il server MCP.
:::

## Lavorare con il server MCP

### Aggiungere strumenti

Gli strumenti sono funzioni che l'assistente AI può chiamare per eseguire azioni. Il server MCP Python utilizza la libreria [MCP Python SDK (FastMCP)](https://github.com/modelcontextprotocol/python-sdk), che fornisce un approccio basato su decoratori per definire strumenti.

Puoi aggiungere nuovi strumenti nel file `server.py`:

```python
@mcp.tool(description="Your tool description")
def your_tool_name(param1: str, param2: int) -> str:
    """Tool implementation with type hints"""
    # Your tool logic here
    return f"Result: {param1} with {param2}"
```

La libreria FastMCP gestisce automaticamente:
- Validazione dei tipi basata sui type hint della funzione
- Generazione dello schema JSON per il protocollo MCP
- Gestione errori e formattazione delle risposte

### Aggiungere risorse

Le risorse forniscono contesto all'assistente AI. Puoi aggiungerle usando il decoratore `@mcp.resource`:

```python
@mcp.resource("example://static-resource", description="Static resource example")
def static_resource() -> str:
    """Return static content"""
    return "This is static content that provides context to the AI"

@mcp.resource("dynamic://resource/{item_id}", description="Dynamic resource example")
def dynamic_resource(item_id: str) -> str:
    """Return dynamic content based on parameters"""
    # Fetch data based on item_id
    data = fetch_data_for_item(item_id)
    return f"Dynamic content for {item_id}: {data}"
```

## Configurazione con assistenti AI

<Snippet name="mcp/configuration-py" parentHeading="Configurazione con assistenti AI" />

## Esecuzione del server MCP

### Inspector

Il generatore configura un target chiamato `<your-server-name>-inspect` che avvia l'[MCP Inspector](https://github.com/modelcontextprotocol/inspector) con la configurazione per connettersi al server MCP usando trasporto STDIO.

<NxCommands commands={['run your-project:your-server-name-inspect']} />

Questo avvierà l'inspector su `http://localhost:6274`. Inizia cliccando sul pulsante "Connect".

### STDIO

Il modo più semplice per testare e usare un server MCP è utilizzare l'inspector o configurarlo con un assistente AI (come sopra).

Puoi comunque eseguire il server con trasporto [STDIO](https://modelcontextprotocol.io/docs/concepts/transports#standard-input%2Foutput-stdio) direttamente usando il target `<your-server-name>-serve-stdio`.

<NxCommands commands={['run your-project:your-server-name-serve-stdio']} />

Questo comando usa `uv run` per eseguire il server MCP con trasporto STDIO.

### HTTP Streamable

Se vuoi eseguire il server MCP localmente usando trasporto [HTTP Streamable](https://modelcontextprotocol.io/docs/concepts/transports#streamable-http), puoi usare il target `<your-server-name>-serve-http`.

<NxCommands commands={['run your-project:your-server-name-serve-http']} />

Questo comando usa `uv run` per eseguire il server MCP con trasporto HTTP, tipicamente sulla porta 8000.

## Deploy del server MCP su Bedrock AgentCore Runtime

<Snippet name="mcp/bedrock-deployment" parentHeading="Deploy del server MCP su Bedrock AgentCore Runtime" />

### Target Bundle e Docker

Per costruire il server MCP per Bedrock AgentCore Runtime, viene aggiunto un target `bundle` che:

- Esporta le dipendenze Python in un file `requirements.txt` usando `uv export`
- Installa le dipendenze per la piattaforma target (`aarch64-manylinux2014`) usando `uv pip install`

Viene anche aggiunto un target `docker` specifico per il server MCP che:

- Costruisce un'immagine docker dal `Dockerfile` che esegue il server MCP sulla porta `8000`, come da [contratto protocollo MCP](https://docs.aws.amazon.com/bedrock-agentcore/latest/devguide/runtime-service-contract.html#mcp-protocol-contract)

:::tip
L'immagine docker è costruita usando un tag (esempio `my-scope-my-project-mcp-server:latest`), che il `Dockerfile` del costrutto CDK eredita, permettendo al tuo `Dockerfile` di essere collocato insieme al progetto del server MCP.
:::

### Osservabilità

<Snippet name="mcp/observability" parentHeading="Osservabilità" />