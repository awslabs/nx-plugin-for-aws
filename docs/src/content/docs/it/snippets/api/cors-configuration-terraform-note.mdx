---
title: "Configurazione CORS con Terraform"
---

import Link from '@components/link.astro';

:::note
Se la tua soluzione include un modulo Terraform per il sito web, puoi utilizzare il suo nome di dominio CloudFront per limitare CORS.
Dato un nome di dominio CloudFront `<domain_name>`, all'interno del modulo Terraform per il deployment della tua API aggiungi
- una proprietà `cors_allow_origins`, impostata a `["http://localhost:4200", "http://localhost:4300", "https://<domain name>"]`, per le API HTTP. Questo limita il CORS dell'API gateway a questa distribuzione e al local host.
- una variabile d'ambiente `ALLOWED_ORIGINS`, impostata a `"https://<domain_name>"`, per le API REST. Questo imposta la distribuzione CloudFront come unica origine CORS consentita (oltre al local host) nelle integrazioni AWS Lambda. Nota che questa restrizione non viene applicata al preflight OPTIONS - per favore metti +1 a [questa issue su GitHub](https://github.com/awslabs/nx-plugin-for-aws/issues/377) per aiutare a dare priorità alla risoluzione di questo problema.

```hcl {4,7}
module "my_api" {
  source = "../../common/terraform/src/app/apis/my-api"

  cors_allow_origins = ["http://localhost:4200", "http://localhost:4300", "https://<domain name>"] // Only required for HTTP API

  env = {
    ALLOWED_ORIGINS = "https://<domain name>" // Only required for REST API
    ENVIRONMENT = var.environment
    LOG_LEVEL   = "INFO"
  }
}
```
Il costrutto `MyWebsite` può essere generato utilizzando il <Link path="/guides/react-website">generatore `ts#react-website`</Link>
:::