---
title: "Configuração CORS Terraform"
---

import Link from '@components/link.astro';

:::note
Se sua solução incluir um módulo de website Terraform, você pode usar seu nome de domínio CloudFront para restringir CORS.
Dado um nome de domínio CloudFront `<domain_name>`, dentro do módulo Terraform para implantar sua API adicione
- uma propriedade `cors_allow_origins`, definida como `["http://localhost:4200", "http://localhost:4300", "https://<domain name>"]`, para APIs HTTP. Isso restringe o CORS do gateway de API a esta distribuição e ao host local.
- uma variável de ambiente `ALLOWED_ORIGINS`, definida como `"https://<domain_name>"`, para APIs REST. Isso define a distribuição CloudFront como a única origem CORS permitida (além do host local) nas integrações AWS Lambda. Observe que essa restrição não é aplicada ao preflight OPTIONS - por favor +1 [neste issue do GitHub](https://github.com/awslabs/nx-plugin-for-aws/issues/377) para ajudar a priorizar a solução deste problema.

```hcl {4,7}
module "my_api" {
  source = "../../common/terraform/src/app/apis/my-api"

  cors_allow_origins = ["http://localhost:4200", "http://localhost:4300", "https://<domain name>"] // Only required for HTTP API

  env = {
    ALLOWED_ORIGINS = "https://<domain name>" // Only required for REST API
    ENVIRONMENT = var.environment
    LOG_LEVEL   = "INFO"
  }
}
```
O construtor `MyWebsite` pode ser gerado usando o <Link path="/guides/react-website">gerador `ts#react-website`</Link>
:::