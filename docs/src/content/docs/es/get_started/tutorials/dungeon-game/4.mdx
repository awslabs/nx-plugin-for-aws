---
title: "Juego de Mazmorra con IA"
description: "Un tutorial de c√≥mo construir un juego de aventuras de mazmorra con IA utilizando el @aws/nx-plugin."
---



import { Aside, Code, FileTree, Steps, Tabs, TabItem } from '@astrojs/starlight/components';
import { Image } from 'astro:assets';
import Drawer from '@components/drawer.astro';
import RunGenerator from '@components/run-generator.astro';
import NxCommands from '@components/nx-commands.astro';
import InstallCommand from '@components/install-command.astro';
import E2ECode from '@components/e2e-code.astro';
import E2EDiff from '@components/e2e-diff.astro';

import dungeonAdventureArchitecturePng from '@assets/dungeon-game-architecture.png'
import dungeonAdventureErPng from '@assets/dungeon-adventure-er.png'
import baselineWebsitePng from '@assets/baseline-website.png'
import baselineGamePng from '@assets/baseline-game.png'
import nxGraphPng from '@assets/nx-graph.png'
import gameSelectPng from '@assets/game-select.png'
import gameConversationPng from '@assets/game-conversation.png'

## M√≥dulo 4: Implementaci√≥n de la interfaz de usuario

Para comenzar a construir la interfaz de usuario, necesitamos configurar nuestro servidor de desarrollo local para apuntar a nuestro sandbox desplegado. Ejecuta el siguiente comando:

<NxCommands commands={["run @dungeon-adventure/game-ui:load:runtime-config"]} />

Este comando descargar√° el archivo `runtime-config.json` que est√° desplegado y lo almacenar√° localmente en la carpeta `packages/game-ui/public`.

Ahora podemos iniciar el servidor de desarrollo con el siguiente comando:

<NxCommands commands={["run @dungeon-adventure/game-ui:serve"]} />

Luego puedes abrir el sitio web local en tu navegador, donde se te pedir√° iniciar sesi√≥n y seguir las instrucciones para crear un nuevo usuario. Una vez completado, deber√≠as ver el sitio base:

<Image src={baselineWebsitePng} alt="baseline-website.png" width="800" height="600" />

<Aside type="caution">
_Mantendremos el servidor de desarrollo en ejecuci√≥n durante el resto de este m√≥dulo, ya que recargar√° autom√°ticamente los cambios que realicemos._
</Aside>

### Crear una nueva ruta '/game'

Demostremos las capacidades de `@tanstack/react-router` creando una nueva ruta tipada. Para hacerlo, simplemente crea un archivo vac√≠o en la siguiente ubicaci√≥n: `packages/game-ui/src/routes/game/index.tsx`. Presta atenci√≥n a los logs del servidor de desarrollo:

```bash
‚ôªÔ∏è  Regenerating routes...
üü° Updating /Users/dimecha/dungeon-adventure/packages/game-ui/src/routes/game/index.tsx
üü° Updating /Users/dimecha/dungeon-adventure/packages/game-ui/src/routeTree.gen.ts
‚úÖ Processed routes in 27ms
```

El `@tanstack/react-router` ha configurado autom√°ticamente tu nueva ruta y notar√°s que el archivo que acabas de crear ya contiene la ruta:

```tsx
import { createFileRoute } from '@tanstack/react-router'

export const Route = createFileRoute('/game/')({
  component: RouteComponent,
})

function RouteComponent() {
  return <div>Hello "/game/"!</div>
}
```

Si navegas a `http://localhost:4200/game` ¬°ver√°s que tu nueva p√°gina se ha renderizado!

<Image src={baselineGamePng} alt="baseline-game.png" width="800" height="600" />

Actualicemos tambi√©n el archivo `index.tsx` para cargar nuestra nueva ruta `/game` por defecto. Observa c√≥mo al actualizar el campo `to`, tienes una lista de rutas tipadas para elegir.

<E2EDiff before="dungeon-adventure/4/routes/index.tsx.old.template" after="dungeon-adventure/4/routes/index.tsx.template" lang="tsx" />

Finalmente, podemos eliminar la carpeta `packages/game-ui/src/routes/welcome/` ya que no es necesaria.

### Actualizaciones de layout

El dise√±o predeterminado est√° m√°s orientado a aplicaciones empresariales estilo SaaS que a un juego. Reconfiguraremos el dise√±o y aplicaremos un tema m√°s acorde a un juego de mazmorras.

Realicemos los siguientes cambios en `packages/game-ui/src`:

<Tabs>
<TabItem label="config.ts">
<E2EDiff before="dungeon-adventure/4/config.ts.old.template" after="dungeon-adventure/4/config.ts.template" lang="typescript" />
</TabItem>
<TabItem label="components/AppLayout/index.tsx">
<E2ECode path="dungeon-adventure/4/AppLayout/index.tsx.template" lang="tsx" />
</TabItem>
<TabItem label="styles.css">
<E2ECode path="dungeon-adventure/4/styles.css.template" lang="css" />
</TabItem>
</Tabs>

Ahora eliminemos los archivos `packages/game-ui/src/components/AppLayout/navitems.ts` y `packages/game-ui/src/hooks/useAppLayout.tsx` ya que no se usan.

### P√°ginas del juego

Creemos las p√°ginas del juego que consumir√°n nuestras APIs y completar√°n la implementaci√≥n:

<Tabs>
<TabItem label="index.tsx">
<E2ECode path="dungeon-adventure/4/routes/game/index.tsx.template" lang="tsx" />
</TabItem>
<TabItem label="$playerName.tsx">

<E2ECode path="dungeon-adventure/4/routes/game/$playerName.tsx.template" lang="tsx" />

<Aside type="tip">
La sintaxis `$playerName` indica a `@tanstack/react-router` que trate `playerName` como un [par√°metro de ruta](https://tanstack.com/router/v1/docs/framework/react/guide/path-params). Adem√°s, implementamos el m√©todo `validateSearch` que garantiza que el par√°metro de consulta `genre` est√© tipado fuertemente seg√∫n nuestro enum de g√©neros.
</Aside>
</TabItem>
</Tabs>

Al realizar estos cambios, ¬°tu servidor de desarrollo local (http://localhost:4200/) deber√≠a tener el juego listo para jugar!

<Drawer title="Compilar y Desplegar" trigger="Tambi√©n puedes compilar y desplegar tu c√≥digo en Cloudfront si lo prefieres.">

Para compilar tu c√≥digo, ejecuta:

<NxCommands commands={['run-many --target build --all']} />

Ahora despliega tu aplicaci√≥n:

<NxCommands commands={['run @dungeon-adventure/infra:deploy dungeon-adventure-infra-sandbox']} />

Una vez desplegado, navega a tu URL de Cloudfront que puedes encontrar inspeccionando las salidas del despliegue de CDK.

</Drawer>

<Image src={gameSelectPng} alt="game-select.png" width="500" height="400" />
<div style="margin-top: -100px; margin-left: 100px;">
<Image src={gameConversationPng} alt="game-conversation.png" width="500" height="400" />
</div>

¬°Felicidades! Has construido y desplegado tu Juego de Aventuras en Mazmorras. üéâüéâüéâ