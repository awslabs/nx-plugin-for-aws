---
title: "Funciones Lambda de Python"
description: "Documentación de referencia para Funciones Lambda de Python"
---



import { FileTree } from '@astrojs/starlight/components';
import Link from '@components/link.astro';
import RunGenerator from '@components/run-generator.astro';
import GeneratorParameters from '@components/generator-parameters.astro';
import Infrastructure from '@components/infrastructure.astro';
import Snippet from '@components/snippet.astro';
import NxCommands from '@components/nx-commands.astro';

El generador de Funciones Lambda en Python permite añadir una función lambda a un proyecto existente de Python.

Este generador crea un nuevo manejador de lambda en Python con configuración de infraestructura usando AWS CDK o Terraform. El backend generado utiliza AWS Lambda para implementación sin servidor, con opción de seguridad de tipos usando el [Parser de AWS Lambda Powertools](https://docs.powertools.aws.dev/lambda/python/latest/utilities/parser/). Configura [AWS Lambda Powertools](https://docs.powertools.aws.dev/lambda/python/latest/) para observabilidad, incluyendo registro, trazado con AWS X-Ray y métricas de CloudWatch.

## Uso

### Generar una función Lambda

Puedes generar una nueva función Lambda de dos formas:

<RunGenerator generator="py#lambda-function" />

### Opciones

<GeneratorParameters generator="py#lambda-function" />

## Salida del generador

El generador añadirá los siguientes archivos a tu proyecto:

<FileTree>

- \<module-name>
  - \<lambda-function>.py Implementación de la función

</FileTree>

Si se provee la opción `functionPath`, el generador añadirá los archivos necesarios en la ruta especificada:

<FileTree>

- \<module-name>
  - \<custom-path>
    - \<function-name>.py Implementación de la función

</FileTree>

### Infraestructura

<Snippet name="shared-constructs" />

El generador crea infraestructura como código para desplegar tu función según el `iacProvider` seleccionado:

<Infrastructure>
<Fragment slot="cdk">
El generador crea constructos CDK para desplegar tu función, ubicados en el directorio `packages/common/constructs`.
</Fragment>
<Fragment slot="terraform">
El generador crea un módulo de Terraform para desplegar tu función, ubicado en `packages/common/terraform/src/app/lambda-functions/<function-name>`.
</Fragment>
</Infrastructure>

## Implementando tu función

La implementación principal está en `<function-name>.py`. Aquí un ejemplo:

```python
import os

from aws_lambda_powertools import Logger, Metrics, Tracer
from aws_lambda_powertools.metrics import MetricUnit
from aws_lambda_powertools.utilities.parser import event_parser
from aws_lambda_powertools.utilities.parser.models import EventBridgeModel
from aws_lambda_powertools.utilities.typing import LambdaContext

os.environ["POWERTOOLS_METRICS_NAMESPACE"] = "Foo"
os.environ["POWERTOOLS_SERVICE_NAME"] = "Foo"

logger: Logger = Logger()
metrics: Metrics = Metrics()
tracer: Tracer = Tracer()

@tracer.capture_lambda_handler
@metrics.log_metrics
@event_parser(model=EventBridgeModel)
def lambda_handler(event: EventBridgeModel, context: LambdaContext):
    logger.info("Received event", extra={"event": event.model_dump() })
    metrics.add_metric(name="InvocationCount", unit=MetricUnit.Count, value=1)

    try:
        # TODO: Implement
        metrics.add_metric(name="SuccessCount", unit=MetricUnit.Count, value=1)
        # TODO: Implement success response if required
    except Exception as e:
        logger.exception(e)
        metrics.add_metric(name="ErrorCount", unit=MetricUnit.Count, value=1)
        # TODO: Implement error response if required
```

El generador configura automáticamente:

1. Integración con AWS Lambda Powertools para observabilidad
2. Recolección de métricas  
3. Seguridad de tipos usando `@event_parser`

### Observabilidad con AWS Lambda Powertools

#### Registro

El generador configura registro estructurado usando AWS Lambda Powertools.

```python
def lambda_handler(event: EventBridgeModel, context: LambdaContext):
    logger.info("Received event", extra={"event": event.model_dump()})
```

:::tip
Se recomienda establecer un correlation id para cada solicitud única para facilitar depuración y monitoreo. Consulta la documentación de [aws powertools logger](https://docs.powertools.aws.dev/lambda/python/2.22.0/core/logger/#setting-a-correlation-id) para mejores prácticas.
:::

El logger incluye automáticamente:

- Solicitudes de eventos
- Información del contexto Lambda  
- Indicadores de cold start

#### Seguimiento

El trazado con AWS X-Ray se configura automáticamente. Puedes añadir subsegmentos personalizados:

```python
def lambda_handler(event: EventBridgeModel, context: LambdaContext):
    # Crea un nuevo subsegmento
    with tracer.provider.in_subsegment("function-subsegment"):
        # Tu lógica aquí
        return ....
```

#### Métricas

Las métricas de CloudWatch se recogen automáticamente. Puedes añadir métricas personalizadas:

```python
def lambda_handler(event: EventBridgeModel, context: LambdaContext):
    metrics.add_metric(name="NewMetric", unit=MetricUnit.Count, value=1)
    return ...
```

Métricas por defecto incluyen:

- Conteo de invocaciones
- Conteo de éxitos/fallos  
- Métricas de cold start

### Seguridad de tipos

Si elegiste un `eventSource` al generar tu función, esta se instrumenta con [`@event_parser` de AWS Lambda Powertools](https://docs.powertools.aws.dev/lambda/python/latest/utilities/parser/). Por ejemplo:

```python {3}
@event_parser(model=EventBridgeModel)
def lambda_handler(event: EventBridgeModel, context: LambdaContext):
    event.detail_type # <- tipado seguro con autocompletado IDE
```

Esto permite definir modelos de datos usando [Pydantic](https://docs.pydantic.dev/latest/), similar a trabajar con <Link path="guides/fastapi">Fast API</Link>.

:::tip
Si tienes datos personalizados anidados en un evento (ej. streams de DynamoDB o eventos de EventBridge), puedes usar [Envelopes](https://docs.powertools.aws.dev/lambda/python/latest/utilities/parser/#envelopes) para tiparlos.
:::

Si no deseas tipar tu evento, selecciona `Any` como `eventSource`.

## Empaquetado

El generador configura automáticamente el empaquetado Python para paquetes de despliegue Lambda usando [uv](https://docs.astral.sh/uv/):

<NxCommands commands={['run <project-name>:bundle']} />

:::note
Esto empaqueta todo el proyecto como paquete de despliegue. Para minimizar el tamaño, considera separar funciones Lambda en múltiples proyectos Python usando el generador <Link path="guides/python-project">`py#project`</Link>.
:::

El proceso usa:

1. [`uv export`](https://docs.astral.sh/uv/reference/cli/#uv-export) para exportar dependencias a `requirements.txt`
2. [`uv pip install`](https://docs.astral.sh/uv/reference/cli/#uv-pip-install) para instalar dependencias para la plataforma objetivo (`x86_64-manylinux2014`)

:::note
Si cambias la [arquitectura Lambda a ARM](https://docs.aws.amazon.com/lambda/latest/dg/foundation-arch.html), edita el target de empaquetado a `aarch64-manylinux2014`.
:::

## Desplegar tu función

<Snippet name="lambda-function/deploying-your-function" parentHeading="Deploying your Function" />