---
title: "Agente de Strands de Python"
description: "Generar un Agente de Strands de Python para construir agentes de IA con herramientas y desplegar en Amazon Bedrock AgentCore Runtime"
---



import { FileTree } from '@astrojs/starlight/components';
import RunGenerator from '@components/run-generator.astro';
import NxCommands from '@components/nx-commands.astro';
import Link from '@components/link.astro';
import Snippet from '@components/snippet.astro';
import Infrastructure from '@components/infrastructure.astro';
import GeneratorParameters from '@components/generator-parameters.astro';

Genera un [Agente Strands](https://strandsagents.com/) en Python para construir agentes de IA con herramientas, y opcionalmente desplegarlo en [Amazon Bedrock AgentCore Runtime](https://docs.aws.amazon.com/bedrock-agentcore/latest/devguide/).

## ¿Qué es Strands?

[Strands](https://strandsagents.com/latest/documentation/docs/) es un framework Python ligero y listo para producción para construir agentes de IA. Características clave:

- **Ligero y personalizable**: Bucle de agente simple que no interfiere
- **Listo para producción**: Observabilidad completa, tracing y opciones de despliegue escalable
- **Agnóstico a modelos y proveedores**: Soporta múltiples modelos de distintos proveedores
- **Herramientas comunitarias**: Conjunto potente de herramientas contribuidas por la comunidad
- **Soporte multi-agente**: Técnicas avanzadas como equipos de agentes y agentes autónomos
- **Modos de interacción flexibles**: Soporte conversacional, streaming y no streaming

## Uso

### Generar un Agente Strands

Puedes generar un Agente Strands en Python de dos formas:

<RunGenerator generator="py#strands-agent" />

:::tip
Primero usa el generador <Link path="/guides/python-project">`py#project`</Link> para crear un proyecto donde añadir tu Agente Strands.
:::

### Opciones

<GeneratorParameters generator="py#strands-agent" />

## Salida del Generador

El generador añadirá los siguientes archivos a tu proyecto Python existente:

<FileTree>
  - your-project/
    - your_module/
      - agent/ (o nombre personalizado si se especifica)
        - \_\_init\_\_.py Inicialización del paquete Python
        - agent.py Definición principal del agente con herramientas de ejemplo
        - main.py Punto de entrada para Bedrock AgentCore Runtime
        - agentcore_mcp_client.py Fábrica de clientes útil para invocar servidores MCP alojados en Bedrock AgentCore Runtime
        - Dockerfile Punto de entrada para alojar tu agente (excluido cuando `computeType` es `None`)
    - pyproject.toml Actualizado con dependencias de Strands
    - project.json Actualizado con objetivos de servicio del agente
</FileTree>

### Infraestructura

:::note
Si seleccionaste `None` para `computeType`, el generador no proveerá infraestructura como código.
:::

<Snippet name="shared-constructs" />

Para desplegar tu Agente Strands, se generan los siguientes archivos:

<Infrastructure>
<Fragment slot="cdk">
<FileTree>
  - packages/common/constructs/src
    - app
      - agents
        - \<project-name>
          - \<project-name>.ts Constructo CDK para desplegar tu agente
          - Dockerfile Archivo Docker pasado al constructo CDK
    - core
      - agent-core
        - runtime.ts Constructo CDK genérico para despliegue en Bedrock AgentCore Runtime
</FileTree>
</Fragment>
<Fragment slot="terraform">
<FileTree>
  - packages/common/terraform/src
    - app
      - agents
        - \<project-name>
          - \<project-name>.tf Módulo para desplegar tu agente
    - core
      - agent-core
        - runtime.tf Módulo genérico para despliegue en Bedrock AgentCore Runtime
</FileTree>
</Fragment>
</Infrastructure>

## Trabajando con tu Agente Strands

### Añadiendo Herramientas

Las herramientas son funciones que el agente de IA puede llamar para realizar acciones. Strands usa un enfoque basado en decoradores para definirlas.

Puedes añadir nuevas herramientas en el archivo [`agent.py`](packages/nx-plugin/src/py/strands-agent/files/agent.py.template:6):

```python
from strands import Agent, tool

@tool
def calculate_sum(numbers: list[int]) -> int:
    """Calculate the sum of a list of numbers"""
    return sum(numbers)

@tool
def get_weather(city: str) -> str:
    """Get weather information for a city"""
    # Your weather API integration here
    return f"Weather in {city}: Sunny, 25°C"

# Add tools to your agent
agent = Agent(
    system_prompt="You are a helpful assistant with access to various tools.",
    tools=[calculate_sum, get_weather],
)
```

El framework Strands maneja automáticamente:
- Validación de tipos basada en hints de tipo
- Generación de esquemas JSON para tool calling
- Manejo de errores y formato de respuestas

### Usando Herramientas Preconstruidas

Strands provee herramientas preconstruidas en el paquete `strands-tools`:

```python
from strands_tools import current_time, http_request, file_read

agent = Agent(
    system_prompt="You are a helpful assistant.",
    tools=[current_time, http_request, file_read],
)
```

### Configuración de Modelos

Por defecto, Strands usa Claude 4 Sonnet, pero puedes personalizar el proveedor. Ver [documentación de Strands sobre proveedores](https://strandsagents.com/latest/documentation/docs/user-guide/quickstart/#model-providers):

```python
from strands import Agent
from strands.models import BedrockModel

# Create a BedrockModel
bedrock_model = BedrockModel(
    model_id="anthropic.claude-sonnet-4-20250514-v1:0",
    region_name="us-west-2",
    temperature=0.3,
)

agent = Agent(model=bedrock_model)
```

### Consumiendo Servidores MCP

Puedes [añadir herramientas de servidores MCP](https://strandsagents.com/latest/documentation/docs/user-guide/concepts/tools/mcp-tools/) a tu agente.

Para consumir servidores MCP creados con los generadores <Link path="/guides/py-mcp-server">`py#mcp-server`</Link> o <Link path="/guides/ts-mcp-server">`ts#mcp-server`</Link>, se genera una fábrica de clientes en `agentcore_mcp_client.py`.

Actualiza el método `get_agent` en `agent.py` para crear clientes MCP y añadir herramientas. Ejemplo con autenticación IAM (SigV4):

```python
# agent.py
import os
from contextlib import contextmanager

import boto3
from strands import Agent

from .agentcore_mcp_client import AgentCoreMCPClient

# Obtain the region an credentials
region = os.environ["AWS_REGION"]
boto_session = boto3.Session(region_name=region)
credentials = boto_session.get_credentials()

@contextmanager
def get_agent(session_id: str):
    mcp_client = AgentCoreMCPClient.with_iam_auth(
        agent_runtime_arn=os.environ["MCP_AGENTCORE_RUNTIME_ARN"],
        credentials=credentials,
        region=region,
        session_id=session_id,
    )

    with mcp_client:
        mcp_tools = mcp_client.list_tools_sync()

        yield Agent(
            system_prompt="..."
            tools=[*mcp_tools],
        )
```

:::tip
Si tu servidor MCP usa autenticación JWT, usa `AgentCoreMCPClient.with_jwt_auth` en su lugar.
:::

Para el ejemplo anterior con IAM, debemos configurar dos aspectos en la infraestructura:

<Infrastructure>
<Fragment slot="cdk">
```ts {9, 13}
import { MyProjectAgent, MyProjectMcpServer } from ':my-scope/common-constructs';

export class ExampleStack extends Stack {
  constructor(scope: Construct, id: string) {
    const mcpServer = new MyProjectMcpServer(this, 'MyProjectMcpServer');

    const agent = new MyProjectAgent(this, 'MyProjectAgent', {
      environment: {
        MCP_AGENTCORE_RUNTIME_ARN: mcpServer.agentCoreRuntime.arn,
      },
    });

    mcpServer.agentCoreRuntime.grantInvoke(agent.agentCoreRuntime);
  }
}
```
</Fragment>
<Fragment slot="terraform">
```terraform
# MCP Server
module "my_project_mcp_server" {
  source = "../../common/terraform/src/app/mcp-servers/my-project-mcp-server"
}

# Agent
module "my_project_agent" {
  source = "../../common/terraform/src/app/agents/my-project-agent"

  env = {
    MCP_AGENTCORE_RUNTIME_ARN = module.my_project_mcp_server.agent_core_runtime_arn
  }

  additional_iam_policy_statements = [
    {
      Effect = "Allow"
      Action = [
        "bedrock-agentcore:InvokeAgentRuntime"
      ]
      Resource = [
        module.my_project_mcp_server.agent_core_runtime_arn,
        "${module.my_project_mcp_server.agent_core_runtime_arn}/*"
      ]
    }
  ]
}
```
</Fragment>
</Infrastructure>

### Más información

Para una guía detallada sobre agentes Strands, consulta la [documentación oficial](https://strandsagents.com/latest/documentation/docs/).

## SDK Python de Bedrock AgentCore

El generador configura el [SDK Python de Bedrock AgentCore](https://github.com/aws/bedrock-agentcore-sdk-python) para manejar el contrato HTTP requerido.

Detalles del SDK en la [documentación](https://aws.github.io/bedrock-agentcore-starter-toolkit/user-guide/runtime/quickstart.html).

:::note
El generador provee infraestructura CDK/Terraform para despliegue, no necesitas usar `bedrock-agentcore-starter-toolkit`.
:::

## Ejecutando tu Agente Strands

### Desarrollo Local

El generador configura un target `<your-agent-name>-serve` para iniciar el agente localmente:

<NxCommands commands={['run your-project:agent-serve']} />

Este comando usa `uv run` con el [SDK Python de Bedrock AgentCore](https://github.com/aws/bedrock-agentcore-sdk-python).

## Despliegue en Bedrock AgentCore Runtime

### Infraestructura como Código

Si seleccionaste `BedrockAgentCoreRuntime` para `computeType`, se genera infraestructura CDK/Terraform relevante.

<Infrastructure>
<Fragment slot="cdk">
Constructo CDK generado (nombre basado en `name` o `<ProjectName>Agent`):

```ts {6}
import { MyProjectAgent } from ':my-scope/common-constructs';

export class ExampleStack extends Stack {
  constructor(scope: Construct, id: string) {
    const agent = new MyProjectAgent(this, 'MyProjectAgent');

    agent.agentCoreRuntime.role.addToPolicy(
      new PolicyStatement({
        actions: [
          'bedrock:InvokeModel',
          'bedrock:InvokeModelWithResponseStream',
        ],
        resources: ['arn:aws:bedrock:*::foundation-model/*'],
      }),
    );
  }
}
```
</Fragment>
<Fragment slot="terraform">
Módulo Terraform generado (nombre basado en `name` o `<ProjectName>-agent`):

```terraform
module "my_project_agent" {
  source = "../../common/terraform/src/app/agents/my-project-agent"

  additional_iam_policy_statements = [
    {
      Effect = "Allow"
      Action = [
        "bedrock:InvokeModel",
        "bedrock:InvokeModelWithResponseStream"
      ]
      Resource = [
        "arn:aws:bedrock:*::foundation-model/*"
      ]
    }
  ]
}
```
</Fragment>
</Infrastructure>

:::note
Asegura tener habilitados los modelos base en tu cuenta AWS. Para activarlos, sigue [estas instrucciones](https://docs.aws.amazon.com/bedrock/latest/userguide/model-access-modify.html).
:::

:::caution
Necesitas [Docker](https://www.docker.com/) instalado. Errores como:

```
ERROR: Cannot connect to the Docker daemon at unix://path/to/docker.sock.
```
indican problemas con Docker.
:::

### Targets Bundle y Docker

El target `bundle`:
- Exporta dependencias a `requirements.txt` con `uv export`
- Instala dependencias para la plataforma objetivo (`aarch64-manylinux2014`)

Target `docker`:
- Construye una imagen desde el `Dockerfile` según el [contrato de runtime](https://docs.aws.amazon.com/bedrock-agentcore/latest/devguide/runtime-service-contract.html)

:::tip
La imagen usa un tag (ej. `my-scope-my-project-agent:latest`) referenciado por tu infraestructura.
:::

### Autenticación

#### IAM

Configuración por defecto:

<Infrastructure>
<Fragment slot="cdk">
```ts {5}
import { MyProjectAgent } from ':my-scope/common-constructs';

export class ExampleStack extends Stack {
  constructor(scope: Construct, id: string) {
    new MyProjectAgent(this, 'MyProjectAgent');
  }
}
```

Otorgar acceso con `grantInvoke`:

```ts {8}
import { MyProjectAgent } from ':my-scope/common-constructs';

export class ExampleStack extends Stack {
  constructor(scope: Construct, id: string) {
    const agent = new MyProjectAgent(this, 'MyProjectAgent');
    const lambdaFunction = new Function(this, ...);

    agent.agentCoreRuntime.grantInvoke(lambdaFunction);
  }
}
```
</Fragment>
<Fragment slot="terraform">
```terraform
module "my_project_agent" {
  source = "../../common/terraform/src/app/agents/my-project-agent"
}
```

Política de acceso ejemplo:
```terraform
{
  Effect = "Allow"
  Action = [
    "bedrock-agentcore:InvokeAgentRuntime"
  ]
  Resource = [
    module.my_project_agent.agent_core_runtime_arn,
    "${module.my_project_agent.agent_core_runtime_arn}/*"
  ]
}
```
</Fragment>
</Infrastructure>

#### Autenticación Cognito JWT

Ejemplo de configuración:

<Infrastructure>
<Fragment slot="cdk">
```ts {13-18}
import { MyProjectAgent } from ':my-scope/common-constructs';

export class ExampleStack extends Stack {
  constructor(scope: Construct, id: string) {
    const userPool = new UserPool(this, 'UserPool');
    const client = userPool.addClient('Client', {
      authFlows: {
        userPassword: true,
      },
    });

    new MyProjectAgent(this, 'MyProjectAgent', {
      authorizerConfiguration: {
        customJWTAuthorizer: {
          discoveryUrl: `https://cognito-idp.${Stack.of(userPool).region}.amazonaws.com/${userPool.userPoolId}/.well-known/openid-configuration`,
          allowedClients: [client.userPoolClientId],
        },
      },
    });
  }
}
```
</Fragment>
<Fragment slot="terraform">
```terraform {18-21}
# packages/common/terraform/src/app/agents/my-project-agent/my-project-agent.tf

data "aws_region" "current" {}

locals {
  aws_region = data.aws_region.current.name
  user_pool_id = "xxx"
  user_pool_client_ids = ["yyy"]
}

module "agent_core_runtime" {
  source = "../../../core/agent-core"
  agent_runtime_name = "MyProjectAgent"
  docker_image_tag = "my-scope-my-project-agent:latest"
  server_protocol = "HTTP"
  customJWTAuthorizer = {
    discoveryUrl = "https://cognito-idp.${local.aws_region}.amazonaws.com/${local.user_pool_id}/.well-known/openid-configuration",
    allowedClients = local.user_pool_client_ids
  }
  env = var.env
  additional_iam_policy_statements = var.additional_iam_policy_statements
  tags = var.tags
}
```
</Fragment>
</Infrastructure>

### Observabilidad

Configuración automática con [AWS Distro for Open Telemetry](https://aws.amazon.com/otel/) en el `Dockerfile`.

Los traces se encuentran en CloudWatch > "GenAI Observability". Habilita [Transaction Search](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch-Transaction-Search.html).

Más detalles en [documentación de AgentCore](https://docs.aws.amazon.com/bedrock-agentcore/latest/devguide/observability-configure.html).