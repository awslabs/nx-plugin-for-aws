---
title: "Sitio web de CloudScape"
description: "Documentación de referencia para un sitio web de CloudScape"
---



import { FileTree, Steps } from '@astrojs/starlight/components';
import Link from '@components/link.astro';
import RunGenerator from '@components/run-generator.astro';
import GeneratorParameters from '@components/generator-parameters.astro';
import NxCommands from '@components/nx-commands.astro';
import schema from '../../../../../../packages/nx-plugin/src/cloudscape-website/app/schema.json';

Este generador crea un nuevo sitio web en [React](https://react.dev/) configurado con [CloudScape](http://cloudscape.design/), junto con la infraestructura AWS CDK para desplegar tu sitio web en la nube como un sitio estático alojado en [S3](https://aws.amazon.com/s3/), servido por [CloudFront](https://aws.amazon.com/cloudfront/) y protegido por [WAF](https://aws.amazon.com/waf/).

La aplicación generada utiliza [Vite](https://vite.dev/) como herramienta de construcción y empaquetador. Emplea [TanStack Router](https://tanstack.com/router/v1) para el enrutamiento tipado.

:::note
Si bien este generador configura CloudScape, en última instancia es un generador de proyectos React, y puedes modificar tu código para cambiar a un sistema de diseño o biblioteca de componentes alternativo si lo deseas.
:::

## Uso

### Generar un sitio web con CloudScape

Puedes generar un nuevo sitio web con CloudScape de dos formas:

<RunGenerator generator="ts#cloudscape-website" />

### Opciones

<GeneratorParameters schema={schema} />

## Salida del generador

El generador creará la siguiente estructura de proyecto en el directorio `<directory>/<name>`:

<FileTree>
  - index.html Punto de entrada HTML
  - public Recursos estáticos
  - src
    - main.tsx Punto de entrada de la aplicación con configuración de React
    - config.ts Configuración de la aplicación (ej. logo)
    - components
      - AppLayout Componentes para el diseño general de CloudScape y barra de navegación
    - hooks
      - useAppLayout.tsx Hook para ajustar el AppLayout desde componentes anidados
    - routes
      - welcome
        - index.tsx Ruta (o página) de ejemplo para @tanstack/react-router
    - styles.css Estilos globales
  - vite.config.ts Configuración de Vite y Vitest
  - tsconfig.json Configuración base de TypeScript para código fuente y tests
  - tsconfig.app.json Configuración de TypeScript para código fuente
  - tsconfig.spec.json Configuración de TypeScript para tests
</FileTree>

El generador también creará código de infraestructura CDK para desplegar tu sitio web en el directorio `packages/common/constructs`:

<FileTree>
  - src
    - app
      - static-websites
        - \<name>.ts Infraestructura específica de tu sitio web
    - core
      - static-website.ts Construct genérico StaticWebsite
</FileTree>

## Implementando tu sitio web con CloudScape

La [documentación de React](https://react.dev/learn) es un buen punto de partida para aprender los fundamentos. Puedes consultar la [documentación de CloudScape](https://cloudscape.design/components/) para detalles sobre los componentes disponibles y su uso.

### Rutas

#### Crear una ruta/página

Tu sitio web CloudScape incluye [TanStack Router](https://tanstack.com/router/v1) configurado. Para añadir nuevas rutas:

<Steps>
  1. [Ejecuta el servidor de desarrollo local](#local-development-server)
  2. Crea un nuevo archivo `<page-name>.tsx` en `src/routes`, donde su posición en el árbol de archivos representa la ruta
  3. ¡Observa que una `Route` y `RouteComponent` se generan automáticamente para ti. ¡Puedes empezar a construir tu página aquí!
</Steps>

#### Navegar entre páginas

Puedes usar el componente `Link` o el hook `useNavigate` para navegar entre páginas:

```tsx {1, 4, 8-9, 14}
import { Link, useNavigate } from '@tanstack/react-router';

export const MyComponent = () => {
  const navigate = useNavigate();

  const submit = async () => {
    const id = await ...
    // Usa `navigate` para redireccionar después de una acción asíncrona
    navigate({ to: '/products/$id', { params: { id }} });
  };

  return (
    <>
      <Link to="/products">Cancelar</Link>
      <Button onClick={submit}>Enviar</Button>
    </>
  )
};
```

Para más detalles, consulta la [documentación de TanStack Router](https://tanstack.com/router/latest/docs/framework/react/overview).

## Configuración en tiempo de ejecución

La configuración de tu infraestructura AWS CDK se provee al sitio web mediante Runtime Configuration. Esto permite acceder a detalles como URLs de APIs que no se conocen hasta el despliegue.

### Infraestructura

El construct CDK `RuntimeConfig` se usa para añadir y recuperar configuración. Los constructs generados por `@aws/nx-plugin` (como <Link path="guides/trpc">APIs tRPC</Link> y <Link path="guides/fastapi">FastAPIs</Link>) añaden automáticamente valores al `RuntimeConfig`.

Tu construct de sitio web desplegará la configuración como archivo `runtime-config.json` en la raíz de tu bucket S3.

```ts title="packages/infra/src/stacks/application-stack.ts" {9-10,12-13}
import { Stack } from 'aws-cdk-lib';
import { Construct } from 'constructs';
import { MyWebsite } from ':my-scope/common-constructs';

export class ApplicationStack extends Stack {
  constructor(scope: Construct, id: string) {
    super(scope, id);

    // Añade automáticamente valores al RuntimeConfig
    new MyApi(this, 'MyApi');

    // Despliega automáticamente la configuración en runtime-config.json
    new MyWebsite(this, 'MyWebsite');
  }
}
```

:::warning
Debes declarar tu sitio web _después_ de cualquier construct que añada valores al `RuntimeConfig`, de lo contrario faltarán en el archivo `runtime-config.json`.
:::

### Código del sitio web

En tu sitio web, usa el hook `useRuntimeConfig` para acceder a la configuración:

```tsx {1,4}
import { useRuntimeConfig } from '../hooks/useRuntimeConfig';

const MyComponent = () => {
  const runtimeConfig = useRuntimeConfig();

  // Accede a los valores de la configuración aquí
  const apiUrl = runtimeConfig.httpApis.MyApi;
};
```

### Configuración local en tiempo de ejecución

Para el [servidor de desarrollo local](#local-development-server), necesitas un archivo `runtime-config.json` en tu directorio `public`. Tu proyecto incluye un target `load:runtime-config` para descargar este archivo desde una aplicación desplegada:

<NxCommands commands={['run <my-website>:"load:runtime-config"']} />

:::warning
Si cambias el nombre de tu stack en `src/main.ts` de tu proyecto de infraestructura, debes actualizar el target `load:runtime-config` en el archivo `project.json` de tu sitio web con el nuevo nombre del stack.
:::

## Servidor de desarrollo local

Antes de ejecutar el servidor, asegúrate de haber desplegado tu infraestructura y [cargado la configuración local](#local-runtime-config).

Ejecuta el target `serve`:

<NxCommands commands={['run <my-website>:serve']} />

## Construcción

Puedes construir tu sitio web con el target `build`. Esto crea un bundle de producción en `dist/packages/<my-website>/bundle`, junto con verificación de tipos y linting.

<NxCommands commands={['run <my-website>:build']} />

## Pruebas

Para escribir pruebas, consulta la <Link path="guides/typescript-project#testing">guía de proyectos TypeScript</Link>. Para pruebas específicas de React, se incluye React Testing Library:

Consulta la [documentación de React Testing Library](https://testing-library.com/docs/react-testing-library/example-intro).

Ejecuta pruebas con el target `test`:

<NxCommands commands={['run <my-website>:test']} />

## Desplegar tu sitio web

Recomendamos usar el <Link path="guides/typescript-infrastructure">Generador de Infraestructura TypeScript</Link> para crear una aplicación CDK.

Usa el construct generado en `packages/common/constructs` para desplegar tu sitio web:

```ts title="packages/infra/src/stacks/application-stack.ts" {3, 9}
import { Stack } from 'aws-cdk-lib';
import { Construct } from 'constructs';
import { MyWebsite } from ':my-scope/common-constructs';

export class ApplicationStack extends Stack {
  constructor(scope: Construct, id: string) {
    super(scope, id);

    new MyWebsite(this, 'MyWebsite');
  }
}
```