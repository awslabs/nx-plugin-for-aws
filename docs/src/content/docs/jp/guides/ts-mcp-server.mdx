---
title: "ts#mcp-サーバー"
description: "大規模言語モデルにコンテキストを提供するTypeScriptモデルコンテキストプロトコル（MCP）サーバーを生成"
---



import { FileTree } from '@astrojs/starlight/components';
import RunGenerator from '@components/run-generator.astro';
import NxCommands from '@components/nx-commands.astro';
import Link from '@components/link.astro';
import GeneratorParameters from '@components/generator-parameters.astro';
import schema from '../../../../../../packages/nx-plugin/src/ts/mcp-server/schema.json';

# TypeScript MCP サーバージェネレーター

大規模言語モデル（LLM）にコンテキストを提供するためのTypeScript [Model Context Protocol（MCP）](https://modelcontextprotocol.io/) サーバーを生成します。

## MCPとは

[Model Context Protocol（MCP）](https://modelcontextprotocol.io/) はAIアシスタントが外部ツールやリソースと連携するためのオープンスタンダードです。LLMが以下を一貫した方法で行えるようにします：

- アクションを実行したり情報を取得したりするツール（関数）を実行
- コンテキストやデータを提供するリソースにアクセス

## 使用方法

### MCPサーバーの生成

TypeScript MCPサーバーは2つの方法で生成できます：

<RunGenerator generator="ts#mcp-server" />

### オプション

<GeneratorParameters schema={schema} />

## ジェネレーター出力

ジェネレーターは以下のプロジェクトファイルを作成します：

<FileTree>
  - packages/\<name>/
    - README.md MCPサーバーの使用説明書
    - project.json ビルド、バンドル、開発ターゲットを含むNxプロジェクト設定
    - src/
      - index.ts MCPサーバーのエントリーポイント
      - server.ts ツールとリソースを定義するメインサーバー
      - global.d.ts マークダウンファイルインポート用TypeScript型宣言
      - resources/
        - example-context.md MCPサーバー用サンプルリソースマークダウンファイル
</FileTree>

:::note
ジェネレーター出力の詳細については<Link path="/guides/typescript-project">TypeScriptプロジェクトジェネレーターのドキュメント</Link>を参照してください。
:::

## MCPサーバーの操作

### ツールの追加

ツールはAIアシスタントが呼び出せる関数です。`server.ts`ファイルに新しいツールを追加できます：

```typescript
server.tool("toolName",
  { param1: z.string(), param2: z.number() }, // Zodを使用した入力スキーマ
  async ({ param1, param2 }) => {
    // ツールの実装
    return {
      content: [{ type: "text", text: "Result" }]
    };
  }
);
```

### リソースの追加

リソースはAIアシスタントにコンテキストを提供します。ファイルからの静的リソースや動的リソースを追加できます：

```typescript
// ファイルからの静的リソース
import resourceContent from './resources/my-resource.md';

server.resource('resource-name', 'example://resource', async (uri) => ({
  contents: [{ uri: uri.href, text: resourceContent }],
}));

// 動的リソース
server.resource('dynamic-resource', 'dynamic://resource', async (uri) => {
  const data = await fetchSomeData();
  return {
    contents: [{ uri: uri.href, text: data }],
  };
});
```

## AIアシスタントとの連携設定

MCPサーバーをAIアシスタントで使用するには、まずバンドルする必要があります：

<NxCommands commands={['run your-mcp-server:bundle']} />

これにより`dist/packages/your-mcp-server/bundle/index.js`にバンドル版が生成されます（ディレクトリ設定によりパスは異なる場合があります）。

### 設定ファイル

MCPをサポートするAIアシスタントの多くは同様の設定方法を使用します。MCPサーバーの詳細を含む設定ファイルを作成/更新する必要があります：

```json
{
  "mcpServers": {
    "your-mcp-server": {
      "command": "node",
      "args": [
        "/path/to/workspace/dist/packages/your-mcp-server/bundle/index.js"
      ],
      "transportType": "stdio"
    }
  }
}
```

`/path/to/workspace/dist/packages/your-mcp-server/bundle/index.js`は実際のバンドル済みMCPサーバーのパスに置き換えてください。

:::caution
サーバー接続時に`ENOENT node`エラーが発生する場合、`node`のフルパスを指定する必要があります。ターミナルで`which node`を実行してパスを確認できます。
:::

### アシスタント固有の設定

各AIアシスタントのMCP設定方法については以下を参照してください：

- [Amazon Q Developer](https://docs.aws.amazon.com/amazonq/latest/qdeveloper-ug/command-line-mcp-configuration.html)
- [Cline](https://docs.cline.bot/mcp-servers/configuring-mcp-servers)
- [Cursor](https://docs.cursor.com/context/model-context-protocol)
- [Claude Code](https://docs.anthropic.com/en/docs/agents-and-tools/claude-code/tutorials#set-up-model-context-protocol-mcp)

:::tip
Amazon Q Developerなどの一部のAIアシスタントでは、ワークスペースレベルのMCPサーバー設定が可能で、特定プロジェクトに関連するMCPサーバーを定義するのに便利です。
:::

## 開発ワークフロー

### ビルドターゲット

このジェネレーターは<Link path="/guides/typescript-project">TypeScriptプロジェクトジェネレーター</Link>を基盤としており、そのターゲットを継承するとともに以下の追加ターゲットを提供します：

#### バンドル

`bundle`タスクは[esbuild](https://esbuild.github.io/)を使用して、AIアシスタントで使用可能な単一のJavaScriptバンドルファイルを作成します：

<NxCommands commands={['run your-mcp-server:bundle']} />

これにより`dist/packages/your-mcp-server/bundle/index.js`にバンドル版が生成されます（ディレクトリ設定によりパスは異なる場合があります）。

#### 開発

`dev`タスクはプロジェクトの変更を監視し、自動的にバンドルを再構築します：

<NxCommands commands={['run your-mcp-server:dev']} />

開発時には特に有用で、AIアシスタントが常に最新のMCPサーバーバージョンを使用できるようにします。

:::note
変更を反映するには、一部のAIアシスタントでMCPサーバーの再起動が必要な場合があります。
:::