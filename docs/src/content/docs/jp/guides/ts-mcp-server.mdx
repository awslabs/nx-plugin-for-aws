---
title: "ts#mcp-サーバー"
description: "大規模言語モデルにコンテキストを提供するTypeScriptモデルコンテキストプロトコル（MCP）サーバーを生成"
---



import { FileTree } from '@astrojs/starlight/components';
import RunGenerator from '@components/run-generator.astro';
import NxCommands from '@components/nx-commands.astro';
import Link from '@components/link.astro';
import GeneratorParameters from '@components/generator-parameters.astro';
import schema from '../../../../../../packages/nx-plugin/src/ts/mcp-server/schema.json';

# TypeScript MCP サーバージェネレーター

大規模言語モデル（LLM）にコンテキストを提供するためのTypeScript [Model Context Protocol (MCP)](https://modelcontextprotocol.io/) サーバーを生成します。

## MCPとは

[Model Context Protocol (MCP)](https://modelcontextprotocol.io/) は、AIアシスタントが外部ツールやリソースと相互作用するためのオープンスタンダードです。LLMが以下を行うための一貫した方法を提供します：

- アクションを実行または情報を取得するツール（関数）の実行
- コンテキストやデータを提供するリソースへのアクセス

## 使用方法

### MCPサーバーの生成

TypeScript MCPサーバーは2つの方法で生成できます：

<RunGenerator generator="ts#mcp-server" />

### オプション

<GeneratorParameters generator="ts#mcp-server" />

## ジェネレーターの出力

ジェネレーターは以下のプロジェクトファイルを作成します：

<FileTree>
  - packages/\<name>/
    - README.md MCPサーバーのドキュメント（使用方法を含む）
    - project.json Nxプロジェクト設定（ビルド、バンドル、開発ターゲットを含む）
    - src/
      - index.ts MCPサーバーのエントリーポイント
      - server.ts メインサーバー定義（ツールとリソースの定義）
      - global.d.ts マークダウンファイルインポート用TypeScript型宣言
      - resources/
        - example-context.md MCPサーバー用リソースとして使用するマークダウンファイルの例
</FileTree>

:::note
ジェネレーター出力の詳細については、<Link path="/guides/typescript-project">TypeScriptプロジェクトジェネレータードキュメント</Link>を参照してください。
:::

## MCPサーバーの操作

### ツールの追加

ツールはAIアシスタントが呼び出せる関数です。`server.ts`ファイルに新しいツールを追加できます：

```typescript
server.tool("toolName",
  { param1: z.string(), param2: z.number() }, // Zodを使用した入力スキーマ
  async ({ param1, param2 }) => {
    // ツールの実装
    return {
      content: [{ type: "text", text: "Result" }]
    };
  }
);
```

### リソースの追加

リソースはAIアシスタントにコンテキストを提供します。ファイルからの静的リソースまたは動的リソースを追加できます：

```typescript
// ファイルからの静的リソース
import exampleContext from './resources/example-context.md';

server.resource('resource-name', 'example://resource', async (uri) => ({
  contents: [{ uri: uri.href, text: exampleContext }],
}));

// 動的リソース
server.resource('dynamic-resource', 'dynamic://resource', async (uri) => {
  const data = await fetchSomeData();
  return {
    contents: [{ uri: uri.href, text: data }],
  };
});
```

## AIアシスタントとの連携設定

MCPサーバーをAIアシスタントで使用するには、まずバンドルする必要があります：

<NxCommands commands={['run your-mcp-server:bundle']} />

これにより`dist/packages/your-mcp-server/bundle/index.js`にバンドル版が作成されます（ディレクトリ設定によりパスは異なる場合があります）。

### 設定ファイル

MCPをサポートするほとんどのAIアシスタントは類似した設定方法を使用します。MCPサーバーの詳細を記載した設定ファイルを作成/更新する必要があります：

```json
{
  "mcpServers": {
    "your-mcp-server": {
      "command": "node",
      "args": [
        "/path/to/workspace/dist/packages/your-mcp-server/bundle/index.js"
      ],
      "transportType": "stdio"
    }
  }
}
```

`/path/to/workspace/dist/packages/your-mcp-server/bundle/index.js`は実際のバンドル済みMCPサーバーのパスに置き換えてください。

:::caution
サーバー接続時に`ENOENT node`エラーが発生する場合、ターミナルで`which node`を実行して取得できるnodeの絶対パスを指定する必要があるかもしれません。
:::

### アシスタント固有の設定

特定のAIアシスタントでMCPを設定するには、以下のドキュメントを参照してください：

- [Amazon Q Developer](https://docs.aws.amazon.com/amazonq/latest/qdeveloper-ug/command-line-mcp-configuration.html)
- [Cline](https://docs.cline.bot/mcp-servers/configuring-mcp-servers)
- [Cursor](https://docs.cursor.com/context/model-context-protocol)
- [Claude Code](https://docs.anthropic.com/en/docs/agents-and-tools/claude-code/tutorials#set-up-model-context-protocol-mcp)

:::tip
Amazon Q Developerなど一部のAIアシスタントは、ワークスペースレベルのMCPサーバー設定を指定可能で、特定プロジェクトに関連するMCPサーバーを定義する際に特に有用です。
:::

## 開発ワークフロー

### ビルドターゲット

このジェネレーターは<Link path="/guides/typescript-project">TypeScriptプロジェクトジェネレーター</Link>を基盤としており、そのターゲットを継承するとともに、以下の追加ターゲットを提供します：

#### バンドル

`bundle`タスクは[esbuild](https://esbuild.github.io/)を使用し、AIアシスタントで使用可能な単一のJavaScriptバンドルファイルを作成します：

<NxCommands commands={['run your-mcp-server:bundle']} />

これにより`dist/packages/your-mcp-server/bundle/index.js`にバンドル版が作成されます（ディレクトリ設定によりパスは異なる場合があります）。

#### 開発

`dev`タスクはプロジェクトの変更を監視し、自動的にバンドルを再構築します：

<NxCommands commands={['run your-mcp-server:dev']} />

開発中に特に有用で、AIアシスタントが常に最新版のMCPサーバーを使用することを保証します。

:::note
変更を反映するためにMCPサーバーの再起動を必要とするAIアシスタントもあります。
:::