---
title: クイックスタートガイド
description: '@aws/nx-pluginの使い方クイックスタート。'
---
import { Steps } from '@astrojs/starlight/components';
import Link from '@components/link.astro';
import { Content as Prerequisites } from '@snippets/prerequisites.mdx';
import CreateNxWorkspaceCommand from '@components/create-nx-workspace-command.astro';
import InstallCommand from '@components/install-command.astro';
import RunGenerator from '@components/run-generator.astro';
import NxCommands from '@components/nx-commands.astro';

このガイドでは、`@aws/nx-plugin`のインストールと使用方法の基本について説明し、AWSでのプロジェクト構築を迅速に行う方法を紹介します。

:::tip
フルスタックアプリケーションの構築に関するより詳細なチュートリアルについては、<Link path="get_started/tutorials/dungeon-game/overview">ダンジョンアドベンチャーチュートリアル</Link>をご覧ください。
:::

## 前提条件

続行する前に、以下のグローバル依存関係が必要です：

<Prerequisites />

## ステップ1：新しいNxワークスペースを初期化する

お好みのパッケージマネージャーでNxワークスペースを作成するには、次のコマンドを実行します：

<CreateNxWorkspaceCommand workspace="my-project" />

完了したら、プロジェクトディレクトリに移動します：

```sh
cd my-project
```

## ステップ2：AWS用Nxプラグインを追加する

以下のコマンドでプラグインをインストールします：

<InstallCommand dev pkg="@aws/nx-plugin" />

## ステップ3：ジェネレーターを使用してプロジェクトをスキャフォールドする

このクイックスタートガイドでは、tRPC API、Reactウェブサイト、Cognito認証、CDKインフラストラクチャを追加します。構築するプロジェクトの種類に応じて、任意のジェネレーターの組み合わせを選択してプロジェクトを迅速に立ち上げることができます。利用可能なオプションの完全なリストについては、左側のナビゲーションバーの__ガイド__をご確認ください。

### tRPC APIを追加する

<RunGenerator generator="ts#trpc-api" requiredParameters={{ apiName: 'demo-api' }} />

これにより、`packages/demo-api`フォルダ内にAPIが作成されます。

### Reactウェブサイトを追加する

<RunGenerator generator="ts#cloudscape-website" requiredParameters={{ name: 'demo-website' }} />

これにより、`packages/demo-website`に新しいReactウェブサイトがスキャフォールドされます。

### Cognito認証を追加する

<RunGenerator generator="ts#cloudscape-website#auth" requiredParameters={{ project: '@my-project/demo-website', cognitoDomain: 'my-demo' }} />

これにより、ウェブサイトにCognito認証を追加するために必要なインフラストラクチャとReactコードが設定されます。

### フロントエンドとバックエンドを接続する

<RunGenerator generator="api-connection" requiredParameters={{ sourceProject: '@my-project/demo-website', targetProject: '@my-project/demo-api-backend' }} />

これにより、ウェブサイトがtRPC APIを呼び出せるように必要なプロバイダーが設定されます。

### CDKインフラストラクチャを追加する

<RunGenerator generator="ts#infra" requiredParameters={{ name: 'infra' }} />

これにより、AWSにインフラストラクチャをデプロイするために使用できるCDKアプリが設定されます。

## ステップ4：クラウドリソースを定義してAWSにデプロイする

`packages/infra/src/stacks/application-stack.ts`を開き、以下のコードを追加します：

```typescript
import * as cdk from 'aws-cdk-lib';
import { DemoApi, DemoWebsite, UserIdentity } from ':my-project/common-constructs';
import { Construct } from 'constructs';

export class ApplicationStack extends cdk.Stack {
  constructor(scope: Construct, id: string, props?: cdk.StackProps) {
    super(scope, id, props);

    const identity = new UserIdentity(this, 'identity');
    const api = new DemoApi(this, 'api');
    api.grantInvokeAccess(identity.identityPool.authenticatedRole);

    new DemoWebsite(this, 'website');
  }
}
```

これがフルスタックアプリケーションをデプロイするために必要なCDKコードのすべてです。

### インフラストラクチャをビルドしてデプロイする

次に、以下のコマンドを実行してプロジェクトをビルドします：

<NxCommands commands={['run-many --target build --all']} />

:::tip
リントエラーが発生した場合は、以下のコマンドを実行して自動的に修正できます。

<NxCommands commands={['run-many --target lint --configuration=fix --all']} />
:::

## ステップ5：フロントエンドをローカルで実行する

<Steps>
1. `runtime-config.json`ファイルを取得します：

    <NxCommands commands={['run @demo/demo-website:load:runtime-config']} />

2. ローカルウェブサイトサーバーを起動します：

    <NxCommands commands={['run @demo/demo-website:serve']} />
</Steps>

ウェブサイトは`http://localhost:4200`で利用可能になります。

---

おめでとうございます！🎉 `@aws/nx-plugin`を使用してフルスタックアプリケーションの構築とデプロイに成功しました！
