---
title: "クイックスタートガイド"
description: "@aws/nx-pluginの使い方に関するクイックスタート。"
---



import { Steps } from '@astrojs/starlight/components';
import Link from '@components/link.astro';
import Snippet from '@components/snippet.astro';
import CreateNxWorkspaceCommand from '@components/create-nx-workspace-command.astro';
import InstallCommand from '@components/install-command.astro';
import RunGenerator from '@components/run-generator.astro';
import NxCommands from '@components/nx-commands.astro';

このガイドでは、`@aws/nx-plugin`を使用したAWSプロジェクトの迅速な構築方法について、インストールから基本的な使い方までを説明します。

:::tip
フルスタックアプリケーション構築の詳細なチュートリアルについては、<Link path="get_started/tutorials/dungeon-game/overview">Dungeon Adventure Tutorial</Link>をご覧ください。
:::

## 前提条件

始める前に以下のグローバル依存関係が必要です:

<Snippet name="prerequisites" />

## ステップ1: 新しいNxワークスペースの初期化

次のコマンドを実行して、任意のパッケージマネージャーでNxワークスペースを作成します:

<CreateNxWorkspaceCommand workspace="my-project" />

完了したら、プロジェクトディレクトリに移動します:

```sh
cd my-project
```

## ステップ2: ジェネレータでプロジェクトをスキャフォールド

このクイックスタートでは、tRPC API・Reactウェブサイト・Cognito認証・CDKインフラを追加します。左側のナビゲーションバーにある__Guides__から、プロジェクトタイプに応じた任意のジェネレータの組み合わせを選択できます。

### tRPC APIの追加

<RunGenerator generator="ts#trpc-api" requiredParameters={{ name: 'demo-api', auth: 'IAM' }} />

これにより`packages/demo-api`フォルダ内にAPIが作成されます。

### Reactウェブサイトの追加

<RunGenerator generator="ts#react-website" requiredParameters={{ name: 'demo-website' }} />

`packages/demo-website`に新しいReactウェブサイトがスキャフォールドされます。

### Cognito認証の追加

<RunGenerator generator="ts#react-website#auth" requiredParameters={{ project: '@my-project/demo-website', cognitoDomain: 'my-demo' }} />

ウェブサイトにCognito認証を追加するためのインフラとReactコードを設定します。

### フロントエンドとバックエンドの接続

<RunGenerator generator="api-connection" requiredParameters={{ sourceProject: '@my-project/demo-website', targetProject: '@my-project/demo-api' }} />

ウェブサイトがtRPC APIを呼び出すために必要なプロバイダ設定を行います。

### CDKインフラの追加

<RunGenerator generator="ts#infra" requiredParameters={{ name: 'infra' }} />

AWSへのインフラデプロイ用CDKアプリを設定します。

## ステップ3: ローカル環境でのウェブサイトとAPIの実行

次のコマンドで、ウェブサイトと接続されたAPIのローカル開発サーバーを起動します:

<NxCommands commands={['run demo-website:serve-local']} />

ウェブサイトは`http://localhost:4200`でアクセス可能です。

ウェブサイトとAPIへの変更は、両方のサーバーがホットリロードされるためリアルタイムで反映されます。

## ステップ4: クラウドリソースの定義とAWSへのデプロイ

`packages/infra/src/stacks/application-stack.ts`を開き、次のコードを追加します:

```typescript
import * as cdk from 'aws-cdk-lib';
import { DemoApi, DemoWebsite, UserIdentity } from ':my-project/common-constructs';
import { Construct } from 'constructs';

export class ApplicationStack extends cdk.Stack {
  constructor(scope: Construct, id: string, props?: cdk.StackProps) {
    super(scope, id, props);

    const identity = new UserIdentity(this, 'identity');
    const api = new DemoApi(this, 'api', {
      integrations: DemoApi.defaultIntegrations(this).build(),
    });
    api.grantInvokeAccess(identity.identityPool.authenticatedRole);

    new DemoWebsite(this, 'website');
  }
}
```

これがフルスタックアプリケーションをデプロイするために必要なCDKコードの全体です。

### インフラのビルドとデプロイ

次のコマンドでプロジェクトをビルドします:

<NxCommands commands={['run-many --target build --all']} />

:::tip
リンターエラーが発生した場合は、次のコマンドで自動修正できます:

<NxCommands commands={['run-many --target lint --configuration=fix --all']} />
:::

デプロイコマンドを実行します:

<NxCommands commands={['run infra:deploy --all']} />

:::tip
CDKデプロイにはAWS環境のブートストラップが必要です。

ウェブサイト用AWS WAF WebACLのデプロイ許可のために、ターゲットリージョンと`us-east-1`の両方でCDKブートストラップを実行してください:

<NxCommands commands={['run infra:bootstrap']} />
:::

## ステップ5: デプロイ済みクラウドリソースとの連携テスト

<Steps>
1. `runtime-config.json`ファイルを取得:

    <NxCommands commands={['run demo-website:load:runtime-config']} />

2. ローカルウェブサイトサーバーを起動

    <NxCommands commands={['run demo-website:serve']} />
</Steps>

ウェブサイトは`http://localhost:4200`でアクセス可能になり、デプロイしたAPIと認証リソースと連携します。

---

おめでとうございます！🎉 `@aws/nx-plugin`を使ったフルスタックアプリケーションの構築とデプロイに成功しました！