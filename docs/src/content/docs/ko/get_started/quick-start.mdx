---
title: "λΉ λ¥Έ μ‹μ‘ κ°€μ΄λ“"
description: "@aws/nx-plugin μ‚¬μ© λ°©λ²•μ— λ€ν• λΉ λ¥Έ μ‹μ‘"
---

import { Steps } from '@astrojs/starlight/components';
import Link from '@components/link.astro';
import Snippet from '@components/snippet.astro';
import CreateNxWorkspaceCommand from '@components/create-nx-workspace-command.astro';
import PackageManagerShortCommand from '@components/package-manager-short-command.astro';
import InstallCommand from '@components/install-command.astro';
import RunGenerator from '@components/run-generator.astro';
import NxCommands from '@components/nx-commands.astro';
import Infrastructure from '@components/infrastructure.astro';

μ΄ κ°€μ΄λ“λ” AWSμ—μ„ ν”„λ΅μ νΈλ¥Ό λΉ λ¥΄κ² κµ¬μ¶•ν•κΈ° μ„ν•΄ `@aws/nx-plugin`μ„ μ„¤μΉν•κ³  μ‚¬μ©ν•λ” κΈ°λ³Έ λ°©λ²•μ„ μ„¤λ…ν•©λ‹λ‹¤.

:::tip
λ” μ‹¬μΈµμ μΈ ν’€μ¤νƒ μ• ν”λ¦¬μΌ€μ΄μ… κµ¬μ¶• νν† λ¦¬μ–Όμ„ μ›ν•μ‹λ©΄ <Link path="get_started/tutorials/dungeon-game/overview">λμ „ μ–΄λ“λ²¤μ² νν† λ¦¬μ–Ό</Link>μ„ ν™•μΈν•΄ μ£Όμ„Έμ”.
:::

## ν•„μ μ΅°κ±΄

μ§„ν–‰ μ „ λ‹¤μ μ „μ—­ μμ΅΄μ„±μ΄ ν•„μ”ν•©λ‹λ‹¤:

<Snippet name="prerequisites" />

## 1λ‹¨κ³„: μƒ Nx μ›ν¬μ¤νμ΄μ¤ μ΄κΈ°ν™”

μ›ν•λ” ν¨ν‚¤μ§€ λ§¤λ‹μ €λ΅ Nx μ›ν¬μ¤νμ΄μ¤λ¥Ό μƒμ„±ν•λ ¤λ©΄ λ‹¤μ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•μ„Έμ”:

<CreateNxWorkspaceCommand workspace="my-project" />

:::tip
μΈν”„λΌμ¤νΈλ­μ² μ½”λ“(IaC) μ κ³µμλ΅ [CDK](https://docs.aws.amazon.com/cdk/) λλ” [Terraform](https://developer.hashicorp.com/terraform)μ„ μ„ νƒν•  μ μμµλ‹λ‹¤. `--iacProvider` ν”λκ·Έλ¥Ό μ‚¬μ©ν•λ©΄ ν”„λ΅¬ν”„νΈλ¥Ό κ±΄λ„λ›Έ μ μμµλ‹λ‹¤:

<Infrastructure>
<Fragment slot="cdk">
<CreateNxWorkspaceCommand workspace="my-project" iacProvider="CDK" />
</Fragment>
<Fragment slot="terraform">
<CreateNxWorkspaceCommand workspace="my-project" iacProvider="Terraform" />
</Fragment>
</Infrastructure>
:::

μ™„λ£ ν›„ ν”„λ΅μ νΈ λ””λ ‰ν† λ¦¬λ΅ μ΄λ™ν•©λ‹λ‹¤:

```sh
cd my-project
```

## 2λ‹¨κ³„: μƒμ„±κΈ°λ¥Ό μ‚¬μ©ν•μ—¬ ν”„λ΅μ νΈ μ¤μΊν΄λ”©

μ΄ λΉ λ¥Έ μ‹μ‘ κ°€μ΄λ“μ—μ„λ” tRPC API, React μ›Ήμ‚¬μ΄νΈ, Cognito μΈμ¦ λ° CDK/Terraform μΈν”„λΌλ¥Ό μ¶”κ°€ν•©λ‹λ‹¤. ν”„λ΅μ νΈ μ ν•μ— λ”°λΌ μ›ν•λ” μƒμ„±κΈ° μ΅°ν•©μ„ μ„ νƒν•μ—¬ λΉ λ¥΄κ² ν”„λ΅μ νΈλ¥Ό λ¶€νΈμ¤νΈλ©ν•  μ μμµλ‹λ‹¤. μ™Όμ½ λ„¤λΉ„κ²μ΄μ… λ°”μ __κ°€μ΄λ“__ μ—μ„ μ „μ²΄ μµμ… λ©λ΅μ„ ν™•μΈν•μ„Έμ”.

### tRPC API μ¶”κ°€

<RunGenerator generator="ts#trpc-api" requiredParameters={{ name: 'demo-api', auth: 'IAM' }} />

μ΄ λ…λ Ήμ€ `packages/demo-api` ν΄λ” λ‚΄μ— APIλ¥Ό μƒμ„±ν•©λ‹λ‹¤.

### React μ›Ήμ‚¬μ΄νΈ μ¶”κ°€

<RunGenerator generator="ts#react-website" requiredParameters={{ name: 'demo-website' }} />

μ΄ λ…λ Ήμ€ `packages/demo-website`μ— μƒ React μ›Ήμ‚¬μ΄νΈλ¥Ό μ¤μΊν΄λ”©ν•©λ‹λ‹¤.

### Cognito μΈμ¦ μ¶”κ°€

<RunGenerator generator="ts#react-website#auth" requiredParameters={{ project: '@my-project/demo-website', cognitoDomain: 'my-demo' }} />

μ΄ λ…λ Ήμ€ μ›Ήμ‚¬μ΄νΈμ— Cognito μΈμ¦μ„ μ¶”κ°€ν•κΈ° μ„ν• μΈν”„λΌμ™€ React μ½”λ“λ¥Ό μ„¤μ •ν•©λ‹λ‹¤.

### ν”„λ΅ νΈμ—”λ“-λ°±μ—”λ“ μ—°κ²°

<RunGenerator generator="connection" requiredParameters={{ sourceProject: '@my-project/demo-website', targetProject: '@my-project/demo-api' }} />

μ΄ λ…λ Ήμ€ μ›Ήμ‚¬μ΄νΈκ°€ tRPC APIλ¥Ό νΈμ¶ν•  μ μλ„λ΅ ν•„μ”ν• ν”„λ΅λ°”μ΄λ”λ¥Ό κµ¬μ„±ν•©λ‹λ‹¤.

### μΈν”„λΌ μ¶”κ°€

μ„ νƒν• IaC μ κ³µμμ— λ”°λΌ μΈν”„λΌ ν”„λ΅μ νΈλ¥Ό μ¶”κ°€ν•©λ‹λ‹¤.

<Infrastructure>
<Fragment slot="cdk">
<RunGenerator generator="ts#infra" requiredParameters={{ name: 'infra' }} />

μ΄ λ…λ Ήμ€ AWSμ— μΈν”„λΌλ¥Ό λ°°ν¬ν•λ” λ° μ‚¬μ©ν•  CDK μ•±μ„ κµ¬μ„±ν•©λ‹λ‹¤.
</Fragment>
<Fragment slot="terraform">
<RunGenerator generator="terraform#project" requiredParameters={{ name: 'infra' }} />

μ΄ λ…λ Ήμ€ AWSμ— μΈν”„λΌλ¥Ό λ°°ν¬ν•λ” λ° μ‚¬μ©ν•  Terraform ν”„λ΅μ νΈλ¥Ό κµ¬μ„±ν•©λ‹λ‹¤.
</Fragment>
</Infrastructure>

## 3λ‹¨κ³„: λ΅μ»¬μ—μ„ μ›Ήμ‚¬μ΄νΈ λ° API μ‹¤ν–‰

λ‹¤μ λ…λ Ήμ–΄λ΅ μ›Ήμ‚¬μ΄νΈμ™€ μ—°κ²°λ APIμ λ΅μ»¬ κ°λ° μ„λ²„λ¥Ό μ‹μ‘ν•©λ‹λ‹¤:

<NxCommands commands={['run demo-website:serve-local']} />

μ›Ήμ‚¬μ΄νΈλ” `http://localhost:4200`μ—μ„ ν™•μΈν•  μ μμµλ‹λ‹¤.

μ›Ήμ‚¬μ΄νΈμ™€ APIμ λ³€κ²½ μ‚¬ν•­μ€ μ‹¤μ‹κ°„μΌλ΅ λ°μλλ©°, λ‘ μ„λ²„ λ¨λ‘ ν•« λ¦¬λ΅λ“λ©λ‹λ‹¤.

## 4λ‹¨κ³„: ν΄λΌμ°λ“ λ¦¬μ†μ¤ μ •μ λ° AWS λ°°ν¬

<Infrastructure>
<Fragment slot="cdk">
`packages/infra/src/stacks/application-stack.ts`λ¥Ό μ—΄κ³  λ‹¤μ μ½”λ“λ¥Ό μ¶”κ°€ν•μ„Έμ”:

```typescript
import * as cdk from 'aws-cdk-lib';
import { DemoApi, DemoWebsite, UserIdentity } from ':my-project/common-constructs';
import { Construct } from 'constructs';

export class ApplicationStack extends cdk.Stack {
  constructor(scope: Construct, id: string, props?: cdk.StackProps) {
    super(scope, id, props);

    const identity = new UserIdentity(this, 'identity');
    const api = new DemoApi(this, 'api', {
      integrations: DemoApi.defaultIntegrations(this).build(),
    });
    api.grantInvokeAccess(identity.identityPool.authenticatedRole);

    new DemoWebsite(this, 'website');
  }
}
```

μ΄ μ½”λ“λ” ν’€μ¤νƒ μ• ν”λ¦¬μΌ€μ΄μ… λ°°ν¬μ— ν•„μ”ν• λ¨λ“  CDK κµ¬μ„±μ„ ν¬ν•¨ν•©λ‹λ‹¤.
</Fragment>
<Fragment slot="terraform">
`packages/infra/src/main.tf`λ¥Ό μ—΄κ³  λ‹¤μ μ½”λ“λ¥Ό μ¶”κ°€ν•μ„Έμ”:

```hcl
# @aws/nx-plugin μ‚¬μ© λ©”νΈλ¦­ μ¶”μ  ν¬ν•¨
module "metrics" {
  source = "../../common/terraform/src/metrics"
}

# μ‚¬μ©μ μ‹ μ› λ°°ν¬
module "user_identity" {
  source = "../../common/terraform/src/core/user-identity"
}

# API λ°°ν¬
module "demo_api" {
  source = "../../common/terraform/src/app/apis/demo-api"
}

# μΈμ¦λ μ‚¬μ©μμ API νΈμ¶ κ¶ν• λ¶€μ—¬
resource "aws_iam_policy" "api_invoke_policy" {
  name        = "DemoApiInvokePolicy"
  description = "μΈμ¦λ μ‚¬μ©μκ°€ APIλ¥Ό νΈμ¶ν•  μ μλ„λ΅ ν•λ” μ •μ±…"

  policy = jsonencode({
    Version = "2012-10-17"
    Statement = [
      {
        Effect = "Allow"
        Action = "execute-api:Invoke"
        Resource = "${module.demo_api.api_execution_arn}/*/*"
      }
    ]
  })
}

resource "aws_iam_role_policy_attachment" "authenticated_api_access" {
  role       = module.user_identity.authenticated_role_name
  policy_arn = aws_iam_policy.api_invoke_policy.arn
}

# μ›Ήμ‚¬μ΄νΈ λ°°ν¬
provider "aws" {
  alias  = "us_east_1"
  region = "us-east-1"
}

module "demo_website" {
  source = "../../common/terraform/src/app/static-websites/demo-website"

  providers = {
    aws.us_east_1 = aws.us_east_1
  }

  depends_on = [module.user_identity, module.demo_api]
}
```

μ΄ μ½”λ“λ” ν’€μ¤νƒ μ• ν”λ¦¬μΌ€μ΄μ… λ°°ν¬μ— ν•„μ”ν• λ¨λ“  Terraform κµ¬μ„±μ„ ν¬ν•¨ν•©λ‹λ‹¤.
</Fragment>
</Infrastructure>

### μΈν”„λΌ λΉλ“ λ° λ°°ν¬

ν”„λ΅μ νΈλ¥Ό λΉλ“ν•λ ¤λ©΄ λ‹¤μ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•μ„Έμ”:

<PackageManagerShortCommand commands={["build"]} />

:::tip
λ¦°νΈ μ¤λ¥κ°€ λ°μƒν•λ©΄ λ‹¤μ λ…λ Ήμ–΄λ΅ μλ™ μμ •ν•  μ μμµλ‹λ‹¤.

<PackageManagerShortCommand commands={["lint"]} />
:::

μΈν”„λΌλ¥Ό λ¶€νΈμ¤νΈλ©ν•©λ‹λ‹¤:

<Infrastructure>
<Fragment slot="cdk">
<NxCommands commands={['run infra:bootstrap']} />

:::tip
CDK λ¶€νΈμ¤νΈλ©μ€ λ€μƒ AWS λ¦¬μ „κ³Ό μ›Ήμ‚¬μ΄νΈμ© AWS WAF WebACL λ°°ν¬λ¥Ό μ„ν•΄ `us-east-1` λ¦¬μ „ λ¨λ‘μ—μ„ ν•„μ”ν•©λ‹λ‹¤.
:::
</Fragment>
<Fragment slot="terraform">
<NxCommands commands={['run infra:bootstrap']} />

:::tip
Terraform λ¶€νΈμ¤νΈλ©μ€ Terraform μƒνƒ νμΌμ„ μ €μ¥ν•  S3 λ²„ν‚·μ„ μƒμ„±ν•©λ‹λ‹¤. μ΄ μ‘μ—…μ€ AWS κ³„μ •/λ¦¬μ „ μ΅°ν•©λ‹Ή ν• λ²λ§ μν–‰ν•λ©΄ λ©λ‹λ‹¤.
:::
</Fragment>
</Infrastructure>

ν”„λ΅μ νΈλ¥Ό λ°°ν¬ν•©λ‹λ‹¤:

<Infrastructure>
<Fragment slot="cdk">
<NxCommands commands={['run infra:deploy "my-project-sandbox/*"']} />
</Fragment>
<Fragment slot="terraform">
<NxCommands commands={['run infra:apply']} />

:::tip
μ΄ λ…λ Ήμ€ λ¨Όμ € `terraform plan`μΌλ΅ λ³€κ²½ μ‚¬ν•­μ„ ν™•μΈν• ν›„ μΈν”„λΌμ— λ³€κ²½ μ‚¬ν•­μ„ μ μ©ν•©λ‹λ‹¤.
:::
</Fragment>
</Infrastructure>

## 5λ‹¨κ³„: λ°°ν¬λ ν΄λΌμ°λ“ λ¦¬μ†μ¤λ΅ μ›Ήμ‚¬μ΄νΈ ν…μ¤νΈ

<Steps>
1. `runtime-config.json` νμΌ κ°€μ Έμ¤κΈ°:

    <NxCommands commands={['run demo-website:load:runtime-config']} />

2. λ΅μ»¬ μ›Ήμ‚¬μ΄νΈ μ„λ²„ μ‹μ‘

    <NxCommands commands={['run demo-website:serve']} />
</Steps>

μ›Ήμ‚¬μ΄νΈλ” `http://localhost:4200`μ—μ„ ν™•μΈν•  μ μμΌλ©°, λ°°ν¬λ API λ° μΈμ¦ λ¦¬μ†μ¤λ¥Ό κ°€λ¦¬ν‚µλ‹λ‹¤.

---

μ¶•ν•ν•©λ‹λ‹¤! π‰ `@aws/nx-plugin`μ„ μ‚¬μ©ν•μ—¬ ν’€μ¤νƒ μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ„±κ³µμ μΌλ΅ κµ¬μ¶•ν•κ³  λ°°ν¬ν–μµλ‹λ‹¤!