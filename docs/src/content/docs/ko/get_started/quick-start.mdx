---
title: "빠른 시작 가이드"
description: "@aws/nx-plugin 사용 방법에 대한 빠른 시작"
---



import { Steps } from '@astrojs/starlight/components';
import Link from '@components/link.astro';
import Snippet from '@components/snippet.astro';
import CreateNxWorkspaceCommand from '@components/create-nx-workspace-command.astro';
import InstallCommand from '@components/install-command.astro';
import RunGenerator from '@components/run-generator.astro';
import NxCommands from '@components/nx-commands.astro';
import Infrastructure from '@components/infrastructure.astro';

이 가이드는 AWS에서 프로젝트를 빠르게 구축하기 위해 `@aws/nx-plugin` 설치 및 사용 기본 사항을 설명합니다.

:::tip
전체 애플리케이션 구축에 대한 심층 튜토리얼을 원하시면 <Link path="get_started/tutorials/dungeon-game/overview">던전 어드벤처 튜토리얼</Link>을 확인하세요.
:::

## 필수 조건

진행 전 다음 전역 종속성이 필요합니다:

<Snippet name="prerequisites" />

## 1단계: 새 Nx 워크스페이스 초기화

원하는 패키지 매니저로 Nx 워크스페이스를 생성하려면 다음 명령을 실행하세요:

<CreateNxWorkspaceCommand workspace="my-project" />

:::tip
인프라스트럭처 코드(IaC) 제공자로 [CDK](https://docs.aws.amazon.com/cdk/) 또는 [Terraform](https://developer.hashicorp.com/terraform)을 선택하라는 프롬프트가 표시됩니다. `--iacProvider`를 사용하여 프롬프트를 건너뛸 수 있습니다:

<Infrastructure>
<Fragment slot="cdk">
<CreateNxWorkspaceCommand workspace="my-project" iacProvider="CDK" />
</Fragment>
<Fragment slot="terraform">
<CreateNxWorkspaceCommand workspace="my-project" iacProvider="Terraform" />
</Fragment>
</Infrastructure>
:::

완료 후 프로젝트 디렉토리로 이동합니다:

```sh
cd my-project
```

## 2단계: 생성기를 사용하여 프로젝트 스캐폴딩

이 빠른 시작 가이드에서는 tRPC API, React 웹사이트, Cognito 인증 및 CDK/Terraform 인프라를 추가합니다. 프로젝트 유형에 따라 원하는 생성기 조합을 선택하여 프로젝트를 빠르게 부트스트랩할 수 있습니다. 왼쪽 탐색 바의 __가이드__ 에서 전체 옵션 목록을 확인하세요.

### tRPC API 추가

<RunGenerator generator="ts#trpc-api" requiredParameters={{ name: 'demo-api', auth: 'IAM' }} />

이 명령은 `packages/demo-api` 폴더 내에 API를 생성합니다.

### React 웹사이트 추가

<RunGenerator generator="ts#react-website" requiredParameters={{ name: 'demo-website' }} />

이 명령은 `packages/demo-website`에 새 React 웹사이트를 스캐폴딩합니다.

### Cognito 인증 추가

<RunGenerator generator="ts#react-website#auth" requiredParameters={{ project: '@my-project/demo-website', cognitoDomain: 'my-demo' }} />

이 명령은 웹사이트에 Cognito 인증을 추가하기 위한 인프라와 React 코드를 설정합니다.

### 프론트엔드-백엔드 연결

<RunGenerator generator="api-connection" requiredParameters={{ sourceProject: '@my-project/demo-website', targetProject: '@my-project/demo-api' }} />

이 명령은 웹사이트가 tRPC API를 호출할 수 있도록 필요한 프로바이더를 구성합니다.

### 인프라 추가

선택한 IaC 제공자에 따라 인프라 프로젝트를 추가합니다.

<Infrastructure>
<Fragment slot="cdk">
<RunGenerator generator="ts#infra" requiredParameters={{ name: 'infra' }} />

이 명령은 AWS에 인프라를 배포하는 데 사용할 CDK 앱을 구성합니다.
</Fragment>
<Fragment slot="terraform">
<RunGenerator generator="terraform#project" requiredParameters={{ name: 'infra' }} />

이 명령은 AWS에 인프라를 배포하는 데 사용할 Terraform 프로젝트를 구성합니다.
</Fragment>
</Infrastructure>

## 3단계: 로컬에서 웹사이트 및 API 실행

다음 명령으로 웹사이트와 연결된 API의 로컬 개발 서버를 시작합니다:

<NxCommands commands={['run demo-website:serve-local']} />

웹사이트는 `http://localhost:4200`에서 확인할 수 있습니다.

웹사이트와 API 모두 변경 사항이 실시간으로 반영되며 핫 리로드가 지원됩니다.

## 4단계: 클라우드 리소스 정의 및 AWS 배포

<Infrastructure>
<Fragment slot="cdk">
`packages/infra/src/stacks/application-stack.ts`를 열고 다음 코드를 추가합니다:

```typescript
import * as cdk from 'aws-cdk-lib';
import { DemoApi, DemoWebsite, UserIdentity } from ':my-project/common-constructs';
import { Construct } from 'constructs';

export class ApplicationStack extends cdk.Stack {
  constructor(scope: Construct, id: string, props?: cdk.StackProps) {
    super(scope, id, props);

    const identity = new UserIdentity(this, 'identity');
    const api = new DemoApi(this, 'api', {
      integrations: DemoApi.defaultIntegrations(this).build(),
    });
    api.grantInvokeAccess(identity.identityPool.authenticatedRole);

    new DemoWebsite(this, 'website');
  }
}
```

이 코드는 전체 스택 애플리케이션 배포에 필요한 모든 CDK 구성을 포함합니다.
</Fragment>
<Fragment slot="terraform">
`packages/infra/src/main.tf`를 열고 다음 코드를 추가합니다:

```hcl
# @aws/nx-plugin 사용 메트릭 추적 포함
module "metrics" {
  source = "../../common/terraform/src/metrics"
}

# 사용자 신원 배포
module "user_identity" {
  source = "../../common/terraform/src/core/user-identity"
}

# API 배포
module "demo_api" {
  source = "../../common/terraform/src/app/apis/demo-api"
}

# 인증된 사용자의 API 호출 권한 부여
resource "aws_iam_policy" "api_invoke_policy" {
  name        = "DemoApiInvokePolicy"
  description = "Policy to allow authenticated users to invoke the API"

  policy = jsonencode({
    Version = "2012-10-17"
    Statement = [
      {
        Effect = "Allow"
        Action = "execute-api:Invoke"
        Resource = "${module.demo_api.api_execution_arn}/*/*"
      }
    ]
  })
}

resource "aws_iam_role_policy_attachment" "authenticated_api_access" {
  role       = module.user_identity.authenticated_role_name
  policy_arn = aws_iam_policy.api_invoke_policy.arn
}

# 웹사이트 배포
provider "aws" {
  alias  = "us_east_1"
  region = "us-east-1"
}

module "demo_website" {
  source = "../../common/terraform/src/app/static-websites/demo-website"

  providers = {
    aws.us_east_1 = aws.us_east_1
  }

  depends_on = [module.user_identity, module.demo_api]
}
```

이 코드는 전체 스택 애플리케이션 배포에 필요한 모든 Terraform 구성을 포함합니다.
</Fragment>
</Infrastructure>

### 인프라 빌드 및 배포

프로젝트 빌드를 위해 다음 명령을 실행합니다:

<NxCommands commands={['run-many --target build --all']} />

:::tip
린트 오류가 발생하면 다음 명령으로 자동 수정할 수 있습니다.

<NxCommands commands={['run-many --target lint --configuration=fix --all']} />
:::

인프라 부트스트래핑을 실행합니다:

<Infrastructure>
<Fragment slot="cdk">
<NxCommands commands={['run infra:bootstrap']} />

:::tip
CDK 부트스트래핑은 대상 AWS 리전과 웹사이트용 AWS WAF WebACL 배포를 위한 `us-east-1` 모두에 필요합니다.
:::
</Fragment>
<Fragment slot="terraform">
<NxCommands commands={['run infra:bootstrap']} />

:::tip
Terraform 부트스트래핑은 Terraform 상태 파일을 저장할 S3 버킷을 생성합니다. 이는 AWS 계정/리전 조합당 한 번만 수행하면 됩니다.
:::
</Fragment>
</Infrastructure>

프로젝트를 배포합니다:

<Infrastructure>
<Fragment slot="cdk">
<NxCommands commands={['run infra:deploy my-project-sandbox/*']} />
</Fragment>
<Fragment slot="terraform">
<NxCommands commands={['run infra:apply']} />

:::tip
이 명령은 먼저 `terraform plan`으로 변경 사항을 확인한 후 변경 사항을 적용하여 인프라를 배포합니다.
:::
</Fragment>
</Infrastructure>

## 5단계: 배포된 클라우드 리소스로 웹사이트 테스트

<Steps>
1. `runtime-config.json` 파일 가져오기:

    <NxCommands commands={['run demo-website:load:runtime-config']} />

2. 로컬 웹사이트 서버 시작

    <NxCommands commands={['run demo-website:serve']} />
</Steps>

웹사이트는 `http://localhost:4200`에서 확인할 수 있으며, 배포된 API 및 인증 리소스를 가리킵니다.

---

축하합니다! 🎉 `@aws/nx-plugin`을 사용하여 전체 스택 애플리케이션을 성공적으로 구축하고 배포했습니다!