---
title: "ì—ì´ì „íŠ¸í˜• AI ë˜ì „ ê²Œì„"
description: "@aws/nx-pluginì„ ì‚¬ìš©í•˜ì—¬ ì—ì´ì „íŠ¸í˜• AI ê¸°ë°˜ ë˜ì „ ëª¨í—˜ ê²Œì„ì„ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì— ëŒ€í•œ ì•ˆë‚´"
---



import { Aside, Code, FileTree, Steps, Tabs, TabItem } from '@astrojs/starlight/components';
import { Image } from 'astro:assets';
import Link from '@components/link.astro';
import Drawer from '@components/drawer.astro';
import RunGenerator from '@components/run-generator.astro';
import NxCommands from '@components/nx-commands.astro';
import InstallCommand from '@components/install-command.astro';
import E2EDiff from '@components/e2e-diff.astro';
import E2ECode from '@components/e2e-code.astro';

import dungeonAdventureArchitecturePng from '@assets/dungeon-game-architecture.png'
import dungeonAdventureErPng from '@assets/dungeon-adventure-er.png'
import baselineWebsitePng from '@assets/baseline-website.png'
import baselineGamePng from '@assets/baseline-game.png'
import nxGraphPng from '@assets/nx-graph.png'
import gameSelectPng from '@assets/game-select.png'
import gameConversationPng from '@assets/game-conversation.png'

## ëª¨ë“ˆ 2: ê²Œì„ API ë° ì¸ë²¤í† ë¦¬ MCP ì„œë²„ êµ¬í˜„

ë¨¼ì € Game APIë¥¼ êµ¬í˜„í•´ ë³´ê² ìŠµë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ ì´ 5ê°œì˜ APIë¥¼ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤:

1. `createGame` - ìƒˆë¡œìš´ ê²Œì„ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
2. `queryGames` - ì´ì „ì— ì €ì¥ëœ ê²Œì„ ëª©ë¡ì„ í˜ì´ì§€ë„¤ì´ì…˜ìœ¼ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.
3. `saveAction` - íŠ¹ì • ê²Œì„ì— ëŒ€í•œ ì•¡ì…˜ì„ ì €ì¥í•©ë‹ˆë‹¤.
4. `queryActions` - ê²Œì„ê³¼ ê´€ë ¨ëœ ëª¨ë“  ì•¡ì…˜ì˜ í˜ì´ì§€ë„¤ì´ì…˜ ëª©ë¡ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
5. `queryInventory` - í”Œë ˆì´ì–´ ì¸ë²¤í† ë¦¬ ë‚´ ì•„ì´í…œ ëª©ë¡ì„ í˜ì´ì§€ë„¤ì´ì…˜ìœ¼ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.

### API ìŠ¤í‚¤ë§ˆ

API ì…ë ¥ ë° ì¶œë ¥ì„ ì •ì˜í•˜ê¸° ìœ„í•´ `packages/game-api/src/schema` ë””ë ‰í† ë¦¬ ë‚´ì—ì„œ [Zod](https://zod.dev/)ë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¤í‚¤ë§ˆë¥¼ ìƒì„±í•©ë‹ˆë‹¤:

<Tabs>
  <TabItem label="action.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/schema/action.ts.template" />
  </TabItem>
  <TabItem label="common.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/schema/common.ts.template" />
  </TabItem>
  <TabItem label="game.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/schema/game.ts.template" />
  </TabItem>
  <TabItem label="inventory.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/schema/inventory.ts.template" />
  </TabItem>
  <TabItem label="index.ts">
<E2EDiff lang="typescript" before="dungeon-adventure/2/schema/index.ts.old.template" after="dungeon-adventure/2/schema/index.ts.template" />
  </TabItem>
</Tabs>

ì´ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ì§€ ì•Šì„ `packages/game-api/src/schema/echo.ts` íŒŒì¼ì€ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<Aside type="tip">
ìœ„ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´ Zodë¡œ ì •ì˜í•œ ê° ìŠ¤í‚¤ë§ˆì— ëŒ€í•´ `z.TypeOf` êµ¬ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë‚´ë³´ëƒ…ë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ì¤‘ë³µ ì‘ì—… ì—†ì´ Zod ì •ì˜ë¥¼ TypeScript ì¸í„°í˜ì´ìŠ¤ë¡œ ë³€í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!
</Aside>

### ì—”í‹°í‹° ëª¨ë¸ë§

ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ER ë‹¤ì´ì–´ê·¸ë¨ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

<Image class="centered-image white-bg" src={dungeonAdventureErPng} alt="dungeon-adventure-er.png" width="400" height="300" />

{/* Generated from the following PlantUML: */}
{/*
@startuml Game API Entity Relationship Diagram

!theme plain

skinparam linetype ortho
skinparam roundcorner 10

entity "Game" as game {
  + playerName : string <<PK>>
  --
  genre : string
  lastUpdated : string
}

entity "Action" as action {
  + playerName : string <<PK>>
  + timestamp : string <<SK>>
  --
  role : string
  content : string
}

entity "Item" as item {
  + playerName : string <<PK>>
  + itemName : string
  --
  emoji : string (optional)
  lastUpdated : string
  quantity : number
}

game ||--o{ action
game ||--o{ item

@enduml
*/}

DynamoDBì— ë°ì´í„°ë² ì´ìŠ¤ë¥¼ êµ¬í˜„í•  ê²ƒì´ë©°, [ElectroDB](https://electrodb.dev/en/core-concepts/introduction/) DynamoDB í´ë¼ì´ì–¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‘ì—…ì„ ë‹¨ìˆœí™”í•©ë‹ˆë‹¤. ì‹œì‘í•˜ë ¤ë©´ ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ `electrodb`ë¥¼ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤:

<InstallCommand pkg="electrodb @aws-sdk/client-dynamodb" />

<Aside>
ëª¨ë“  ì¢…ì†ì„±ì€ `@aws/nx-plugin`ì´ [ë‹¨ì¼ ë²„ì „ ì •ì±…](https://nx.dev/concepts/decisions/dependency-management#single-version-policy) ì›ì¹™ì„ ë”°ë¥´ê¸° ë•Œë¬¸ì— ë£¨íŠ¸ `package.json`ì— ì¶”ê°€ë©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ <Link path="guides/typescript-project#dependencies">ts#í”„ë¡œì íŠ¸ ê°€ì´ë“œ</Link>ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.
</Aside>

ì´ì œ ìœ„ ER ë‹¤ì´ì–´ê·¸ë¨ì— ë”°ë¼ ElectroDB ì—”í‹°í‹°ë¥¼ ì •ì˜í•˜ê¸° ìœ„í•´ `packages/game-api/src/entities` í´ë” ë‚´ì— ë‹¤ìŒ íŒŒì¼ë“¤ì„ ìƒì„±í•©ë‹ˆë‹¤:

<Tabs>
  <TabItem label="action.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/entities/action.ts.template" />
  </TabItem>
  <TabItem label="game.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/entities/game.ts.template" />
  </TabItem>
  <TabItem label="inventory.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/entities/inventory.ts.template" />
  </TabItem>
</Tabs>

ElectroDBëŠ” ë§¤ìš° ê°•ë ¥í•˜ë©° íƒ€ì… ì •ì˜ë¿ë§Œ ì•„ë‹ˆë¼ íƒ€ì„ìŠ¤íƒ¬í”„ì™€ ê°™ì€ íŠ¹ì • ê°’ì— ëŒ€í•œ ê¸°ë³¸ê°’ì„ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ElectroDBëŠ” DynamoDB ì‚¬ìš© ì‹œ ê¶Œì¥ë˜ëŠ” [ë‹¨ì¼ í…Œì´ë¸” ë””ìì¸](https://electrodb.dev/en/core-concepts/single-table-relationships/)ì„ ë”°ë¦…ë‹ˆë‹¤.

<Aside>
ElectroDBëŠ” [ì»¬ë ‰ì…˜](https://electrodb.dev/en/modeling/collections/)ì„ ì§€ì›í•˜ì§€ë§Œ, ë³¸ íŠœí† ë¦¬ì–¼ì—ì„œëŠ” ê°„ê²°ì„±ì„ ìœ„í•´ ì‚¬ìš©í•˜ì§€ ì•Šê¸°ë¡œ í–ˆìŠµë‹ˆë‹¤.
</Aside>

MCP ì„œë²„ê°€ ì¸ë²¤í† ë¦¬ì™€ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆë„ë¡ `packages/game-api/src/index.ts`ì—ì„œ ì¸ë²¤í† ë¦¬ ì—”í‹°í‹°ë¥¼ ë‚´ë³´ë‚´ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤:

<Tabs>
<TabItem label="packages/game-api/src/index.ts">
<E2EDiff lang="typescript" before="dungeon-adventure/2/index.ts.old.template" after="dungeon-adventure/2/index.ts.template" />
</TabItem>
</Tabs>

:::note
MCP ì„œë²„ê°€ APIì— ì˜ì¡´í•˜ì§€ ì•Šë„ë¡ ì—”í‹°í‹°ë¥¼ ë³„ë„ì˜ ê³µìœ  í”„ë¡œì íŠ¸ë¡œ ë¦¬íŒ©í† ë§í•˜ë©´ íŒ¨í‚¤ì§€ êµ¬ì¡°ê°€ ê°œì„ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
:::

### tRPC ì»¨í…ìŠ¤íŠ¸ì— DynamoDB í´ë¼ì´ì–¸íŠ¸ ì¶”ê°€

ê° í”„ë¡œì‹œì €ì—ì„œ DynamoDB í´ë¼ì´ì–¸íŠ¸ì— ì ‘ê·¼í•´ì•¼ í•˜ë¯€ë¡œ ì»¨í…ìŠ¤íŠ¸ë¥¼ í†µí•´ ë‹¨ì¼ í´ë¼ì´ì–¸íŠ¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ `packages/game-api/src` ë‚´ì—ì„œ ë‹¤ìŒ ë³€ê²½ ì‚¬í•­ì„ ì ìš©í•©ë‹ˆë‹¤:

<Tabs>
  <TabItem label="middleware/dynamodb.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/middleware/dynamodb.ts.template" />

ì´ í”ŒëŸ¬ê·¸ì¸ì€ `DynamoDBClient`ë¥¼ ìƒì„±í•˜ê³  ì»¨í…ìŠ¤íŠ¸ì— ì£¼ì…í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.
  </TabItem>
  <TabItem label="middleware/index.ts">
<E2EDiff lang="typescript" before="dungeon-adventure/2/middleware/index.ts.old.template" after="dungeon-adventure/2/middleware/index.ts.template" />

`IMiddlewareContext`ì— `IDynamoDBContext`ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
  </TabItem>
  <TabItem label="init.ts">
<E2EDiff lang="typescript" before="dungeon-adventure/2/init.ts.old.template" after="dungeon-adventure/2/init.ts.template" />

DynamoDB í”ŒëŸ¬ê·¸ì¸ì´ ì ìš©ë©ë‹ˆë‹¤.

<Aside>
`concat` APIëŠ” ì •ì˜í•œ í”„ë¡œì‹œì €ì— ë¯¸ë“¤ì›¨ì–´ë¥¼ ë°”ì¸ë”©í•©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ [concat ê°€ì´ë“œ](https://trpc.io/docs/server/middlewares#concat)ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.
</Aside>
  </TabItem>
</Tabs>

### í”„ë¡œì‹œì € ì •ì˜

ì´ì œ API ë©”ì„œë“œë¥¼ êµ¬í˜„í•  ì°¨ë¡€ì…ë‹ˆë‹¤. `packages/game-api/src/procedures` ë‚´ì—ì„œ ë‹¤ìŒ ë³€ê²½ ì‚¬í•­ì„ ì ìš©í•©ë‹ˆë‹¤:

#### ì¿¼ë¦¬

<Tabs>
  <TabItem label="query-actions.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/procedures/query-actions.ts.template" />
  </TabItem>
  <TabItem label="query-games.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/procedures/query-games.ts.template" />
  </TabItem>
  <TabItem label="query-inventory.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/procedures/query-inventory.ts.template" />
  </TabItem>
</Tabs>

#### ë®¤í…Œì´ì…˜

<Tabs>
  <TabItem label="save-action.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/procedures/save-action.ts.template" />
  </TabItem>
  <TabItem label="save-game.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/procedures/save-game.ts.template" />
  </TabItem>
</Tabs>

ì´ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ì§€ ì•Šì„ `echo.ts` íŒŒì¼(`packages/game-api/src/procedures` ë‚´)ë„ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ë¼ìš°í„° ì„¤ì •

ì •ì˜í•œ í”„ë¡œì‹œì €ë¥¼ APIì— ì—°ê²°í•©ë‹ˆë‹¤. ë‹¤ìŒ íŒŒì¼ì„ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤:

<Tabs>
  <TabItem label="packages/game-api/src/router.ts">
<E2EDiff lang="typescript" before="dungeon-adventure/2/router.ts.old.template" after="dungeon-adventure/2/router.ts.template" />
</TabItem>
</Tabs>

### ì¸ë²¤í† ë¦¬ MCP ì„œë²„

ì´ì œ ì—ì´ì „íŠ¸ê°€ í”Œë ˆì´ì–´ ì¸ë²¤í† ë¦¬ ë‚´ ì•„ì´í…œì„ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” MCP ì„œë²„ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

ì—ì´ì „íŠ¸ë¥¼ ìœ„í•´ ë‹¤ìŒ ë„êµ¬ë“¤ì„ ì •ì˜í•©ë‹ˆë‹¤:

- `list-inventory-items`: í”Œë ˆì´ì–´ì˜ í˜„ì¬ ì¸ë²¤í† ë¦¬ ì•„ì´í…œ ì¡°íšŒ
- `add-to-inventory`: í”Œë ˆì´ì–´ ì¸ë²¤í† ë¦¬ì— ì•„ì´í…œ ì¶”ê°€
- `remove-from-inventory`: í”Œë ˆì´ì–´ ì¸ë²¤í† ë¦¬ì—ì„œ ì•„ì´í…œ ì œê±°

ì‹œê°„ ì ˆì•½ì„ ìœ„í•´ ëª¨ë“  ë„êµ¬ë¥¼ ì¸ë¼ì¸ìœ¼ë¡œ ì •ì˜í•©ë‹ˆë‹¤:

<Tabs>
  <TabItem label="packages/inventory/src/mcp-server/server.ts">
<E2EDiff lang="typescript" before="dungeon-adventure/2/mcp/server.ts.old.template" after="dungeon-adventure/2/mcp/server.ts.template" />
</TabItem>
</Tabs>

ë„êµ¬ ìˆ˜ê°€ ì¦ê°€í•˜ë©´ ì›í•  ê²½ìš° ë³„ë„ íŒŒì¼ë¡œ ë¦¬íŒ©í† ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ì œ `packages/inventory/src/mcp-server` ë‚´ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” `tools` ë° `resources` ë””ë ‰í† ë¦¬ë¥¼ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì¸í”„ë¼êµ¬ì¡°

ë§ˆì§€ë§‰ ë‹¨ê³„ë¡œ DynamoDB í…Œì´ë¸”ì„ ìƒì„±í•˜ê³  Game APIì—ì„œ ì‘ì—… ìˆ˜í–‰ ê¶Œí•œì„ ë¶€ì—¬í•˜ê¸° ìœ„í•´ ì¸í”„ë¼ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤. `packages/infra/src` ë‚´ì—ì„œ ë‹¤ìŒ ë³€ê²½ ì‚¬í•­ì„ ì ìš©í•©ë‹ˆë‹¤:

<Tabs>
  <TabItem label="constructs/electrodb-table.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/constructs/electrodb-table.ts.template" />
  </TabItem>
  <TabItem label="stacks/application-stack.ts">
<E2EDiff lang="typescript" before="dungeon-adventure/1/application-stack.ts.template" after="dungeon-adventure/2/stacks/application-stack.ts.template" />

:::note
ê° í”„ë¡œì‹œì €ëŠ” ê°œë³„ ëŒë‹¤ í•¨ìˆ˜ë¡œ ì„œë¹„ìŠ¤ë˜ë¯€ë¡œ ìµœì†Œ ê¶Œí•œ ì›ì¹™ì— ë”°ë¼ í”„ë¡œì‹œì € êµ¬í˜„ì— í•„ìš”í•œ ì½ê¸°/ì“°ê¸° ê¶Œí•œë§Œ í• ë‹¹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
:::
  </TabItem>
</Tabs>

### ë°°í¬ ë° í…ŒìŠ¤íŠ¸

ë¨¼ì € ì½”ë“œë² ì´ìŠ¤ë¥¼ ë¹Œë“œí•©ë‹ˆë‹¤:

<NxCommands commands={['run-many --target build --all']} />

<Aside type="tip">
ë¦°íŠ¸ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ ìë™ìœ¼ë¡œ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<NxCommands commands={['run-many --target lint --configuration=fix --all']} />
</Aside>

ì´ì œ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

<NxCommands commands={['run @dungeon-adventure/infra:deploy dungeon-adventure-infra-sandbox/*']} />

ì²« ë°°í¬ëŠ” ì•½ 8ë¶„ ì •ë„ ì†Œìš”ë©ë‹ˆë‹¤. ì´í›„ ë°°í¬ëŠ” ì•½ 2ë¶„ ì •ë„ ê±¸ë¦½ë‹ˆë‹¤.

:::tip
ëŒë‹¤ í•¨ìˆ˜ ì½”ë“œ ë³€ê²½ ì‚¬í•­ì„ ë°˜ë³µì ìœ¼ë¡œ ìˆ˜ì •í•˜ëŠ” ê²½ìš° ì½”ë“œë² ì´ìŠ¤ ë¹Œë“œ í›„ `--hotswap` í”Œë˜ê·¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°°í¬í•˜ë©´ í›¨ì”¬ ì§§ì€(2-3ì´ˆ) ë°°í¬ ì‹œê°„ì´ ì†Œìš”ë©ë‹ˆë‹¤.

<NxCommands commands={['run @dungeon-adventure/infra:deploy dungeon-adventure-infra-sandbox/* --hotswap']} />
:::

ë°°í¬ê°€ ì™„ë£Œë˜ë©´ ë‹¤ìŒê³¼ ìœ ì‚¬í•œ ì¶œë ¥ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ _(ì¼ë¶€ ê°’ì€ í¸ì§‘ë¨)_:

```bash
dungeon-adventure-sandbox-Application
dungeon-adventure-sandbox-Application: deploying... [2/2]

 âœ…  dungeon-adventure-sandbox-Application

âœ¨  Deployment time: 354s

Outputs:
dungeon-adventure-sandbox-Application.ElectroDbTableTableNameXXX = dungeon-adventure-sandbox-Application-ElectroDbTableXXX-YYY
dungeon-adventure-sandbox-Application.GameApiEndpointXXX = https://xxx.execute-api.region.amazonaws.com/prod/
dungeon-adventure-sandbox-Application.GameUIDistributionDomainNameXXX = xxx.cloudfront.net
dungeon-adventure-sandbox-Application.StoryApiEndpointXXX = https://xxx.execute-api.region.amazonaws.com/prod/
dungeon-adventure-sandbox-Application.UserIdentityUserIdentityIdentityPoolIdXXX = region:xxx
dungeon-adventure-sandbox-Application.UserIdentityUserIdentityUserPoolIdXXX = region_xxx
```

ë‹¤ìŒ ë°©ë²• ì¤‘ í•˜ë‚˜ë¡œ APIë¥¼ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
<ul>
<li>tRPC ë°±ì—”ë“œì˜ ë¡œì»¬ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‹œì‘í•˜ê³  `curl`ì„ ì‚¬ìš©í•˜ì—¬ API í˜¸ì¶œ</li>
<li>
<Drawer title="Sigv4 í™œì„±í™”ëœ curl" trigger="ë°°í¬ëœ APIë¥¼ sigv4 í™œì„±í™”ëœ curlë¡œ í˜¸ì¶œ">

<Tabs>
  <TabItem label="Bash/Linux/macOS">
`.bashrc` íŒŒì¼ì— ë‹¤ìŒ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì¶”ê°€í•˜ê±°ë‚˜(`source`ë¡œ ì ìš©) ë™ì¼í•œ í„°ë¯¸ë„ì— ì§ì ‘ ë¶™ì—¬ë„£ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
// ~/.bashrc
acurl () {
    REGION=$1
    SERVICE=$2
    shift; shift;
    curl --aws-sigv4 "aws:amz:$REGION:$SERVICE" --user "$(aws configure get aws_access_key_id):$(aws configure get aws_secret_access_key)" -H "X-Amz-Security-Token: $(aws configure get aws_session_token)" "$@"
}
```

sigv4 ì¸ì¦ëœ curl ìš”ì²­ì€ ë‹¤ìŒ ì˜ˆì‹œì²˜ëŸ¼ `acurl`ì„ í˜¸ì¶œí•˜ì—¬ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

###### API Gateway
```bash
acurl ap-southeast-2 execute-api -X GET https://xxx
```

###### ìŠ¤íŠ¸ë¦¬ë° ëŒë‹¤ í•¨ìˆ˜ URL
```bash
acurl ap-southeast-2 lambda -N -X POST https://xxx
```
  </TabItem>
  <TabItem label="Windows PowerShell">
PowerShell í”„ë¡œí•„ì— ë‹¤ìŒ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ í˜„ì¬ ì„¸ì…˜ì— ì§ì ‘ ë¶™ì—¬ë„£ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```powershell
# PowerShell profile or current session
function acurl {
    param(
        [Parameter(Mandatory=$true)][string]$Region,
        [Parameter(Mandatory=$true)][string]$Service,
        [Parameter(ValueFromRemainingArguments=$true)][string[]]$CurlArgs
    )

    $AccessKey = aws configure get aws_access_key_id
    $SecretKey = aws configure get aws_secret_access_key
    $SessionToken = aws configure get aws_session_token

    & curl --aws-sigv4 "aws:amz:$Region`:$Service" --user "$AccessKey`:$SecretKey" -H "X-Amz-Security-Token: $SessionToken" @CurlArgs
}
```

sigv4 ì¸ì¦ëœ curl ìš”ì²­ì€ ë‹¤ìŒ ì˜ˆì‹œì²˜ëŸ¼ `acurl`ì„ í˜¸ì¶œí•˜ì—¬ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

###### API Gateway
```powershell
acurl ap-southeast-2 execute-api -X GET https://xxx
```

###### ìŠ¤íŠ¸ë¦¬ë° ëŒë‹¤ í•¨ìˆ˜ URL
```powershell
acurl ap-southeast-2 lambda -N -X POST https://xxx
```
  </TabItem>
</Tabs>

</Drawer>
</li>
</ul>


<Tabs>
  <TabItem label="ë¡œì»¬">
    ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ ë¡œì»¬ `game-api` ì„œë²„ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤:

    <NxCommands highlights={['dungeon-adventure-infra-sandbox-Application-ElectroDbTableXXX-YYY']} env={{TABLE_NAME:"dungeon-adventure-infra-sandbox-Application-ElectroDbTableXXX-YYY"}} commands={["run @dungeon-adventure/game-api:serve"]} />

    <Aside type="caution">
    ê°•ì¡°ëœ í”Œë ˆì´ìŠ¤í™€ë”ë¥¼ CDK ë°°í¬ ì¶œë ¥ ê°’ `dungeon-adventure-infra-sandbox-Application.ElectroDbTableTableNameXXX`ë¡œ ëŒ€ì²´í•˜ì„¸ìš”.
    </Aside>

    ì„œë²„ê°€ ì‹¤í–‰ë˜ë©´ ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

    ```bash
    curl -X GET 'http://localhost:2022/games.query?input=%7B%7D'
    ```
  </TabItem>
  <TabItem label="ë°°í¬ëœ í™˜ê²½">
```bash "https://xxx.execute-api.ap-southeast-2.amazonaws.com/prod/" "ap-southeast-2"
acurl ap-southeast-2 execute-api -X GET 'https://xxx.execute-api.ap-southeast-2.amazonaws.com/prod/games.query?input=%7B%7D'
```
    <Aside type="caution">
    ê°•ì¡°ëœ í”Œë ˆì´ìŠ¤í™€ë”ë¥¼ CDK ë°°í¬ ì¶œë ¥ ê°’ `dungeon-adventure-infra-sandbox-Application.GameApiGameApiEndpointXXX`ë¡œ ëŒ€ì²´í•˜ê³  ë¦¬ì „ì„ ì ì ˆíˆ ì„¤ì •í•˜ì„¸ìš”.
    </Aside>
  </TabItem>
</Tabs>

:::note
API í…ŒìŠ¤íŠ¸ ì‹œ ì „ë‹¬í•˜ëŠ” `%7B%7D`ëŠ” URI ì¸ì½”ë”©ëœ ë¹ˆ JSON ê°ì²´(`{}`)ì…ë‹ˆë‹¤.
:::

ëª…ë ¹ì–´ê°€ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì‘ë‹µì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```json
{"result":{"data":{"items":[],"cursor":null}}}
```

ì¶•í•˜í•©ë‹ˆë‹¤! tRPCë¥¼ ì‚¬ìš©í•˜ì—¬ ì²« ë²ˆì§¸ APIë¥¼ êµ¬ì¶•í•˜ê³  ë°°í¬í–ˆìŠµë‹ˆë‹¤! ğŸ‰ğŸ‰ğŸ‰