---
title: "ì—ì´ì „íŠ¸í˜• AI ë˜ì „ ê²Œì„"
description: "@aws/nx-pluginì„ ì‚¬ìš©í•˜ì—¬ ì—ì´ì „íŠ¸í˜• AI ê¸°ë°˜ ë˜ì „ ëª¨í—˜ ê²Œì„ì„ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì— ëŒ€í•œ ì•ˆë‚´"
---



import { Aside, Code, FileTree, Steps, Tabs, TabItem } from '@astrojs/starlight/components';
import { Image } from 'astro:assets';
import Drawer from '@components/drawer.astro';
import Link from '@components/link.astro';
import RunGenerator from '@components/run-generator.astro';
import NxCommands from '@components/nx-commands.astro';
import InstallCommand from '@components/install-command.astro';
import E2ECode from '@components/e2e-code.astro';
import E2EDiff from '@components/e2e-diff.astro';

import dungeonAdventureArchitecturePng from '@assets/dungeon-game-architecture.png'
import dungeonAdventureErPng from '@assets/dungeon-adventure-er.png'
import baselineWebsitePng from '@assets/baseline-website.png'
import baselineGamePng from '@assets/baseline-game.png'
import nxGraphPng from '@assets/nx-graph.png'
import gameSelectPng from '@assets/game-select.png'
import gameConversationPng from '@assets/game-conversation.png'

## ëª¨ë“ˆ 3: ìŠ¤í† ë¦¬ ì—ì´ì „íŠ¸ êµ¬í˜„

<Aside type="caution">
AWS ê³„ì •ì´ [ì´ ê°€ì´ë“œ](https://docs.aws.amazon.com/bedrock/latest/userguide/model-access-modify.html)ì— ì„¤ëª…ëœ ë‹¨ê³„ë¥¼ í†µí•´ ëŒ€ìƒ ë¦¬ì „ì—ì„œ Bedrockì˜ [Strands ê¸°ë³¸ ëª¨ë¸](https://strandsagents.com/latest/documentation/docs/user-guide/concepts/model-providers/amazon-bedrock/) ì ‘ê·¼ì„ í™œì„±í™”í–ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”. ë³¸ ë¬¸ì„œ ì‘ì„± ì‹œì  ê¸°ì¤€ìœ¼ë¡œëŠ” Anthropic Claude Sonnet 4 ëª¨ë¸ì…ë‹ˆë‹¤.
</Aside>

ìŠ¤í† ë¦¬ ì—ì´ì „íŠ¸ëŠ” [Strands](https://strandsagents.com/) ì—ì´ì „íŠ¸ë¡œ, `Game`ê³¼ ì»¨í…ìŠ¤íŠ¸ìš© `Action` ëª©ë¡ì„ ì…ë ¥ë°›ì•„ ìŠ¤í† ë¦¬ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤. ì´ ì—ì´ì „íŠ¸ë¥¼ ì¸ë²¤í† ë¦¬ MCP ì„œë²„ì™€ ì—°ë™í•˜ë„ë¡ êµ¬ì„±í•˜ì—¬ í”Œë ˆì´ì–´ì˜å¯ç”¨í•œ ì•„ì´í…œì„ ê´€ë¦¬í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.

:::note
ë³¸ íŠœí† ë¦¬ì–¼ì—ì„œëŠ” ê°„ì†Œí™”ë¥¼ ìœ„í•´ ê° í˜¸ì¶œì´ ì „ì²´ ë©”ì‹œì§€ ê¸°ë¡ì„ í¬í•¨í•˜ëŠ” ë…ë¦½ ì„¸ì…˜ì¸ "ìƒíƒœ ë¹„ì €ì¥" ë°©ì‹ìœ¼ë¡œ ì—ì´ì „íŠ¸ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤. í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” [Bedrock AgentCore ë©”ëª¨ë¦¬](https://docs.aws.amazon.com/bedrock-agentcore/latest/devguide/memory.html) í†µí•©ì„ ê³ ë ¤í•˜ì„¸ìš”. Strandsì™€ AgentCore ë©”ëª¨ë¦¬ ì‚¬ìš©ì— ëŒ€í•œ ì¶”ê°€ ë¬¸ì„œëŠ” [ì—¬ê¸°ì—ì„œ í™•ì¸](https://github.com/aws/bedrock-agentcore-sdk-python/tree/main/src/bedrock_agentcore/memory/integrations/strands)í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
:::

### ì—ì´ì „íŠ¸ êµ¬í˜„

ì—ì´ì „íŠ¸ë¥¼ êµ¬í˜„í•´ ë³´ê² ìŠµë‹ˆë‹¤. `packages/story/dungeon_adventure_story/agent` ë‚´ ë‹¤ìŒ íŒŒì¼ë“¤ì„ ì—…ë°ì´íŠ¸í•˜ì„¸ìš”:

<Tabs>
  <TabItem label="main.py">
<E2EDiff lang="python" before="dungeon-adventure/3/main.py.old.template" after="dungeon-adventure/3/main.py.template" />
  </TabItem>
  <TabItem label="agent.py">
<E2EDiff lang="python" before="dungeon-adventure/3/agent.py.old.template" after="dungeon-adventure/3/agent.py.template" />
  </TabItem>
</Tabs>

ì´ êµ¬ì„±ì€ ë‹¤ìŒì„ ì„¤ì •í•©ë‹ˆë‹¤:

- ì—ì´ì „íŠ¸ í˜ì´ë¡œë“œì—ì„œ í”Œë ˆì´ì–´, ì¥ë¥´, ì•¡ì…˜ ì¶”ì¶œ
- SigV4 ì¸ì¦ìœ¼ë¡œ MCP ì„œë²„ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆëŠ” í´ë¼ì´ì–¸íŠ¸ êµ¬ì„±
- ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ì™€ MCP ì„œë²„ ë„êµ¬ë¥¼ í¬í•¨í•œ ì—ì´ì „íŠ¸ êµ¬ì„±

### ë°°í¬ ë° í…ŒìŠ¤íŠ¸

ë¨¼ì € ì½”ë“œë² ì´ìŠ¤ë¥¼ ë¹Œë“œí•©ë‹ˆë‹¤:

<NxCommands commands={['run-many --target build --all']} />

<Aside type="tip">
ë¦°íŠ¸ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ ìë™ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<NxCommands commands={['run-many --target lint --configuration=fix --all']} />
</Aside>

ì´ì œ ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

<NxCommands commands={['deploy infra dungeon-adventure-infra-sandbox/*']} />

ë°°í¬ëŠ” ì•½ 2ë¶„ ì •ë„ ì†Œìš”ë©ë‹ˆë‹¤.

ë°°í¬ê°€ ì™„ë£Œë˜ë©´ ë‹¤ìŒê³¼ ìœ ì‚¬í•œ ì¶œë ¥ì´ í‘œì‹œë©ë‹ˆë‹¤ _(ì¼ë¶€ ê°’ì€ í¸ì§‘ë¨)_:

```bash
dungeon-adventure-infra-sandbox-Application
dungeon-adventure-infra-sandbox-Application: deploying... [2/2]

 âœ…  dungeon-adventure-infra-sandbox-Application

âœ¨  Deployment time: 354s

Outputs:
dungeon-adventure-infra-sandbox-Application.ElectroDbTableTableNameXXX = dungeon-adventure-infra-sandbox-Application-ElectroDbTableXXX-YYY
dungeon-adventure-infra-sandbox-Application.GameApiEndpointXXX = https://xxx.execute-api.region.amazonaws.com/prod/
dungeon-adventure-infra-sandbox-Application.GameUIDistributionDomainNameXXX = xxx.cloudfront.net
dungeon-adventure-infra-sandbox-Application.InventoryMcpArn = arn:aws:bedrock-agentcore:region:xxxxxxx:runtime/dungeonadventureventoryMcpServerXXXX-YYYY
dungeon-adventure-infra-sandbox-Application.StoryAgentArn = arn:aws:bedrock-agentcore:region:xxxxxxx:runtime/dungeonadventurecationStoryAgentXXXX-YYYY
dungeon-adventure-infra-sandbox-Application.UserIdentityUserIdentityIdentityPoolIdXXX = region:xxx
dungeon-adventure-infra-sandbox-Application.UserIdentityUserIdentityUserPoolIdXXX = region_xxx
```

ë‹¤ìŒ ë°©ë²• ì¤‘ í•˜ë‚˜ë¡œ APIë¥¼ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
<ul>
<li>ì—ì´ì „íŠ¸ ì„œë²„ ë¡œì»¬ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‹œì‘í•˜ê³  `curl`ë¡œ í˜¸ì¶œ</li>
<li>JWT í† í°ì„ ì‚¬ìš©í•˜ì—¬ ë°°í¬ëœ APIë¥¼ curlë¡œ í˜¸ì¶œ</li>
</ul>

<Tabs>
  <TabItem label="Local">
  ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ ë¡œì»¬ ì—ì´ì „íŠ¸ ì„œë²„ë¥¼ ì‹œì‘í•˜ì„¸ìš”:
    <NxCommands highlights={['arn:aws:bedrock-agentcore:region:xxxxxxx:runtime/dungeonadventureventoryMcpServerXXXX-YYYY', 'region']} env={{PORT: '9999', INVENTORY_MCP_ARN:"arn:aws:bedrock-agentcore:region:xxxxxxx:runtime/dungeonadventureventoryMcpServerXXXX-YYYY", AWS_REGION: '<region>'}} commands={["run dungeon_adventure.story:agent-serve"]} />

    :::caution
    ìœ„ ëª…ë ¹ì–´ì—ì„œ CDK ë°°í¬ ì¶œë ¥ê°’ `InventoryMcpArn`ì„ ì‚¬ìš©í•˜ê³  ëŒ€ìƒ `AWS_REGION`ì„ ì§€ì •í•˜ì„¸ìš”.
    :::

    ì—ì´ì „íŠ¸ ì„œë²„ê°€ ì‹¤í–‰ë˜ë©´(ì½˜ì†”ì— ì¶œë ¥ë˜ì§€ ì•ŠìŒ) ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ í˜¸ì¶œí•˜ì„¸ìš”:

    ```bash
    curl -N -X POST http://127.0.0.1:9999/invocations \
      -d '{"genre":"superhero", "actions":[], "playerName":"UnnamedHero"}' \
      -H "Content-Type: application/json" \
      -H "X-Amzn-Bedrock-AgentCore-Runtime-Session-Id: abcdefghijklmnopqrstuvwxyz-123456789"
    ```
  </TabItem>
  <TabItem label="Deployed">
    ë°°í¬ëœ ì—ì´ì „íŠ¸ë¥¼ í…ŒìŠ¤íŠ¸í•˜ë ¤ë©´ Cognitoë¡œ ì¸ì¦ í›„ JWT í† í°ì„ íšë“í•´ì•¼ í•©ë‹ˆë‹¤. ë¨¼ì € í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•˜ì„¸ìš”:

    ```bash
    # CDK ì¶œë ¥ì—ì„œ Cognito User Pool IDì™€ Client ID ì„¤ì •
    export POOL_ID="<CDK ì¶œë ¥ì˜ UserPoolId>"
    export CLIENT_ID="<CDK ì¶œë ¥ì˜ UserPoolClientId>"
    export REGION="<ë¦¬ì „>"
    ```

    í…ŒìŠ¤íŠ¸ ì‚¬ìš©ìë¥¼ ìƒì„±í•˜ê³  ì¸ì¦ í† í°ì„ íšë“í•˜ì„¸ìš”:

    ```bash
    # ì‚¬ìš©ì ìƒì„±
    aws cognito-idp admin-create-user \
      --user-pool-id $POOL_ID \
      --username "testuser" \
      --temporary-password "TempPass123!" \
      --region $REGION \
      --message-action SUPPRESS > /dev/null

    # ì˜êµ¬ ë¹„ë°€ë²ˆí˜¸ ì„¤ì •(ë” ì•ˆì „í•œ ë¹„ë°€ë²ˆí˜¸ë¡œ êµì²´ ê¶Œì¥)
    aws cognito-idp admin-set-user-password \
      --user-pool-id $POOL_ID \
      --username "testuser" \
      --password "PermanentPass123!" \
      --region $REGION \
      --permanent > /dev/null

    # ì‚¬ìš©ì ì¸ì¦ ë° ID í† í° íšë“
    export BEARER_TOKEN=$(aws cognito-idp initiate-auth \
      --client-id "$CLIENT_ID" \
      --auth-flow USER_PASSWORD_AUTH \
      --auth-parameters USERNAME='testuser',PASSWORD='PermanentPass123!' \
      --region $REGION | jq -r '.AuthenticationResult.IdToken')
    ```

    :::caution
    `POOL_ID`ì—ëŠ” CDK ë°°í¬ ì¶œë ¥ì˜ `UserIdentityUserIdentityUserPoolIdXXX`ë¥¼ ì‚¬ìš©í•˜ê³  CDK ì¶œë ¥ì—ì„œ í•´ë‹¹ Client IDë¥¼ í™•ì¸í•˜ì„¸ìš”.
    :::

    ì´ì œ Bedrock AgentCore ëŸ°íƒ€ì„ URLì„ ì‚¬ìš©í•˜ì—¬ ë°°í¬ëœ ì—ì´ì „íŠ¸ë¥¼ í˜¸ì¶œí•˜ì„¸ìš”:

    ```bash
    # CDK ì¶œë ¥ì—ì„œ Story Agent ARN ì„¤ì •
    export AGENT_ARN="<CDK ì¶œë ¥ì˜ StoryAgentArn>"

    # ARN URL ì¸ì½”ë”©
    export ENCODED_ARN=$(echo $AGENT_ARN | sed 's/:/%3A/g' | sed 's/\//%2F/g')

    # í˜¸ì¶œ URL êµ¬ì„±
    export MCP_URL="https://bedrock-agentcore.$REGION.amazonaws.com/runtimes/$ENCODED_ARN/invocations?qualifier=DEFAULT"

    # ì—ì´ì „íŠ¸ í˜¸ì¶œ
    curl -N -X POST "$MCP_URL" \
      -H "authorization: Bearer $BEARER_TOKEN" \
      -H "Content-Type: application/json" \
      -H "X-Amzn-Bedrock-AgentCore-Runtime-Session-Id: abcdefghijklmnopqrstuvwxyz-123456789" \
      -d '{"genre":"superhero", "actions":[], "playerName":"UnnamedHero"}'
    ```

    :::note
    ARNì„ Bedrock AgentCore API ì—”ë“œí¬ì¸íŠ¸ì— ë§ê²Œ ì˜¬ë°”ë¥´ê²Œ í¬ë§·í•˜ë ¤ë©´ URL ì¸ì½”ë”©ì´ í•„ìš”í•©ë‹ˆë‹¤.
    :::
  </TabItem>
</Tabs>

ëª…ë ¹ì´ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë˜ë©´ ë‹¤ìŒê³¼ ìœ ì‚¬í•œ ìŠ¤íŠ¸ë¦¬ë° ì´ë²¤íŠ¸ê°€ í‘œì‹œë©ë‹ˆë‹¤:

```
data: {"init_event_loop": true}

data: {"start": true}

data: {"start_event_loop": true}

data: {"event": {"messageStart": {"role": "assistant"}}}

data: {"event": {"contentBlockDelta": {"delta": {"text": "Welcome"}, "contentBlockIndex": 0}}}

...
```

ì¶•í•˜í•©ë‹ˆë‹¤. Bedrock AgentCore ëŸ°íƒ€ì„ì— ì²« ë²ˆì§¸ Strands ì—ì´ì „íŠ¸ë¥¼ êµ¬ì¶•í•˜ê³  ë°°í¬í–ˆìŠµë‹ˆë‹¤! ğŸ‰ğŸ‰ğŸ‰