---
title: "생성기 만들기"
description: "@aws/nx-plugin을 사용하여 생성기를 빌드하는 방법에 대한 연습."
---

import { Aside, Code, FileTree, Steps, Tabs, TabItem } from '@astrojs/starlight/components';
import { Image } from 'astro:assets';
import Drawer from '@components/drawer.astro';
import Link from '@components/link.astro';
import RunGenerator from '@components/run-generator.astro';
import NxCommands from '@components/nx-commands.astro';
import InstallCommand from '@components/install-command.astro';
import dungeonAdventureArchitecturePng from '@assets/dungeon-game-architecture.png'
import dungeonAdventureErPng from '@assets/dungeon-adventure-er.png'
import baselineWebsitePng from '@assets/baseline-website.png'
import baselineGamePng from '@assets/baseline-game.png'
import nxGraphPng from '@assets/nx-graph.png'
import gameSelectPng from '@assets/game-select.png'
import gameConversationPng from '@assets/game-conversation.png'

## 제너레이터 빌드하기

tRPC API에 대한 새로운 프로시저를 생성하는 새 제너레이터를 만들어 보겠습니다.

### 플러그인 확인하기

먼저, 플러그인을 클론합니다:

```bash
git clone git@github.com:awslabs/nx-plugin-for-aws.git
```

다음으로, 설치 및 빌드:

```bash
cd nx-plugin-for-aws
pnpm i
pnpm nx run-many --target build --all
```

### 빈 제너레이터 생성하기

`packages/nx-plugin/src/trpc/procedure`에 새 제너레이터를 생성하겠습니다. 스키마와 제너레이터의 진입점을 만들어 시작하겠습니다:

<FileTree>
  - packages/nx-plugin/src/trpc/procedure
    - schema.json 제너레이터의 입력을 정의
    - schema.d.ts 스키마와 일치하는 타입스크립트 인터페이스
    - generator.ts Nx가 실행하는 제너레이터 함수
</FileTree>

각 파일에 아래 내용을 추가합니다.

<Tabs>
  <TabItem label="schema.json">
    ```json
    {
      "$schema": "https://json-schema.org/schema",
      "$id": "tRPCProcedure",
      "title": "tRPC API에 프로시저 추가",
      "type": "object",
      "properties": {
        "project": {
          "type": "string",
          "description": "tRPC API 프로젝트",
          "x-prompt": "프로시저를 추가할 tRPC API 프로젝트 선택",
          "x-dropdown": "projects",
          "x-priority": "important"
        },
        "procedure": {
          "description": "새 프로시저의 이름",
          "type": "string",
          "x-prompt": "새 프로시저의 이름을 무엇으로 하시겠습니까?",
          "x-priority": "important",
        },
        "type": {
          "description": "생성할 프로시저 유형",
          "type": "string",
          "x-prompt": "어떤 유형의 프로시저를 생성하시겠습니까?",
          "x-priority": "important",
          "default": "query",
          "enum": ["query", "mutation"]
        }
      },
      "required": ["project", "procedure"]
    }
    ```
  </TabItem>
  <TabItem label="schema.d.ts">
    ```ts
    export interface TrpcProcedureSchema {
      project: string;
      procedure: string;
      type: 'query' | 'mutation';
    }
    ```
  </TabItem>
  <TabItem label="generator.ts">
    ```ts
    import { Tree } from '@nx/devkit';
    import { TrpcProcedureSchema } from './schema';

    export const trpcProcedureGenerator = async (tree: Tree, options: TrpcProcedureSchema) => {

    };

    export default trpcProcedureGenerator;

    ```
  </TabItem>
</Tabs>

:::note
제너레이터에는 `Tree`와 스키마에서 정의한 옵션이 입력으로 제공됩니다. `Tree`는 본질적으로 가상 파일 시스템으로, 프로젝트 파일을 읽고 쓸 수 있습니다. 사용자가 "드라이 런" 모드에서 제너레이터를 실행할 경우 파일 시스템을 직접 수정하지 않으려고 합니다.
:::

다음으로, `packages/nx-plugin/generators.json`을 업데이트하여 제너레이터를 연결하겠습니다:

```json
 ...
  "generators": {
    ...
    "ts#trpc-api#procedure": {
      "factory": "./src/trpc/procedure/generator",
      "schema": "./src/trpc/procedure/schema.json",
      "description": "tRPC API에 프로시저 추가"
    }
  },
...
```

(나머지 번역은 동일한 방식으로 계속됩니다)