---
title: "MCP 베드락 배포"
---



import Link from '@components/link.astro'

### CDK 컨스트럭트

`computeType`으로 `BedrockAgentCoreRuntime`을 선택한 경우 [Amazon Bedrock AgentCore Runtime](https://docs.aws.amazon.com/bedrock-agentcore/latest/devguide/agents-tools-runtime.html)에 MCP 서버를 배포하는 데 사용할 수 있는 CDK 컨스트럭트가 생성됩니다.

다음과 같이 CDK 애플리케이션에서 이 CDK 컨스트럭트를 사용할 수 있습니다:

```ts {6}
import { MyProjectMcpServer } from ':my-scope/common-constructs';

export class ExampleStack extends Stack {
  constructor(scope: Construct, id: string) {
    // 스택에 MCP 서버 추가
    new MyProjectMcpServer(this, 'MyProjectMcpServer');
  }
}
```

:::caution
MCP 서버 빌드 및 배포에는 [Docker](https://www.docker.com/)가 필요합니다. 다음 오류를 방지하려면 Docker를 설치하고 실행했는지 확인하세요:

```
ERROR: Cannot connect to the Docker daemon at unix://path/to/docker.sock.
```
:::

### 인증

#### IAM

기본적으로 MCP 서버는 IAM 인증을 사용하여 보호됩니다. 인수 없이 배포하면 됩니다:

```ts {5}
import { MyProjectMcpServer } from ':my-scope/common-constructs';

export class ExampleStack extends Stack {
  constructor(scope: Construct, id: string) {
    new MyProjectMcpServer(this, 'MyProjectMcpServer');
  }
}
```

`grantInvoke` 메서드를 사용하여 Bedrock AgentCore Runtime에서 MCP를 호출할 수 있는 권한을 부여할 수 있습니다. 예를 들어 <Link path="/guides/py-strands-agent">`py#strands-agent`</Link> 생성기로 생성된 에이전트가 MCP 서버를 호출하도록 허용할 수 있습니다:

```ts {8}
import { MyProjectAgent, MyProjectMcpServer } from ':my-scope/common-constructs';

export class ExampleStack extends Stack {
  constructor(scope: Construct, id: string) {
    const agent = new MyProjectAgent(this, 'MyProjectAgent');
    const mcpServer = new MyProjectMcpServer(this, 'MyProjectMcpServer');

    mcpServer.agentCoreRuntime.grantInvoke(agent.agentCoreRuntime);
  }
}
```

#### Cognito JWT 인증

JWT 인증을 구성하려면 MCP 서버 컨스트럭트에 `authorizerConfiguration` 속성을 전달할 수 있습니다. 다음은 Cognito 사용자 풀과 클라이언트를 구성하여 MCP 서버를 보호하는 예시입니다:

```ts {14-17}
import { MyProjectMcpServer } from ':my-scope/common-constructs';

export class ExampleStack extends Stack {
  constructor(scope: Construct, id: string) {
    const userPool = new UserPool(this, 'UserPool');
    const client = userPool.addClient('Client', {
      authFlows: {
        userPassword: true,
      },
    });

    new MyProjectMcpServer(this, 'MyProjectMcpServer', {
      authorizerConfiguration: {
        customJWTAuthorizer: {
          discoveryUrl: `https://cognito-idp.${Stack.of(userPool).region}.amazonaws.com/${userPool.userPoolId}/.well-known/openid-configuration`,
          allowedClients: [client.userPoolClientId],
        },
      },
    });
  }
}
```