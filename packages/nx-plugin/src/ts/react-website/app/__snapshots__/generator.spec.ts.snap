// Vitest Snapshot v1, https://vitest.dev/guide/snapshot.html

exports[`react-website generator > TailwindCSS integration > should configure vite with TailwindCSS plugin by default > vite.config.ts-with-tailwind 1`] = `
"import tailwindcss from '@tailwindcss/vite';
import tsconfigPaths from 'vite-tsconfig-paths';
import { resolve } from 'path';
import { tanstackRouter } from '@tanstack/router-plugin/vite';
/// <reference types='vitest' />
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig(() => ({
  define: {
    global: {},
  },
  root: __dirname,
  cacheDir: '../node_modules/.vite/test-app',
  server: {
    port: 4200,
    host: 'localhost',
  },
  preview: {
    port: 4300,
    host: 'localhost',
  },
  plugins: [
    tanstackRouter({
      routesDirectory: resolve(__dirname, 'src/routes'),
      generatedRouteTree: resolve(__dirname, 'src/routeTree.gen.ts'),
    }),
    react(),
    tailwindcss(),
    tsconfigPaths(),
  ],
  build: {
    outDir: '../dist/test-app',
    emptyOutDir: true,
    reportCompressedSize: true,
    commonjsOptions: {
      transformMixedEsModules: true,
    },
  },
  test: {
    name: '@proj/test-app',
    watch: false,
    globals: true,
    environment: 'jsdom',
    include: ['{src,tests}/**/*.{test,spec}.{js,mjs,cjs,ts,mts,cts,jsx,tsx}'],
    reporters: ['default'],
    coverage: {
      reportsDirectory: './test-output/vitest/coverage',
      provider: 'v8' as const,
    },
    passWithNoTests: true,
  },
}));
"
`;

exports[`react-website generator > TailwindCSS integration > should configure vite without TailwindCSS plugin when disabled > vite.config.ts-without-tailwind 1`] = `
"import tsconfigPaths from 'vite-tsconfig-paths';
import { resolve } from 'path';
import { tanstackRouter } from '@tanstack/router-plugin/vite';
/// <reference types='vitest' />
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig(() => ({
  define: {
    global: {},
  },
  root: __dirname,
  cacheDir: '../node_modules/.vite/test-app',
  server: {
    port: 4200,
    host: 'localhost',
  },
  preview: {
    port: 4300,
    host: 'localhost',
  },
  plugins: [
    tanstackRouter({
      routesDirectory: resolve(__dirname, 'src/routes'),
      generatedRouteTree: resolve(__dirname, 'src/routeTree.gen.ts'),
    }),
    react(),
    tsconfigPaths(),
  ],
  build: {
    outDir: '../dist/test-app',
    emptyOutDir: true,
    reportCompressedSize: true,
    commonjsOptions: {
      transformMixedEsModules: true,
    },
  },
  test: {
    name: '@proj/test-app',
    watch: false,
    globals: true,
    environment: 'jsdom',
    include: ['{src,tests}/**/*.{test,spec}.{js,mjs,cjs,ts,mts,cts,jsx,tsx}'],
    reporters: ['default'],
    coverage: {
      reportsDirectory: './test-output/vitest/coverage',
      provider: 'v8' as const,
    },
    passWithNoTests: true,
  },
}));
"
`;

exports[`react-website generator > TailwindCSS integration > should include TailwindCSS import in styles.css by default > styles.css-with-tailwind 1`] = `
"@import 'tailwindcss';
/* You can add global styles to this file, and also import other style files */
"
`;

exports[`react-website generator > TailwindCSS integration > should not include TailwindCSS import in styles.css when disabled > styles.css-without-tailwind 1`] = `
"/* You can add global styles to this file, and also import other style files */
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > .gitignore 1`] = `
"vite.config.*.timestamp*
vitest.config.*.timestamp*

runtime-config.json"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > .prettierrc 1`] = `
"{ "singleQuote": true }
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > eslint.config.mjs 1`] = `
"import eslintPluginPrettierRecommended from 'eslint-plugin-prettier/recommended';
import nx from '@nx/eslint-plugin';

export default [
  eslintPluginPrettierRecommended,
  ...nx.configs['flat/base'],
  ...nx.configs['flat/typescript'],
  ...nx.configs['flat/javascript'],
  {
    ignores: [
      '**/dist',
      '**/vite.config.*.timestamp*',
      '**/vitest.config.*.timestamp*',
      '**/vite.config.ts.timestamp*',
    ],
  },
  {
    files: ['**/*.ts', '**/*.tsx', '**/*.js', '**/*.jsx'],
    rules: {
      '@nx/enforce-module-boundaries': [
        'error',
        {
          enforceBuildableLibDependency: true,
          allow: ['^.*/eslint(\\\\.base)?\\\\.config\\\\.[cm]?[jt]s$'],
          depConstraints: [
            {
              sourceTag: '*',
              onlyDependOnLibsWithTags: ['*'],
            },
          ],
        },
      ],
    },
  },
  {
    files: [
      '**/*.ts',
      '**/*.tsx',
      '**/*.cts',
      '**/*.mts',
      '**/*.js',
      '**/*.jsx',
      '**/*.cjs',
      '**/*.mjs',
    ],
    rules: {},
  },
];
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > nx.json 1`] = `
"{
  "affected": {
    "defaultBase": "main"
  },
  "targetDefaults": {
    "build": {
      "cache": true,
      "dependsOn": ["^build"],
      "inputs": ["default"]
    },
    "lint": {
      "cache": true,
      "configurations": {
        "fix": {
          "fix": true
        }
      },
      "inputs": [
        "default",
        "{workspaceRoot}/eslint.config.mjs",
        "{projectRoot}/eslint.config.mjs"
      ]
    },
    "@nx/eslint:lint": {
      "cache": true,
      "inputs": [
        "default",
        "{workspaceRoot}/.eslintrc.json",
        "{workspaceRoot}/.eslintignore",
        "{workspaceRoot}/eslint.config.mjs"
      ]
    },
    "@nx/vite:test": {
      "cache": true,
      "inputs": ["default", "^default"],
      "configurations": {
        "update-snapshot": {
          "args": "--update"
        }
      }
    },
    "@nx/vite:build": {
      "cache": true,
      "dependsOn": ["^build"],
      "inputs": ["default", "^default"]
    },
    "test": {
      "dependsOn": ["^build"],
      "inputs": ["default"]
    },
    "compile": {
      "cache": true,
      "inputs": ["default"]
    }
  },
  "generators": {
    "@nx/react": {
      "application": {
        "babel": true,
        "style": "css",
        "linter": "eslint",
        "bundler": "vite"
      },
      "component": {
        "style": "css"
      },
      "library": {
        "style": "css",
        "linter": "eslint"
      }
    }
  },
  "plugins": [
    {
      "plugin": "@nx/js/typescript",
      "options": {
        "typecheck": {
          "targetName": "typecheck"
        },
        "build": {
          "targetName": "compile",
          "configName": "tsconfig.lib.json",
          "buildDepsName": "build-deps",
          "watchDepsName": "watch-deps"
        }
      }
    },
    {
      "plugin": "@nx/eslint/plugin",
      "options": {
        "targetName": "lint"
      }
    }
  ],
  "namedInputs": {
    "default": [
      {
        "dependentTasksOutputFiles": "**/*",
        "transitive": true
      }
    ]
  }
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > package.json 1`] = `
"{
  "name": "@proj/source",
  "dependencies": {
    "@cloudscape-design/board-components": "3.0.117",
    "@cloudscape-design/components": "3.0.1075",
    "@cloudscape-design/global-styles": "1.0.45",
    "aws-cdk-lib": "2.213.0",
    "constructs": "10.4.2",
    "react": "19.0.0",
    "react-dom": "19.0.0",
    "tailwindcss": "4.1.12"
  },
  "devDependencies": {
    "@eslint/js": "^9.8.0",
    "@nx/eslint": "21.4.1",
    "@nx/eslint-plugin": "21.4.1",
    "@nx/js": "21.4.1",
    "@nx/react": "21.4.1",
    "@nx/vite": "21.4.1",
    "@nx/web": "21.4.1",
    "@swc-node/register": "~1.9.1",
    "@swc/cli": "~0.6.0",
    "@swc/core": "~1.5.7",
    "@swc/helpers": "~0.5.11",
    "@tailwindcss/vite": "4.1.12",
    "@testing-library/dom": "10.4.0",
    "@testing-library/react": "16.1.0",
    "@types/node": "22.18.0",
    "@types/react": "19.0.0",
    "@types/react-dom": "19.0.0",
    "@vitejs/plugin-react": "^4.2.0",
    "@vitest/coverage-v8": "^3.0.5",
    "@vitest/ui": "^3.0.0",
    "eslint": "^9.8.0",
    "eslint-config-prettier": "^10.0.0",
    "eslint-plugin-import": "2.31.0",
    "eslint-plugin-jsx-a11y": "6.10.1",
    "eslint-plugin-prettier": "5.5.4",
    "eslint-plugin-react": "7.35.0",
    "eslint-plugin-react-hooks": "5.0.0",
    "jiti": "2.4.2",
    "jsdom": "~22.1.0",
    "jsonc-eslint-parser": "2.4.0",
    "prettier": "3.6.2",
    "typescript": "~5.8.2",
    "typescript-eslint": "^8.29.0",
    "vite": "^6.0.0",
    "vite-tsconfig-paths": "5.1.4",
    "vitest": "^3.0.0"
  },
  "type": "module"
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > packages/common/constructs/README.md 1`] = `
"# @proj/common-constructs

This library was generated with [@aws/nx-plugin](https://github.com/awslabs/nx-plugin-for-aws/).

## Building

Run \`npx nx build @proj/common-constructs [--skip-nx-cache]\` to build the application.

## Running unit tests

Run \`npx nx test @proj/common-constructs\` to execute the unit tests via Vitest.

### Updating snapshots

To update snapshots, run the following command:

\`npx nx test @proj/common-constructs --configuration=update-snapshot\`

## Run lint

Run \`npx nx lint @proj/common-constructs\`

### Fixable issues

You can also automatiaclly fix some lint errors by running the following command:

\`npx nx lint @proj/common-constructs --configuration=fix\`

## Useful links

- [common-constructs reference docs](TODO)
- [Learn more about NX](https://nx.dev/getting-started/intro)
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > packages/common/constructs/eslint.config.mjs 1`] = `
"import baseConfig from '../../../eslint.config.mjs';

export default [
  ...baseConfig,
  {
    files: ['**/*.json'],
    rules: {
      '@nx/dependency-checks': [
        'warn',
        {
          ignoredFiles: [
            '{projectRoot}/eslint.config.{js,cjs,mjs,ts,cts,mts}',
            '{projectRoot}/vite.config.{js,ts,mjs,mts}',
          ],
        },
      ],
    },
    languageOptions: {
      parser: await import('jsonc-eslint-parser'),
    },
  },
];
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > packages/common/constructs/project.json 1`] = `
"{
  "name": "@proj/common-constructs",
  "$schema": "../../../node_modules/nx/schemas/project-schema.json",
  "sourceRoot": "packages/common/constructs/src",
  "projectType": "library",
  "tags": [],
  "targets": {
    "build": {
      "dependsOn": ["lint", "compile", "test", "@proj/test-app:build"]
    },
    "compile": {
      "executor": "nx:run-commands",
      "outputs": ["{workspaceRoot}/dist/packages/common/constructs/tsc"],
      "options": {
        "command": "tsc --build tsconfig.lib.json",
        "cwd": "{projectRoot}"
      }
    },
    "test": {
      "executor": "@nx/vite:test",
      "outputs": ["{options.reportsDirectory}"],
      "options": {
        "reportsDirectory": "../../../coverage/packages/common/constructs"
      }
    }
  },
  "metadata": {
    "generator": "ts#project"
  }
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > packages/common/constructs/src/app/index.ts 1`] = `
"export * from './static-websites/index.js';
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > packages/common/constructs/src/app/static-websites/index.ts 1`] = `
"export * from './test-app.js';
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > packages/common/constructs/src/app/static-websites/test-app.ts 1`] = `
"import * as url from 'url';
import { Construct } from 'constructs';
import { StaticWebsite } from '../../core/index.js';

export class TestApp extends StaticWebsite {
  constructor(scope: Construct, id: string) {
    super(scope, id, {
      websiteName: 'TestApp',
      websiteFilePath: url.fileURLToPath(
        new URL('../../../../../../dist/test-app/bundle', import.meta.url),
      ),
    });
  }
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > packages/common/constructs/src/core/app.ts 1`] = `
"import { App as _App, AppProps, Aspects, IAspect, Stack } from 'aws-cdk-lib';
import { IConstruct } from 'constructs';

export class App extends _App {
  constructor(props?: AppProps) {
    super(props);

    Aspects.of(this).add(new MetricsAspect());
  }
}

/**
 * Adds information to CloudFormation stack descriptions to provide usage metrics for @aws/nx-plugin
 */
class MetricsAspect implements IAspect {
  visit(node: IConstruct): void {
    if (node instanceof Stack) {
      const id = 'uksb-4wk0bqpg5s';
      const version = '0.0.0';
      const tags: string[] = ['g5'];
      node.templateOptions.description =
        \`\${node.templateOptions.description ?? ''} (\${id}) (version:\${version}) (tag:\${tags.join(',')})\`.trim();
    }
  }
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > packages/common/constructs/src/core/index.ts 1`] = `
"export * from './static-website.js';
export * from './app.js';
export * from './runtime-config.js';
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > packages/common/constructs/src/core/runtime-config.ts 1`] = `
"import { Stack, Stage } from 'aws-cdk-lib';
import { Construct } from 'constructs';

const RuntimeConfigKey = '__RuntimeConfig__';

export class RuntimeConfig extends Construct {
  private readonly _runtimeConfig: any = {};

  static ensure(scope: Construct): RuntimeConfig {
    const parent = Stage.of(scope) ?? Stack.of(scope);
    return (
      RuntimeConfig.of(scope) ?? new RuntimeConfig(parent, RuntimeConfigKey)
    );
  }

  static of(scope: Construct): RuntimeConfig | undefined {
    const parent = Stage.of(scope) ?? Stack.of(scope);
    return parent.node.tryFindChild(RuntimeConfigKey) as
      | RuntimeConfig
      | undefined;
  }

  constructor(scope: Construct, id: string) {
    super(scope, id);
  }

  get config(): any {
    return this._runtimeConfig;
  }
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > packages/common/constructs/src/core/static-website.ts 1`] = `
"import { CfnOutput, RemovalPolicy, Stack } from 'aws-cdk-lib';
import { Distribution, ViewerProtocolPolicy } from 'aws-cdk-lib/aws-cloudfront';
import { S3BucketOrigin } from 'aws-cdk-lib/aws-cloudfront-origins';
import {
  BlockPublicAccess,
  Bucket,
  BucketEncryption,
  IBucket,
  ObjectOwnership,
} from 'aws-cdk-lib/aws-s3';
import { BucketDeployment, Source } from 'aws-cdk-lib/aws-s3-deployment';
import { Construct } from 'constructs';
import { RuntimeConfig } from './runtime-config.js';
import { Key } from 'aws-cdk-lib/aws-kms';
import { CfnWebACL } from 'aws-cdk-lib/aws-wafv2';
const DEFAULT_RUNTIME_CONFIG_FILENAME = 'runtime-config.json';

export interface StaticWebsiteProps {
  readonly websiteName: string;
  readonly websiteFilePath: string;
}

/**
 * Deploys a Static Website using by default a private S3 bucket as an origin and Cloudfront as the entrypoint.
 *
 * This construct configures a webAcl containing rules that are generally applicable to web applications. This
 * provides protection against exploitation of a wide range of vulnerabilities, including some of the high risk
 * and commonly occurring vulnerabilities described in OWASP publications such as OWASP Top 10.
 *
 */
export class StaticWebsite extends Construct {
  public readonly websiteBucket: IBucket;
  public readonly cloudFrontDistribution: Distribution;
  public readonly bucketDeployment: BucketDeployment;

  constructor(
    scope: Construct,
    id: string,
    { websiteFilePath, websiteName }: StaticWebsiteProps,
  ) {
    super(scope, id);
    this.node.setContext(
      '@aws-cdk/aws-s3:serverAccessLogsUseBucketPolicy',
      true,
    );

    const websiteKey = new Key(this, 'WebsiteKey', {
      enableKeyRotation: true,
    });

    const accessLogsBucket = new Bucket(this, 'AccessLogsBucket', {
      versioned: false,
      enforceSSL: true,
      autoDeleteObjects: true,
      removalPolicy: RemovalPolicy.DESTROY,
      encryption: BucketEncryption.KMS,
      encryptionKey: websiteKey,
      objectOwnership: ObjectOwnership.OBJECT_WRITER,
      publicReadAccess: false,
      blockPublicAccess: BlockPublicAccess.BLOCK_ALL,
    });
    // S3 Bucket to hold website files
    this.websiteBucket = new Bucket(this, 'WebsiteBucket', {
      versioned: true,
      enforceSSL: true,
      autoDeleteObjects: true,
      removalPolicy: RemovalPolicy.DESTROY,
      encryption: BucketEncryption.KMS,
      encryptionKey: websiteKey,
      objectOwnership: ObjectOwnership.BUCKET_OWNER_ENFORCED,
      publicReadAccess: false,
      blockPublicAccess: BlockPublicAccess.BLOCK_ALL,
      serverAccessLogsPrefix: 'website-access-logs',
      serverAccessLogsBucket: accessLogsBucket,
    });
    // Web ACL
    const wafStack = new CloudfrontWebAcl(this, 'waf');

    // Cloudfront Distribution
    const logBucket = new Bucket(this, 'DistributionLogBucket', {
      enforceSSL: true,
      autoDeleteObjects: true,
      removalPolicy: RemovalPolicy.DESTROY,
      encryption: BucketEncryption.KMS,
      encryptionKey: websiteKey,
      objectOwnership: ObjectOwnership.BUCKET_OWNER_PREFERRED,
      publicReadAccess: false,
      blockPublicAccess: BlockPublicAccess.BLOCK_ALL,
      serverAccessLogsPrefix: 'distribution-access-logs',
      serverAccessLogsBucket: accessLogsBucket,
    });
    const defaultRootObject = 'index.html';
    this.cloudFrontDistribution = new Distribution(
      this,
      'CloudfrontDistribution',
      {
        webAclId: wafStack.wafArn,
        enableLogging: true,
        logBucket: logBucket,
        defaultBehavior: {
          origin: S3BucketOrigin.withOriginAccessControl(this.websiteBucket),
          viewerProtocolPolicy: ViewerProtocolPolicy.REDIRECT_TO_HTTPS,
        },
        defaultRootObject,
        errorResponses: [
          {
            httpStatus: 404, // We need to redirect "key not found errors" to index.html for single page apps
            responseHttpStatus: 200,
            responsePagePath: \`/\${defaultRootObject}\`,
          },
          {
            httpStatus: 403, // We need to redirect reloads from paths (e.g. /foo/bar) to index.html for single page apps
            responseHttpStatus: 200,
            responsePagePath: \`/\${defaultRootObject}\`,
          },
        ],
      },
    );
    // Deploy Website
    this.bucketDeployment = new BucketDeployment(this, 'WebsiteDeployment', {
      sources: [
        Source.asset(websiteFilePath),
        Source.jsonData(
          DEFAULT_RUNTIME_CONFIG_FILENAME,
          RuntimeConfig.ensure(this).config,
        ),
      ],
      destinationBucket: this.websiteBucket,
      // Files in the distribution's edge caches will be invalidated after files are uploaded to the destination bucket.
      distribution: this.cloudFrontDistribution,
      memoryLimit: 1024,
    });
    new CfnOutput(this, 'DistributionDomainName', {
      value: this.cloudFrontDistribution.domainName,
    });
    new CfnOutput(this, \`\${websiteName}WebsiteBucketName\`, {
      value: this.websiteBucket.bucketName,
    });
  }
}

export class CloudfrontWebAcl extends Stack {
  public readonly wafArn;
  constructor(scope: Construct, id: string) {
    super(scope, id, {
      env: {
        region: 'us-east-1',
        account: Stack.of(scope).account,
      },
      crossRegionReferences: true,
    });

    this.wafArn = new CfnWebACL(this, 'WebAcl', {
      defaultAction: { allow: {} },
      scope: 'CLOUDFRONT',
      visibilityConfig: {
        cloudWatchMetricsEnabled: true,
        metricName: id,
        sampledRequestsEnabled: true,
      },
      rules: [
        {
          name: 'CRSRule',
          priority: 0,
          statement: {
            managedRuleGroupStatement: {
              name: 'AWSManagedRulesCommonRuleSet',
              vendorName: 'AWS',
            },
          },
          visibilityConfig: {
            cloudWatchMetricsEnabled: true,
            metricName: 'MetricForWebACLCDK-CRS',
            sampledRequestsEnabled: true,
          },
          overrideAction: {
            none: {},
          },
        },
      ],
    }).attrArn;
  }
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > packages/common/constructs/src/index.ts 1`] = `
"export * from './app/index.js';
export * from './core/index.js';
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > packages/common/constructs/tsconfig.json 1`] = `
"{
  "extends": "../../../tsconfig.base.json",
  "files": [],
  "include": [],
  "references": [
    {
      "path": "./tsconfig.lib.json"
    },
    {
      "path": "./tsconfig.spec.json"
    }
  ],
  "compilerOptions": {}
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > packages/common/constructs/tsconfig.lib.json 1`] = `
"{
  "extends": "../../../tsconfig.base.json",
  "compilerOptions": {
    "rootDir": ".",
    "outDir": "../../../dist/packages/common/constructs/tsc",
    "tsBuildInfoFile": "../../../dist/packages/common/constructs/tsc/tsconfig.lib.tsbuildinfo",
    "emitDeclarationOnly": false,
    "module": "nodenext",
    "moduleResolution": "nodenext",
    "types": ["node"]
  },
  "include": ["src/**/*.ts"],
  "references": [],
  "exclude": [
    "vite.config.ts",
    "vite.config.mts",
    "vitest.config.ts",
    "vitest.config.mts",
    "src/**/*.test.ts",
    "src/**/*.spec.ts",
    "src/**/*.test.tsx",
    "src/**/*.spec.tsx",
    "src/**/*.test.js",
    "src/**/*.spec.js",
    "src/**/*.test.jsx",
    "src/**/*.spec.jsx"
  ]
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > packages/common/constructs/tsconfig.spec.json 1`] = `
"{
  "extends": "../../../tsconfig.base.json",
  "compilerOptions": {
    "outDir": "./out-tsc/vitest",
    "types": [
      "vitest/globals",
      "vitest/importMeta",
      "vite/client",
      "node",
      "vitest"
    ],
    "module": "nodenext",
    "moduleResolution": "nodenext"
  },
  "include": [
    "vite.config.ts",
    "vite.config.mts",
    "vitest.config.ts",
    "vitest.config.mts",
    "src/**/*.test.ts",
    "src/**/*.spec.ts",
    "src/**/*.test.tsx",
    "src/**/*.spec.tsx",
    "src/**/*.test.js",
    "src/**/*.spec.js",
    "src/**/*.test.jsx",
    "src/**/*.spec.jsx",
    "src/**/*.d.ts"
  ],
  "references": [
    {
      "path": "./tsconfig.lib.json"
    }
  ]
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > packages/common/constructs/vite.config.ts 1`] = `
"import { defineConfig } from 'vite';

export default defineConfig(() => ({
  root: __dirname,
  cacheDir: '../../../node_modules/.vite/packages/common/constructs',
  plugins: [],
  // Uncomment this if you are using workers.
  // worker: {
  //  plugins: [ nxViteTsPaths() ],
  // },
  test: {
    name: '@proj/common-constructs',
    watch: false,
    globals: true,
    environment: 'jsdom',
    include: ['src/**/*.{test,spec}.{js,mjs,cjs,ts,mts,cts,jsx,tsx}'],
    reporters: ['default'],
    coverage: {
      reportsDirectory: './test-output/vitest/coverage',
      provider: 'v8' as const,
    },
    passWithNoTests: true,
  },
}));
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > pnpm-workspace.yaml 1`] = `
"packages:
  - 'packages/*'
  - 'test-app'
  - 'packages/common/*'
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > test-app/README.md 1`] = `
"# @proj/test-app

This library was generated with [@aws/nx-plugin](https://github.com/awslabs/nx-plugin-for-aws/).

## Building

Run \`npx nx build @proj/test-app [--skip-nx-cache]\` to build the application.

## Run dev server

Run \`npx nx serve @proj/test-app\`

## Running unit tests

Run \`npx nx test @proj/test-app\` to execute the unit tests via Vitest.

### Updating snapshots

To update snapshots, run the following command:

\`npx nx test @proj/test-app --configuration=update-snapshot\`

## Run lint

Run \`npx nx lint @proj/test-app\`

### Fixable issues

You can also automatically fix some lint errors by running the following command:

\`npx nx lint @proj/test-app --configuration=fix\`

### Runtime config

In order to integrate with cognito or trpc backends, you need to have a \`runtime-config.json\` file in your \`/public\` website directory. You can fetch this is follows:

\`npx nx run @proj/test-app:load:runtime-config\`

> [!IMPORTANT]
> Ensure you have AWS CLI and curl installed
> You have deployed your CDK infrastructure into the appropriate account
> You have assumed a role in the AWS account with sufficient permissions to call describe-stacks from cloudformation

## Useful links

- [React website reference docs](TODO)
- [Learn more about NX](https://nx.dev/getting-started/intro)
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > test-app/eslint.config.mjs 1`] = `
"import nx from '@nx/eslint-plugin';
import baseConfig from '../eslint.config.mjs';

export default [
  ...baseConfig,
  ...nx.configs['flat/react'],
  {
    files: ['**/*.ts', '**/*.tsx', '**/*.js', '**/*.jsx'],
    // Override or add rules here
    rules: {},
  },
];
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > test-app/index.html 1`] = `
"<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>TestApp</title>
    <base href="/" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="stylesheet" href="/src/styles.css" />
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > test-app/project.json 1`] = `
"{
  "name": "@proj/test-app",
  "$schema": "../node_modules/nx/schemas/project-schema.json",
  "sourceRoot": "test-app/src",
  "projectType": "application",
  "tags": [],
  "targets": {
    "build": {
      "dependsOn": ["lint", "compile", "bundle", "test"],
      "options": {
        "outputPath": "dist/test-app/bundle"
      }
    },
    "bundle": {
      "executor": "@nx/vite:build",
      "outputs": ["{options.outputPath}"],
      "defaultConfiguration": "production",
      "options": {
        "outputPath": "dist/test-app/bundle"
      },
      "configurations": {
        "development": {
          "mode": "development"
        },
        "production": {
          "mode": "production"
        }
      }
    },
    "compile": {
      "executor": "nx:run-commands",
      "outputs": ["{workspaceRoot}/dist/{projectRoot}/tsc"],
      "options": {
        "command": "tsc --build tsconfig.app.json",
        "cwd": "{projectRoot}"
      }
    },
    "lint": {
      "executor": "@nx/eslint:lint"
    },
    "load:runtime-config": {
      "executor": "nx:run-commands",
      "metadata": {
        "description": "Load runtime config from your deployed stack for dev purposes. You must set your AWS CLI credentials whilst calling 'pnpm exec nx run @proj/test-app:load:runtime-config'"
      },
      "options": {
        "command": "aws s3 cp s3://\`aws cloudformation describe-stacks --query \\"Stacks[?starts_with(StackName, 'proj-')][].Outputs[] | [?contains(OutputKey, 'TestAppWebsiteBucketName')].OutputValue\\" --output text\`/runtime-config.json './test-app/public/runtime-config.json'"
      }
    },
    "preview": {
      "dependsOn": ["build"],
      "executor": "@nx/vite:preview-server",
      "defaultConfiguration": "development",
      "options": {
        "buildTarget": "@proj/test-app:build"
      },
      "configurations": {
        "development": {
          "buildTarget": "@proj/test-app:build:development"
        },
        "production": {
          "buildTarget": "@proj/test-app:build:production"
        }
      }
    },
    "serve": {
      "executor": "@nx/vite:dev-server",
      "defaultConfiguration": "development",
      "options": {
        "buildTarget": "@proj/test-app:build"
      },
      "configurations": {
        "development": {
          "buildTarget": "@proj/test-app:build:development",
          "hmr": true
        },
        "production": {
          "buildTarget": "@proj/test-app:build:production",
          "hmr": false
        }
      }
    },
    "serve-local": {
      "executor": "@nx/vite:dev-server",
      "options": {
        "buildTarget": "@proj/test-app:build:development",
        "hmr": true,
        "mode": "serve-local"
      },
      "continuous": true
    },
    "serve-static": {
      "executor": "@nx/web:file-server",
      "dependsOn": ["build"],
      "options": {
        "buildTarget": "@proj/test-app:build",
        "spa": true
      }
    },
    "test": {
      "executor": "@nx/vite:test",
      "outputs": ["{options.reportsDirectory}"],
      "options": {
        "reportsDirectory": "../coverage/test-app"
      }
    }
  },
  "metadata": {
    "generator": "ts#react-website"
  }
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > test-app/public/favicon.ico 1`] = `
"    00     ï¿½%  6          ï¿½  ï¿½%       h  ï¿½6  (   0   \`           $                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  V/ V/ cV/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Y1 '                                B# pH [ï¿½f ï¿½ï¿½i ï¿½ï¿½i ï¿½ï¿½i ï¿½ï¿½i ï¿½ï¿½i ï¿½ï¿½i aï¿½j             ï¿½c ï¿½^ Rï¿½\\ ï¿½ï¿½Y ï¿½ï¿½U ï¿½ï¿½R ï¿½|N ï¿½xK uI &                                    V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X1 ï¿½Y2 L                                d= 9_; ï¿½X ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½k H            ï¿½c 8ï¿½a ï¿½] ï¿½ï¿½Z ï¿½ï¿½W ï¿½ï¿½S ï¿½}P ï¿½zM ï¿½vI                                     V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Y1 ï¿½Z3 L                            oD jA ï¿½\`; ï¿½_= ï¿½ï¿½c ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k Ãk     ï¿½j ï¿½f ï¿½ï¿½c ï¿½ï¿½\` ï¿½ï¿½] ï¿½ï¿½Y ï¿½ï¿½V ï¿½ï¿½R ï¿½}O C                                        V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Z2 ï¿½[3 L                            oD [nD ï¿½iA ï¿½X7 ï¿½oI ï¿½ï¿½j ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½m ï¿½k sï¿½i ï¿½ï¿½f ï¿½ï¿½b ï¿½ï¿½_ ï¿½ï¿½[ ï¿½ï¿½W ï¿½ï¿½T ï¿½yL                                         V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X1 ï¿½Z3 ï¿½\\4 M                        nD oE ï¿½qF ï¿½oE ï¿½f@ ï¿½X8 ï¿½ï¿½Z ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½k sï¿½k ï¿½ï¿½k ï¿½ï¿½h ï¿½ï¿½d ï¿½ï¿½a ï¿½ï¿½] ï¿½ï¿½Y Ë…W                                             V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½Y1 ï¿½[3 ï¿½\\4 P                    h= nD ï¿½pE ï¿½rG ï¿½sH ï¿½oF ï¿½a= ï¿½cA ï¿½ï¿½f ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½j ï¿½ï¿½f ï¿½ï¿½b ï¿½ï¿½_ ï¿½\\ S                                                V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Y2 ï¿½[4 ï¿½]5 Q                    mC 6oD ï¿½qF ï¿½sH ï¿½uJ ï¿½uJ ï¿½nF ï¿½]; ï¿½wO ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½h ï¿½ï¿½d ï¿½ï¿½\` ï¿½ï¿½\\                                         V/ 
V/ V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Y2 ï¿½\\4 ï¿½]5 Q                kA 
mC ï¿½oD ï¿½qF ï¿½tH ï¿½vJ ï¿½xL ï¿½vK ï¿½kD ï¿½^= ï¿½ï¿½_ ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½i ï¿½ï¿½e Ø”b (                                        V/ 	V/ ï¿½V/ eV/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Z2 ï¿½\\4 ï¿½^6 Q                lA XmC ï¿½oE ï¿½rG ï¿½tI ï¿½wK ï¿½yM ï¿½zN ï¿½uK ï¿½eA ï¿½jF ï¿½ï¿½h ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½j ï¿½ï¿½g e                                            W0 V/ RV/ ï¿½V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Z2 ï¿½\\4 ï¿½^6 Q            j@ kA ï¿½mC ï¿½pE ï¿½rG ï¿½uI ï¿½wK ï¿½yM ï¿½|O ï¿½{O ï¿½rJ ï¿½^= ï¿½|S ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½j ï¿½ï¿½h                                         ï¿½Z]5 iY1 ï¿½V/ GV/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X0 ï¿½Z2 ï¿½\\5 ï¿½^6 Q            i? kA ï¿½mC ï¿½pE ï¿½rG ï¿½uI ï¿½wK ï¿½zM ï¿½|O ï¿½}P ï¿½xN ï¿½eB ï¿½W: ï¿½ï¿½c ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½oï¿½ï¿½ï¿½$W                                ï¿½ï¿½Hï¿½ï¿½Hï¿½ï¿½KHÉ¦9ï¿½f>ï¿½X1 ï¿½V/ ï¿½V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X0 ï¿½Z2 ï¿½\\4 ï¿½^6 Q        g> 4i? ï¿½kA ï¿½mC ï¿½pE ï¿½rG ï¿½uI ï¿½wK ï¿½zM ï¿½|O ï¿½|P ï¿½vM ï¿½b@ ï¿½bA ï¿½ï¿½g ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½s	ï¿½Óµ]ï¿½ï¿½ï¿½ï¿½                        ï¿½ï¿½H-ï¿½ï¿½Hï¿½ï¿½ï¿½Jï¿½ï¿½ï¿½Gï¿½ï¿½ï¿½*ï¿½\`8ï¿½Y1 ï¿½V/ ï¿½V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Z2 ï¿½\\4 ï¿½^6 Q    d; 	f= ï¿½h? ï¿½kA ï¿½mC ï¿½pE ï¿½rG ï¿½tI ï¿½wK ï¿½yM ï¿½{O ï¿½yN ï¿½mF ï¿½^> ï¿½ï¿½] ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½l ï¿½Í«Hï¿½ï¿½Ú”ï¿½ï¿½Ù›ï¿½Ø–ï¿½Ø–ï¿½Ø–.ï¿½Ø˜rï¿½Öï¿½ï¿½ï¿½Oï¿½ß¾Dï¿½ï¿½ï¿½/ï¿½ï¿½hï¿½i@ï¿½]5 ï¿½Y1 ï¿½V/ ï¿½V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Z2 ï¿½\\4 ï¿½^5 Q    d; Uf< ï¿½h> ï¿½j@ ï¿½mC ï¿½oE ï¿½rG ï¿½tH ï¿½wK ï¿½yL ï¿½xM ï¿½qI ï¿½_= ï¿½vO ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½j ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½iï¿½ï¿½×ï¿½ï¿½Ø—ï¿½ï¿½Ø˜ï¿½ï¿½Ø—ï¿½ï¿½Öï¿½ï¿½ï¿½kï¿½ï¿½ï¿½Gï¿½ï¿½wï¿½mCï¿½e; ï¿½a8 ï¿½]5 ï¿½X1 ï¿½V/ ]V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Y2 ï¿½\\4 ï¿½]5 Pb: c: ï¿½e< ï¿½h> ï¿½j@ ï¿½lB ï¿½oD ï¿½qF ï¿½rG DwK }wK ï¿½sI ï¿½d@ ï¿½cA ï¿½ï¿½f ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½iï¿½ï¿½ï¿½$ï¿½ï¿½ï¿½Wï¿½ï¿½ï¿½pï¿½ï¿½ï¿½vï¿½ï¿½ï¿½nï¿½ï¿½ï¿½Yï¿½ï¿½ï¿½Iï¿½ï¿½ï¿½*ï¿½rGï¿½j@ ï¿½f< ï¿½a8 ï¿½\\4 ï¿½X1 ï¿½V/  V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Y1 ï¿½[3 ï¿½\\5 Qa8 wb: ï¿½e< ï¿½g> ï¿½i@ ï¿½lB ï¿½nD ï¿½pE ï¿½oC uI }sH ï¿½iB ï¿½Z: ï¿½ï¿½Z ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½j ï¿½ï¿½f ï¿½ï¿½eï¿½ï¿½ï¿½ï¿½Î©4ï¿½Ü¹Aï¿½Ş¼Bï¿½×´=ï¿½ï¿½ï¿½(ï¿½}Rï¿½nC ï¿½j@ ï¿½e< ï¿½\`8 ï¿½[4 ï¿½X1 ï¿½    V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X1 ï¿½[3 ï¿½]5 ï¿½\`7 ï¿½b9 ï¿½d; ï¿½f= ï¿½i? ï¿½kA ï¿½mC ï¿½oD *    qG }kD ï¿½Z9 ï¿½oI ï¿½ï¿½j ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½k ï¿½ï¿½k ï¿½ï¿½i ï¿½ï¿½e ï¿½ï¿½a ï¿½ï¿½] ï¿½ï¿½_ï¿½ï¿½gï¿½ï¿½g
ï¿½ï¿½[ï¿½xKï¿½rF ï¿½nC ï¿½i? ï¿½d; ï¿½_7 ï¿½[3 ï¿½X1     V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X0 ï¿½Z2 ï¿½\\4 ï¿½_6 ï¿½a8 ï¿½c: ï¿½f< ï¿½h> ï¿½j@ ï¿½lB q        jB }_< ï¿½\\; ï¿½ï¿½c ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k Ûk Cï¿½k ï¿½ï¿½j ï¿½ï¿½g ï¿½ï¿½c ï¿½ï¿½\` ï¿½ï¿½\\ ï¿½ï¿½X ï¿½ï¿½S ï¿½}O ï¿½yL ï¿½uI ï¿½qE ï¿½lA ï¿½g> ï¿½c: ï¿½^6 ï¿½[3 J        V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Y2 ï¿½\\4 ï¿½^6 ï¿½\`8 ï¿½b: ï¿½e; ï¿½g= ï¿½i? ï¿½kA         \`; }U6 ï¿½U ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k l    ï¿½k $ï¿½h ï¿½ï¿½d ï¿½ï¿½a ï¿½ï¿½^ ï¿½ï¿½Z ï¿½ï¿½V ï¿½ï¿½S ï¿½}O ï¿½xK ï¿½tH ï¿½oD ï¿½j@ ï¿½f< ï¿½a9 ï¿½^6 ZS,         V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X1 ï¿½[3 ï¿½]5 ï¿½_7 ï¿½a9 ï¿½d; ï¿½f< ï¿½g> M            T4 ~kE ï¿½ï¿½i ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k         ï¿½e ï¿½b ï¿½ï¿½_ ï¿½[ ï¿½ï¿½X ï¿½ï¿½T ï¿½Q ï¿½zM ï¿½vJ ï¿½rF ï¿½mB ï¿½i? ï¿½e; ï¿½a8 BW0             V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Z2 ï¿½\\4 ï¿½^6 ï¿½\`8 ï¿½b: ï¿½d; ï¿½g=             iC ~ï¿½a ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½k :                ï¿½\` ï¿½] @ï¿½Y ï¿½ï¿½V Ú€R ï¿½|O ï¿½xK ï¿½tH ï¿½pD ï¿½lA ï¿½h> he;                     V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Y1 ï¿½[3 ï¿½]5 ï¿½_7 ï¿½a8 ï¿½c: .                xL ~Q ï¿½ï¿½R ï¿½ï¿½S ï¿½ï¿½T ï¿½ï¿½T ï¿½ï¿½U ï¿½ï¿½W ï¿½ï¿½o                         ï¿½W ï¿½T Q ={M TwJ YsG JoD +kA                             V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X0 ï¿½Z2 ï¿½\\4 ï¿½^6 ï¿½\`7 w                    kA }lB ï¿½nC ï¿½oD ï¿½pF ï¿½rG ï¿½sH ï¿½sH ï¿½                                                                                        V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W/ ï¿½X1 ï¿½Z3 ï¿½\\4 ï¿½^6                     j@ }kA ï¿½lB ï¿½nC ï¿½oD ï¿½pE ï¿½qF ï¿½rG ï¿½                                                                                        V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Y2 ï¿½[3 R                        h> }i? ï¿½j@ ï¿½lB ï¿½mC ï¿½nC ï¿½oD ï¿½pE ï¿½                                                                                        V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Z2                         f= }g= ï¿½h? ï¿½j@ ï¿½kA ï¿½lB ï¿½mB ï¿½mC ï¿½                                                                                        V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ 2                            d; }e< ï¿½f= ï¿½g> ï¿½i? ï¿½j@ ï¿½j@ ï¿½kA ï¿½                                                                                        V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ~                                b9 }c: ï¿½d; ï¿½e< ï¿½f= ï¿½g> ï¿½h> ï¿½i? ï¿½                                                                                        V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/                                 \`7 }a8 ï¿½b9 ï¿½c: ï¿½d; ï¿½e< ï¿½f< ï¿½f= ï¿½                                                                                        V/ V/ TV/ pV/ nV/ nV/ nV/ nV/ oV/ :                                    _6 6\`7 oa8 nb9 nc: nd; nd; pe; C                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½>ï¿½  ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ ï¿½  ï¿½ï¿½  ï¿½  ï¿½ï¿½  ï¿½  ï¿½ï¿½  ?ï¿½  ï¿½ï¿½  ï¿½  ï¿½ï¿½  ï¿½  ï¿½ï¿½  ï¿½ï¿½  ï¿½ï¿½  ï¿½  ï¿½ï¿½  >   ï¿½ï¿½     ï¿½ï¿½\`    ï¿½ï¿½\`    ï¿½ ï¿½    ï¿½ï¿½   ï¿½ï¿½   ï¿½ï¿½   ï¿½ï¿½?ï¿½  ï¿½ï¿½?ï¿½ï¿½  ï¿½ï¿½?ï¿½ï¿½  ï¿½ï¿½?ï¿½ï¿½  ï¿½ï¿½?ï¿½ï¿½  ï¿½ï¿½?ï¿½ï¿½  ï¿½?ï¿½?ï¿½ï¿½  ï¿½ï¿½?ï¿½ï¿½  ï¿½ï¿½?ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  (       @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             V/ V/ XV/ \\V/ \\V/ ]X1 /                    L, ~S Iï¿½i \`ï¿½i _ï¿½i _ï¿½i [ï¿½i         ï¿½_ ï¿½\\ Vï¿½X \\ï¿½S \\{N ^wJ ,                        V/ KV/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Y1 ï¿½                    d= BgA ï¿½b ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½s ï¿½c ï¿½ï¿½_ ï¿½ï¿½Z ï¿½ï¿½U ï¿½}P ï¿½xL 6                        V/ KV/ ï¿½V/ ï¿½V/ ï¿½X1 ï¿½Z3 ï¿½                pE mC ï¿½b= ï¿½pJ ï¿½ï¿½j ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½k Jï¿½k Aï¿½g ï¿½c ï¿½ï¿½] ï¿½ï¿½X ï¿½ï¿½T y                            V/ KV/ ï¿½V/ ï¿½V/ ï¿½Y1 ï¿½[3 ï¿½                oD fqF ï¿½nE ï¿½\`= ï¿½ï¿½Y ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k Ïk Ëj ï¿½ï¿½f ï¿½ï¿½\` ï¿½ï¿½[ ï¿½ï¿½V                             V/ KV/ ï¿½V/ ï¿½W/ ï¿½Z2 ï¿½\\4 ï¿½            mC #oD ï¿½rG ï¿½uI ï¿½lE ï¿½hD ï¿½ï¿½e ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½h ï¿½ï¿½c ï¿½^ F                        V/ V/ V/ KV/ ï¿½V/ ï¿½W0 ï¿½Z3 ï¿½]5 ï¿½        h> mC ï¿½pE ï¿½sH ï¿½wK ï¿½wL ï¿½hC ï¿½yP ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½i ï¿½ï¿½e ï¿½ï¿½[                         V/ *V/ zV/ KV/ ï¿½V/ ï¿½W0 ï¿½[3 ï¿½]5 ï¿½        kA @mB ï¿½pE ï¿½tI ï¿½xL ï¿½{N ï¿½wL ï¿½fC ï¿½ï¿½] ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½j Íšg                         ï¿½w 	]5\\W0 oV/ KV/ ï¿½V/ ï¿½W0 ï¿½[3 ï¿½]5 ï¿½    g> j@ ï¿½mB ï¿½qF ï¿½tI ï¿½xL ï¿½|O ï¿½|P ï¿½hC ï¿½mI ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½lï¿½ï¿½ï¿½ï¿½                ï¿½ï¿½Fï¿½ï¿½J ï¿½ï¿½NIÄ¢6ï¿½d<ï¿½V/ ï¿½V/ KV/ ï¿½V/ ï¿½W0 ï¿½[3 ï¿½]5 ï¿½    g= ci? ï¿½mB ï¿½pE ï¿½tH ï¿½xL ï¿½{N ï¿½wM ï¿½eB ï¿½ï¿½[ ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½j ï¿½ï¿½ï¿½3ï¿½ï¿½Ú‘Uï¿½İ©ï¿½Úœï¿½ÙœFï¿½ï¿½ukß¾DÒ½ï¿½1ï¿½ï¿½cï¿½]5 ï¿½W0 ï¿½V/ KV/ ï¿½V/ ï¿½W0 ï¿½Z3 ï¿½]5 ï¿½d; e< ï¿½i? ï¿½lB ï¿½pE ï¿½sH ï¿½wK ï¿½wL ï¿½hC ï¿½vN ï¿½ï¿½j ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½j ï¿½ï¿½zï¿½Ü¿^ï¿½ï¿½Öˆï¿½ï¿½×ï¿½ï¿½Ô‚ï¿½ï¿½ï¿½Zï¿½ï¿½ï¿½!ï¿½mCï¿½a8 ï¿½[4 ï¿½W0 ï¿½V/ KV/ ï¿½V/ ï¿½W/ ï¿½Z2 ï¿½\\4 ï¿½b9 ï¿½d; ï¿½h> ï¿½kA ï¿½oD ï¿½qF BuJ ï¿½mE ï¿½fB ï¿½ï¿½d ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½g ï¿½ï¿½{ï¿½Îª=ï¿½Ü½Mï¿½Ù¸Dï¿½ï¿½ï¿½'ï¿½uJï¿½h> ï¿½b9 ï¿½[3 ï¿½W0 6V/ KV/ ï¿½V/ ï¿½V/ ï¿½Y1 ï¿½\\4 ï¿½\`8 ï¿½c: ï¿½g= ï¿½j@ ï¿½mC ï¿½zK lD ï¿½_< ï¿½ï¿½W ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k Øj ï¿½ï¿½f ï¿½ï¿½_ ï¿½ï¿½_ï¿½ï¿½e
ï¿½ï¿½]	ï¿½wKï¿½nC ï¿½g= ï¿½\`7 ï¿½[3 L' V/ KV/ ï¿½V/ ï¿½V/ ï¿½X1 ï¿½[3 ï¿½_6 ï¿½b9 ï¿½e< ï¿½h? ï¿½kA %    \\9 ï¿½mG ï¿½ï¿½i ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k eï¿½k 9ï¿½g Õ”b ï¿½ï¿½] ï¿½ï¿½W ï¿½Q ï¿½yL ï¿½sG ï¿½lA ï¿½e< ï¿½\`7 ï¿½[3     V/ KV/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Z2 ï¿½]5 ï¿½a8 ï¿½d; ï¿½f= j       eA ï¿½ï¿½a ï¿½ï¿½l ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k     ï¿½d .ï¿½_ ï¿½ï¿½Z ï¿½U ï¿½}O ï¿½vJ ï¿½pE ï¿½j? ï¿½d; v_7         V/ KV/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X1 ï¿½\\4 ï¿½_7 ï¿½b9 ï¿½e;        |P ï¿½ï¿½Y ï¿½ï¿½Z ï¿½ï¿½[ ï¿½ï¿½\\ ï¿½a A            ï¿½\\ ï¿½W 7ï¿½R nzM ï¿½tH ï¿½nC \\i? !a9             V/ KV/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Z2 ï¿½]5 ï¿½_7 G        j? lA ï¿½mC ï¿½oD ï¿½qF ï¿½sG ï¿½sH +                                                        V/ KV/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X1 ï¿½[3 ï¿½\`7         b8 i? ï¿½j@ ï¿½mB ï¿½nD ï¿½pE ï¿½pE +                                                        V/ KV/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X1 )            _6 f= ï¿½g> ï¿½i@ ï¿½kA ï¿½lB ï¿½mC +                                                        V/ LV/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ q                ]4 c: ï¿½d; ï¿½f= ï¿½h> ï¿½i? ï¿½i? +                                                        V/ @V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/                 [2 \`8 ï¿½b9 ï¿½c: ï¿½e; ï¿½f< ï¿½f= $                                                        V/ V/ V/ V/ V/ V/                         _6 \`7 a9 c: d; d;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½0ï¿½ï¿½0ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½ ï¿½ï¿½   ï¿½ ï¿½ ï¿½00ï¿½p8ï¿½p?ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½(                                                                                                                                                                                                                                    V/ 'V/ ;W0 *Z3     ^: ï¿½] 2ï¿½k =ï¿½j %    ï¿½] #ï¿½V <{N (j?         V/ ï¿½V/ ï¿½X1 ï¿½\\4     h@ LvM ï¿½i ï¿½ï¿½k Êk Aï¿½c Æ‰Y ï¿½Q a            V/ ï¿½V/ ï¿½Z2 ï¿½[4 nC qF ï¿½lE ï¿½ï¿½Z ï¿½ï¿½l ï¿½ï¿½k ï¿½h ï¿½ï¿½\` ï¿½ï¿½V         V/ 	V/ ï¿½W0 ï¿½[3 ï¿½[4 mC rrG ï¿½wK ï¿½tL ï¿½ï¿½e ï¿½ï¿½k ï¿½ï¿½jï¿½d8        ï¿½ï¿½(
\\5VV/ ï¿½W0 ï¿½[3 ï¿½f= 1kA ï¿½rG ï¿½zM ï¿½qI ï¿½ï¿½^ ï¿½ï¿½k ï¿½ï¿½zï¿½ï¿½ï¿½z0ï¿½ï¿½#ï¿½ï¿½R^ï¿½}#ï¿½b:ï¿½V/ ï¿½W0 ï¿½Z3 ï¿½d; ï¿½j@ ï¿½qF ï¿½qH ï¿½zP ï¿½ï¿½j ï¿½ï¿½k ï¿½ï¿½rï¿½Æ¤Bï¿½Ú½]ã«†*ï¿½lCï¿½[3 ï¿½V/ ï¿½V/ ï¿½Z2 ï¿½a8 ï¿½g> ï¿½jA GlF Â“c ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½e ï¿½aï¿½ï¿½^ï¿½sHï¿½c: ï¿½[4 7V/ ï¿½V/ ï¿½X1 ï¿½^6 ï¿½c: ï¿½^: ï¿½T Å’a ï¿½ï¿½d ï¿½ï¿½n 
ï¿½\` @ï¿½V ï¿½xK ï¿½mB ï¿½d; -    V/ ï¿½V/ ï¿½V/ ï¿½Z2 ï¿½_6  mB 
mC ï¿½pE ï¿½sG ï¿½        yL tH lA         V/ ï¿½V/ ï¿½V/ ï¿½W/ d    c: e< ï¿½h? ï¿½j@ ï¿½                            V/ RV/ |V/ hV/     _7 a9 ^d; }f< A                                                                                                                                                            ï¿½ï¿½  ï¿½ï¿½  ï¿½ï¿½  ï¿½ï¿½  O              c      ï¿½ï¿½  ï¿½ï¿½  ï¿½ï¿½  "
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > test-app/src/app.tsx 1`] = `
"import AppLayout from './components/AppLayout';
import {
  ContentLayout,
  Header,
  SpaceBetween,
  Container,
} from '@cloudscape-design/components';

export const App = () => (
  <AppLayout>
    <ContentLayout header={<Header>Welcome</Header>}>
      <SpaceBetween size="l">
        <Container>Welcome to your new React website!</Container>
      </SpaceBetween>
    </ContentLayout>
  </AppLayout>
);
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > test-app/src/components/AppLayout/index.tsx 1`] = `
"import * as React from 'react';
import { createContext, useCallback, useState } from 'react';
import Config from '../../config';

import { TopNavigation } from '@cloudscape-design/components';
import CloudscapeAppLayout, {
  AppLayoutProps,
} from '@cloudscape-design/components/app-layout';

export interface AppLayoutContext {
  appLayoutProps: AppLayoutProps;
  setAppLayoutProps: (props: AppLayoutProps) => void;
  displayHelpPanel: (helpContent: React.ReactNode) => void;
}

/**
 * Context for updating/retrieving the AppLayout.
 */
export const AppLayoutContext = createContext({
  appLayoutProps: {},
  // eslint-disable-next-line @typescript-eslint/no-empty-function
  setAppLayoutProps: (_: AppLayoutProps) => {},
  // eslint-disable-next-line @typescript-eslint/no-empty-function
  displayHelpPanel: (_: React.ReactNode) => {},
});

/**
 * Defines the App layout and contains logic for routing.
 */
const AppLayout: React.FC<React.PropsWithChildren> = ({ children }) => {
  const appLayout = React.useRef<AppLayoutProps.Ref>(null);
  const [appLayoutProps, setAppLayoutProps] = useState<AppLayoutProps>({});
  const setAppLayoutPropsSafe = useCallback(
    (props: AppLayoutProps) => {
      JSON.stringify(appLayoutProps) !== JSON.stringify(props) &&
        setAppLayoutProps(props);
    },
    [appLayoutProps],
  );

  return (
    <AppLayoutContext.Provider
      value={{
        appLayoutProps,
        setAppLayoutProps: setAppLayoutPropsSafe,
        displayHelpPanel: (helpContent: React.ReactNode) => {
          setAppLayoutPropsSafe({ tools: helpContent, toolsHide: false });
          appLayout.current?.openTools();
        },
      }}
    >
      <TopNavigation
        identity={{
          href: '/',
          title: Config.applicationName,
          logo: {
            src: Config.logo,
          },
        }}
      />
      <CloudscapeAppLayout
        ref={appLayout}
        navigationHide
        toolsHide
        content={children}
        {...appLayoutProps}
      />
    </AppLayoutContext.Provider>
  );
};

export default AppLayout;
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > test-app/src/config.ts 1`] = `
"export default {
  applicationName: 'test-app',
  logo: 'data:image/svg+xml;base64,PCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KDTwhLS0gVXBsb2FkZWQgdG86IFNWRyBSZXBvLCB3d3cuc3ZncmVwby5jb20sIFRyYW5zZm9ybWVkIGJ5OiBTVkcgUmVwbyBNaXhlciBUb29scyAtLT4KPHN2ZyBmaWxsPSIjMjQ4YmFlIiB3aWR0aD0iODAwcHgiIGhlaWdodD0iODAwcHgiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0cm9rZT0iIzI0OGJhZSI+Cg08ZyBpZD0iU1ZHUmVwb19iZ0NhcnJpZXIiIHN0cm9rZS13aWR0aD0iMCIvPgoNPGcgaWQ9IlNWR1JlcG9fdHJhY2VyQ2FycmllciIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+Cg08ZyBpZD0iU1ZHUmVwb19pY29uQ2FycmllciI+Cg08dGl0bGU+aW9uaWNvbnMtdjVfbG9nb3M8L3RpdGxlPgoNPHBhdGggZD0iTTQxMC42NiwxODAuNzJoMHEtNy42Ny0yLjYyLTE1LjQ1LTQuODgsMS4yOS01LjI1LDIuMzgtMTAuNTZjMTEuNy01Ni45LDQuMDUtMTAyLjc0LTIyLjA2LTExNy44My0yNS0xNC40OC02NiwuNjEtMTA3LjM2LDM2LjY5cS02LjEsNS4zNC0xMS45NSwxMS0zLjktMy43Ni04LTcuMzZjLTQzLjM1LTM4LjU4LTg2LjgtNTQuODMtMTEyLjg4LTM5LjY5LTI1LDE0LjUxLTMyLjQzLDU3LjYtMjEuOSwxMTEuNTNxMS41OCw4LDMuNTUsMTUuOTNjLTYuMTUsMS43NS0xMi4wOSwzLjYyLTE3Ljc3LDUuNkM0OC40NiwxOTguOSwxNiwyMjYuNzMsMTYsMjU1LjU5YzAsMjkuODIsMzQuODQsNTkuNzIsODcuNzcsNzcuODVxNi40NCwyLjE5LDEzLDQuMDdRMTE0LjY0LDM0NiwxMTMsMzU0LjY4Yy0xMCw1My0yLjIsOTUuMDcsMjIuNzUsMTA5LjQ5LDI1Ljc3LDE0Ljg5LDY5LS40MSwxMTEuMTQtMzcuMzFxNS00LjM4LDEwLTkuMjUsNi4zMiw2LjExLDEzLDExLjg2YzQwLjgsMzUuMTgsODEuMDksNDkuMzksMTA2LDM0LjkzLDI1Ljc1LTE0Ljk0LDM0LjEyLTYwLjE0LDIzLjI1LTExNS4xM3EtMS4yNS02LjMtMi44OC0xMi44Niw0LjU2LTEuMzUsOC45My0yLjc5YzU1LTE4LjI3LDkwLjgzLTQ3LjgxLDkwLjgzLTc4QzQ5NiwyMjYuNjIsNDYyLjUsMTk4LjYxLDQxMC42NiwxODAuNzJabS0xMjktODEuMDhjMzUuNDMtMzAuOTEsNjguNTUtNDMuMTEsODMuNjUtMzQuMzloMGMxNi4wNyw5LjI5LDIyLjMyLDQ2Ljc1LDEyLjIyLDk1Ljg4cS0xLDQuOC0yLjE2LDkuNTdhNDg3LjgzLDQ4Ny44MywwLDAsMC02NC4xOC0xMC4xNiw0ODEuMjcsNDgxLjI3LDAsMCwwLTQwLjU3LTUwLjc1UTI3NiwxMDQuNTcsMjgxLjY0LDk5LjY0Wk0xNTcuNzMsMjgwLjI1cTYuNTEsMTIuNiwxMy42MSwyNC44OSw3LjIzLDEyLjU0LDE1LjA3LDI0LjcxYTQzNS4yOCw0MzUuMjgsMCwwLDEtNDQuMjQtNy4xM0MxNDYuNDEsMzA5LDE1MS42MywyOTQuNzUsMTU3LjczLDI4MC4yNVptMC00OC4zM2MtNi0xNC4xOS0xMS4wOC0yOC4xNS0xNS4yNS00MS42MywxMy43LTMuMDcsMjguMy01LjU4LDQzLjUyLTcuNDhxLTcuNjUsMTEuOTQtMTQuNzIsMjQuMjNUMTU3LjcsMjMxLjkyWm0xMC45LDI0LjE3cTkuNDgtMTkuNzcsMjAuNDItMzguNzhoMHExMC45My0xOSwyMy4yNy0zNy4xM2MxNC4yOC0xLjA4LDI4LjkyLTEuNjUsNDMuNzEtMS42NXMyOS41Mi41Nyw0My43OSwxLjY2cTEyLjIxLDE4LjA5LDIzLjEzLDM3dDIwLjY5LDM4LjZRMzM0LDI3NS42MywzMjMsMjk0LjczaDBxLTEwLjkxLDE5LTIzLDM3LjI0Yy0xNC4yNSwxLTI5LDEuNTUtNDQsMS41NXMtMjkuNDctLjQ3LTQzLjQ2LTEuMzhxLTEyLjQzLTE4LjE5LTIzLjQ2LTM3LjI5VDE2OC42LDI1Ni4wOVpNMzQwLjc1LDMwNXE3LjI1LTEyLjU4LDEzLjkyLTI1LjQ5aDBhNDQwLjQxLDQ0MC40MSwwLDAsMSwxNi4xMiw0Mi4zMkE0MzQuNDQsNDM0LjQ0LDAsMCwxLDMyNiwzMjkuNDhRMzMzLjYyLDMxNy4zOSwzNDAuNzUsMzA1Wm0xMy43Mi03My4wN3EtNi42NC0xMi42NS0xMy44MS0yNWgwcS03LTEyLjE4LTE0LjU5LTI0LjA2YzE1LjMxLDEuOTQsMzAsNC41Miw0My43Nyw3LjY3QTQzOS44OSw0MzkuODksMCwwLDEsMzU0LjQ3LDIzMS45M1pNMjU2LjIzLDEyNC40OGgwYTQzOS43NSw0MzkuNzUsMCwwLDEsMjguMjUsMzQuMThxLTI4LjM1LTEuMzUtNTYuNzQsMEMyMzcuMDcsMTQ2LjMyLDI0Ni42MiwxMzQuODcsMjU2LjIzLDEyNC40OFpNMTQ1LjY2LDY1Ljg2YzE2LjA2LTkuMzIsNTEuNTcsNCw4OSwzNy4yNywyLjM5LDIuMTMsNC44LDQuMzYsNy4yLDYuNjdBNDkxLjM3LDQ5MS4zNywwLDAsMCwyMDEsMTYwLjUxYTQ5OS4xMiw0OTkuMTIsMCwwLDAtNjQuMDYsMTBxLTEuODMtNy4zNi0zLjMtMTQuODJoMEMxMjQuNTksMTA5LjQ2LDEzMC41OCw3NC42MSwxNDUuNjYsNjUuODZaTTEyMi4yNSwzMTcuNzFxLTYtMS43MS0xMS44NS0zLjcxYy0yMy40LTgtNDIuNzMtMTguNDQtNTYtMjkuODFDNDIuNTIsMjc0LDM2LjUsMjYzLjgzLDM2LjUsMjU1LjU5YzAtMTcuNTEsMjYuMDYtMzkuODUsNjkuNTItNTVxOC4xOS0yLjg1LDE2LjUyLTUuMjFhNDkzLjU0LDQ5My41NCwwLDAsMCwyMy40LDYwLjc1QTUwMi40Niw1MDIuNDYsMCwwLDAsMTIyLjI1LDMxNy43MVptMTExLjEzLDkzLjY3Yy0xOC42MywxNi4zMi0zNy4yOSwyNy44OS01My43NCwzMy43MmgwYy0xNC43OCw1LjIzLTI2LjU1LDUuMzgtMzMuNjYsMS4yNy0xNS4xNC04Ljc1LTIxLjQ0LTQyLjU0LTEyLjg1LTg3Ljg2cTEuNTMtOCwzLjUtMTZhNDgwLjg1LDQ4MC44NSwwLDAsMCw2NC42OSw5LjM5LDUwMS4yLDUwMS4yLDAsMCwwLDQxLjIsNTFDMjM5LjU0LDQwNS44MywyMzYuNDksNDA4LjY1LDIzMy4zOCw0MTEuMzhabTIzLjQyLTIzLjIyYy05LjcyLTEwLjUxLTE5LjQyLTIyLjE0LTI4Ljg4LTM0LjY0cTEzLjc5LjU0LDI4LjA4LjU0YzkuNzgsMCwxOS40Ni0uMjEsMjktLjY0QTQzOS4zMyw0MzkuMzMsMCwwLDEsMjU2LjgsMzg4LjE2Wm0xMjQuNTIsMjguNTljLTIuODYsMTUuNDQtOC42MSwyNS43NC0xNS43MiwyOS44Ni0xNS4xMyw4Ljc4LTQ3LjQ4LTIuNjMtODIuMzYtMzIuNzItNC0zLjQ0LTgtNy4xMy0xMi4wNy0xMWE0ODQuNTQsNDg0LjU0LDAsMCwwLDQwLjIzLTUxLjIsNDc3Ljg0LDQ3Ny44NCwwLDAsMCw2NS0xMC4wNXExLjQ3LDUuOTQsMi42LDExLjY0aDBDMzgzLjgxLDM3Ny41OCwzODQuNSwzOTkuNTYsMzgxLjMyLDQxNi43NVptMTcuNC0xMDIuNjRoMGMtMi42Mi44Ny01LjMyLDEuNzEtOC4wNiwyLjUzYTQ4My4yNiw0ODMuMjYsMCwwLDAtMjQuMzEtNjAuOTQsNDgxLjUyLDQ4MS41MiwwLDAsMCwyMy4zNi02MC4wNmM0LjkxLDEuNDMsOS42OCwyLjkzLDE0LjI3LDQuNTIsNDQuNDIsMTUuMzIsNzEuNTIsMzgsNzEuNTIsNTUuNDNDNDc1LjUsMjc0LjE5LDQ0Ni4yMywyOTguMzMsMzk4LjcyLDMxNC4xMVoiLz4KDTxwYXRoIGQ9Ik0yNTYsMjk4LjU1YTQzLDQzLDAsMSwwLTQyLjg2LTQzQTQyLjkxLDQyLjkxLDAsMCwwLDI1NiwyOTguNTVaIi8+Cg08L2c+Cg08L3N2Zz4=',
};
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > test-app/src/hooks/useAppLayout.tsx 1`] = `
"import { useContext } from 'react';
import { AppLayoutContext } from '../components/AppLayout';

export const useAppLayout = (): AppLayoutContext =>
  useContext(AppLayoutContext);
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > test-app/src/main.tsx 1`] = `
"import React from 'react';
import { createRoot } from 'react-dom/client';
import { I18nProvider } from '@cloudscape-design/components/i18n';
import messages from '@cloudscape-design/components/i18n/messages/all.en';
import '@cloudscape-design/global-styles/index.css';
import { App } from './app';

const root = document.getElementById('root');
root &&
  createRoot(root).render(
    <React.StrictMode>
      <I18nProvider locale="en" messages={[messages]}>
        <App />
      </I18nProvider>
    </React.StrictMode>,
  );
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > test-app/src/styles.css 1`] = `
"@import 'tailwindcss';
/* You can add global styles to this file, and also import other style files */
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > test-app/tsconfig.app.json 1`] = `
"{
  "extends": "../tsconfig.base.json",
  "compilerOptions": {
    "outDir": "../dist/test-app/tsc",
    "tsBuildInfoFile": "../dist/test-app/tsc/tsconfig.lib.tsbuildinfo",
    "jsx": "react-jsx",
    "lib": ["DOM"],
    "types": [
      "node",
      "@nx/react/typings/cssmodule.d.ts",
      "@nx/react/typings/image.d.ts",
      "vite/client"
    ]
  },
  "exclude": [
    "src/**/*.spec.ts",
    "src/**/*.test.ts",
    "src/**/*.spec.tsx",
    "src/**/*.test.tsx",
    "src/**/*.spec.js",
    "src/**/*.test.js",
    "src/**/*.spec.jsx",
    "src/**/*.test.jsx",
    "vite.config.ts",
    "vite.config.mts",
    "vitest.config.ts",
    "vitest.config.mts"
  ],
  "include": ["src/**/*.js", "src/**/*.jsx", "src/**/*.ts", "src/**/*.tsx"]
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > test-app/tsconfig.json 1`] = `
"{
  "files": [],
  "include": [],
  "references": [
    {
      "path": "./tsconfig.app.json"
    },
    {
      "path": "./tsconfig.spec.json"
    }
  ],
  "extends": "../tsconfig.base.json",
  "compilerOptions": {
    "moduleResolution": "Bundler",
    "module": "Preserve"
  }
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > test-app/tsconfig.spec.json 1`] = `
"{
  "extends": "../tsconfig.base.json",
  "compilerOptions": {
    "outDir": "./out-tsc/vitest",
    "types": [
      "vitest/globals",
      "vitest/importMeta",
      "vite/client",
      "node",
      "vitest",
      "@nx/react/typings/cssmodule.d.ts",
      "@nx/react/typings/image.d.ts"
    ]
  },
  "include": [
    "vite.config.ts",
    "vite.config.mts",
    "vitest.config.ts",
    "vitest.config.mts",
    "src/**/*.test.ts",
    "src/**/*.spec.ts",
    "src/**/*.test.tsx",
    "src/**/*.spec.tsx",
    "src/**/*.test.js",
    "src/**/*.spec.js",
    "src/**/*.test.jsx",
    "src/**/*.spec.jsx",
    "src/**/*.d.ts"
  ],
  "references": [
    {
      "path": "./tsconfig.app.json"
    }
  ]
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > test-app/vite.config.ts 1`] = `
"import tailwindcss from '@tailwindcss/vite';
import tsconfigPaths from 'vite-tsconfig-paths';
/// <reference types='vitest' />
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig(() => ({
  define: {
    global: {},
  },
  root: __dirname,
  cacheDir: '../node_modules/.vite/test-app',
  server: {
    port: 4200,
    host: 'localhost',
  },
  preview: {
    port: 4300,
    host: 'localhost',
  },
  plugins: [react(), tailwindcss(), tsconfigPaths()],
  build: {
    outDir: '../dist/test-app',
    emptyOutDir: true,
    reportCompressedSize: true,
    commonjsOptions: {
      transformMixedEsModules: true,
    },
  },
  test: {
    name: '@proj/test-app',
    watch: false,
    globals: true,
    environment: 'jsdom',
    include: ['{src,tests}/**/*.{test,spec}.{js,mjs,cjs,ts,mts,cts,jsx,tsx}'],
    reporters: ['default'],
    coverage: {
      reportsDirectory: './test-output/vitest/coverage',
      provider: 'v8' as const,
    },
    passWithNoTests: true,
  },
}));
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > tsconfig.base.json 1`] = `
"{
  "compilerOptions": {
    "paths": {
      ":proj/test-app": ["test-app/src/index.ts"],
      ":proj/common-constructs": ["packages/common/constructs/src/index.ts"]
    },
    "baseUrl": ".",
    "rootDir": "."
  }
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > tsconfig.json 1`] = `
"{
  "references": [
    {
      "path": "./test-app"
    },
    {
      "path": "./packages/common/constructs"
    }
  ]
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with no router correctly > vitest.workspace.ts 1`] = `
"export default [
  '**/vite.config.{mjs,js,ts,mts}',
  '**/vitest.config.{mjs,js,ts,mts}',
];
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > .gitignore 1`] = `
"vite.config.*.timestamp*
vitest.config.*.timestamp*

runtime-config.json"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > .prettierrc 1`] = `
"{ "singleQuote": true }
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > eslint.config.mjs 1`] = `
"import eslintPluginPrettierRecommended from 'eslint-plugin-prettier/recommended';
import nx from '@nx/eslint-plugin';

export default [
  eslintPluginPrettierRecommended,
  ...nx.configs['flat/base'],
  ...nx.configs['flat/typescript'],
  ...nx.configs['flat/javascript'],
  {
    ignores: [
      '**/dist',
      '**/vite.config.*.timestamp*',
      '**/vitest.config.*.timestamp*',
      '**/vite.config.ts.timestamp*',
    ],
  },
  {
    files: ['**/*.ts', '**/*.tsx', '**/*.js', '**/*.jsx'],
    rules: {
      '@nx/enforce-module-boundaries': [
        'error',
        {
          enforceBuildableLibDependency: true,
          allow: ['^.*/eslint(\\\\.base)?\\\\.config\\\\.[cm]?[jt]s$'],
          depConstraints: [
            {
              sourceTag: '*',
              onlyDependOnLibsWithTags: ['*'],
            },
          ],
        },
      ],
    },
  },
  {
    files: [
      '**/*.ts',
      '**/*.tsx',
      '**/*.cts',
      '**/*.mts',
      '**/*.js',
      '**/*.jsx',
      '**/*.cjs',
      '**/*.mjs',
    ],
    rules: {},
  },
];
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > nx.json 1`] = `
"{
  "affected": {
    "defaultBase": "main"
  },
  "targetDefaults": {
    "build": {
      "cache": true,
      "dependsOn": ["^build"],
      "inputs": ["default"]
    },
    "lint": {
      "cache": true,
      "configurations": {
        "fix": {
          "fix": true
        }
      },
      "inputs": [
        "default",
        "{workspaceRoot}/eslint.config.mjs",
        "{projectRoot}/eslint.config.mjs"
      ]
    },
    "@nx/eslint:lint": {
      "cache": true,
      "inputs": [
        "default",
        "{workspaceRoot}/.eslintrc.json",
        "{workspaceRoot}/.eslintignore",
        "{workspaceRoot}/eslint.config.mjs"
      ]
    },
    "@nx/vite:test": {
      "cache": true,
      "inputs": ["default", "^default"],
      "configurations": {
        "update-snapshot": {
          "args": "--update"
        }
      }
    },
    "@nx/vite:build": {
      "cache": true,
      "dependsOn": ["^build"],
      "inputs": ["default", "^default"]
    },
    "test": {
      "dependsOn": ["^build"],
      "inputs": ["default"]
    },
    "compile": {
      "cache": true,
      "inputs": ["default"]
    }
  },
  "generators": {
    "@nx/react": {
      "application": {
        "babel": true,
        "style": "css",
        "linter": "eslint",
        "bundler": "vite"
      },
      "component": {
        "style": "css"
      },
      "library": {
        "style": "css",
        "linter": "eslint"
      }
    }
  },
  "plugins": [
    {
      "plugin": "@nx/js/typescript",
      "options": {
        "typecheck": {
          "targetName": "typecheck"
        },
        "build": {
          "targetName": "compile",
          "configName": "tsconfig.lib.json",
          "buildDepsName": "build-deps",
          "watchDepsName": "watch-deps"
        }
      }
    },
    {
      "plugin": "@nx/eslint/plugin",
      "options": {
        "targetName": "lint"
      }
    }
  ],
  "namedInputs": {
    "default": [
      {
        "dependentTasksOutputFiles": "**/*",
        "transitive": true
      }
    ]
  }
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > package.json 1`] = `
"{
  "name": "@proj/source",
  "dependencies": {
    "@cloudscape-design/board-components": "3.0.117",
    "@cloudscape-design/components": "3.0.1075",
    "@cloudscape-design/global-styles": "1.0.45",
    "@tanstack/react-router": "1.131.28",
    "aws-cdk-lib": "2.213.0",
    "constructs": "10.4.2",
    "react": "19.0.0",
    "react-dom": "19.0.0",
    "tailwindcss": "4.1.12"
  },
  "devDependencies": {
    "@eslint/js": "^9.8.0",
    "@nx/eslint": "21.4.1",
    "@nx/eslint-plugin": "21.4.1",
    "@nx/js": "21.4.1",
    "@nx/react": "21.4.1",
    "@nx/vite": "21.4.1",
    "@nx/web": "21.4.1",
    "@swc-node/register": "~1.9.1",
    "@swc/cli": "~0.6.0",
    "@swc/core": "~1.5.7",
    "@swc/helpers": "~0.5.11",
    "@tailwindcss/vite": "4.1.12",
    "@tanstack/router-generator": "1.131.28",
    "@tanstack/router-plugin": "1.131.28",
    "@tanstack/router-utils": "1.131.2",
    "@tanstack/virtual-file-routes": "1.131.2",
    "@testing-library/dom": "10.4.0",
    "@testing-library/react": "16.1.0",
    "@types/node": "22.18.0",
    "@types/react": "19.0.0",
    "@types/react-dom": "19.0.0",
    "@vitejs/plugin-react": "^4.2.0",
    "@vitest/coverage-v8": "^3.0.5",
    "@vitest/ui": "^3.0.0",
    "eslint": "^9.8.0",
    "eslint-config-prettier": "^10.0.0",
    "eslint-plugin-import": "2.31.0",
    "eslint-plugin-jsx-a11y": "6.10.1",
    "eslint-plugin-prettier": "5.5.4",
    "eslint-plugin-react": "7.35.0",
    "eslint-plugin-react-hooks": "5.0.0",
    "jiti": "2.4.2",
    "jsdom": "~22.1.0",
    "jsonc-eslint-parser": "2.4.0",
    "prettier": "3.6.2",
    "typescript": "~5.8.2",
    "typescript-eslint": "^8.29.0",
    "vite": "^6.0.0",
    "vite-tsconfig-paths": "5.1.4",
    "vitest": "^3.0.0"
  },
  "type": "module"
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > packages/common/constructs/README.md 1`] = `
"# @proj/common-constructs

This library was generated with [@aws/nx-plugin](https://github.com/awslabs/nx-plugin-for-aws/).

## Building

Run \`npx nx build @proj/common-constructs [--skip-nx-cache]\` to build the application.

## Running unit tests

Run \`npx nx test @proj/common-constructs\` to execute the unit tests via Vitest.

### Updating snapshots

To update snapshots, run the following command:

\`npx nx test @proj/common-constructs --configuration=update-snapshot\`

## Run lint

Run \`npx nx lint @proj/common-constructs\`

### Fixable issues

You can also automatiaclly fix some lint errors by running the following command:

\`npx nx lint @proj/common-constructs --configuration=fix\`

## Useful links

- [common-constructs reference docs](TODO)
- [Learn more about NX](https://nx.dev/getting-started/intro)
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > packages/common/constructs/eslint.config.mjs 1`] = `
"import baseConfig from '../../../eslint.config.mjs';

export default [
  ...baseConfig,
  {
    files: ['**/*.json'],
    rules: {
      '@nx/dependency-checks': [
        'warn',
        {
          ignoredFiles: [
            '{projectRoot}/eslint.config.{js,cjs,mjs,ts,cts,mts}',
            '{projectRoot}/vite.config.{js,ts,mjs,mts}',
          ],
        },
      ],
    },
    languageOptions: {
      parser: await import('jsonc-eslint-parser'),
    },
  },
];
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > packages/common/constructs/project.json 1`] = `
"{
  "name": "@proj/common-constructs",
  "$schema": "../../../node_modules/nx/schemas/project-schema.json",
  "sourceRoot": "packages/common/constructs/src",
  "projectType": "library",
  "tags": [],
  "targets": {
    "build": {
      "dependsOn": ["lint", "compile", "test", "@proj/test-app:build"]
    },
    "compile": {
      "executor": "nx:run-commands",
      "outputs": ["{workspaceRoot}/dist/packages/common/constructs/tsc"],
      "options": {
        "command": "tsc --build tsconfig.lib.json",
        "cwd": "{projectRoot}"
      }
    },
    "test": {
      "executor": "@nx/vite:test",
      "outputs": ["{options.reportsDirectory}"],
      "options": {
        "reportsDirectory": "../../../coverage/packages/common/constructs"
      }
    }
  },
  "metadata": {
    "generator": "ts#project"
  }
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > packages/common/constructs/src/app/index.ts 1`] = `
"export * from './static-websites/index.js';
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > packages/common/constructs/src/app/static-websites/index.ts 1`] = `
"export * from './test-app.js';
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > packages/common/constructs/src/app/static-websites/test-app.ts 1`] = `
"import * as url from 'url';
import { Construct } from 'constructs';
import { StaticWebsite } from '../../core/index.js';

export class TestApp extends StaticWebsite {
  constructor(scope: Construct, id: string) {
    super(scope, id, {
      websiteName: 'TestApp',
      websiteFilePath: url.fileURLToPath(
        new URL('../../../../../../dist/test-app/bundle', import.meta.url),
      ),
    });
  }
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > packages/common/constructs/src/core/app.ts 1`] = `
"import { App as _App, AppProps, Aspects, IAspect, Stack } from 'aws-cdk-lib';
import { IConstruct } from 'constructs';

export class App extends _App {
  constructor(props?: AppProps) {
    super(props);

    Aspects.of(this).add(new MetricsAspect());
  }
}

/**
 * Adds information to CloudFormation stack descriptions to provide usage metrics for @aws/nx-plugin
 */
class MetricsAspect implements IAspect {
  visit(node: IConstruct): void {
    if (node instanceof Stack) {
      const id = 'uksb-4wk0bqpg5s';
      const version = '0.0.0';
      const tags: string[] = ['g5'];
      node.templateOptions.description =
        \`\${node.templateOptions.description ?? ''} (\${id}) (version:\${version}) (tag:\${tags.join(',')})\`.trim();
    }
  }
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > packages/common/constructs/src/core/index.ts 1`] = `
"export * from './static-website.js';
export * from './app.js';
export * from './runtime-config.js';
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > packages/common/constructs/src/core/runtime-config.ts 1`] = `
"import { Stack, Stage } from 'aws-cdk-lib';
import { Construct } from 'constructs';

const RuntimeConfigKey = '__RuntimeConfig__';

export class RuntimeConfig extends Construct {
  private readonly _runtimeConfig: any = {};

  static ensure(scope: Construct): RuntimeConfig {
    const parent = Stage.of(scope) ?? Stack.of(scope);
    return (
      RuntimeConfig.of(scope) ?? new RuntimeConfig(parent, RuntimeConfigKey)
    );
  }

  static of(scope: Construct): RuntimeConfig | undefined {
    const parent = Stage.of(scope) ?? Stack.of(scope);
    return parent.node.tryFindChild(RuntimeConfigKey) as
      | RuntimeConfig
      | undefined;
  }

  constructor(scope: Construct, id: string) {
    super(scope, id);
  }

  get config(): any {
    return this._runtimeConfig;
  }
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > packages/common/constructs/src/core/static-website.ts 1`] = `
"import { CfnOutput, RemovalPolicy, Stack } from 'aws-cdk-lib';
import { Distribution, ViewerProtocolPolicy } from 'aws-cdk-lib/aws-cloudfront';
import { S3BucketOrigin } from 'aws-cdk-lib/aws-cloudfront-origins';
import {
  BlockPublicAccess,
  Bucket,
  BucketEncryption,
  IBucket,
  ObjectOwnership,
} from 'aws-cdk-lib/aws-s3';
import { BucketDeployment, Source } from 'aws-cdk-lib/aws-s3-deployment';
import { Construct } from 'constructs';
import { RuntimeConfig } from './runtime-config.js';
import { Key } from 'aws-cdk-lib/aws-kms';
import { CfnWebACL } from 'aws-cdk-lib/aws-wafv2';
const DEFAULT_RUNTIME_CONFIG_FILENAME = 'runtime-config.json';

export interface StaticWebsiteProps {
  readonly websiteName: string;
  readonly websiteFilePath: string;
}

/**
 * Deploys a Static Website using by default a private S3 bucket as an origin and Cloudfront as the entrypoint.
 *
 * This construct configures a webAcl containing rules that are generally applicable to web applications. This
 * provides protection against exploitation of a wide range of vulnerabilities, including some of the high risk
 * and commonly occurring vulnerabilities described in OWASP publications such as OWASP Top 10.
 *
 */
export class StaticWebsite extends Construct {
  public readonly websiteBucket: IBucket;
  public readonly cloudFrontDistribution: Distribution;
  public readonly bucketDeployment: BucketDeployment;

  constructor(
    scope: Construct,
    id: string,
    { websiteFilePath, websiteName }: StaticWebsiteProps,
  ) {
    super(scope, id);
    this.node.setContext(
      '@aws-cdk/aws-s3:serverAccessLogsUseBucketPolicy',
      true,
    );

    const websiteKey = new Key(this, 'WebsiteKey', {
      enableKeyRotation: true,
    });

    const accessLogsBucket = new Bucket(this, 'AccessLogsBucket', {
      versioned: false,
      enforceSSL: true,
      autoDeleteObjects: true,
      removalPolicy: RemovalPolicy.DESTROY,
      encryption: BucketEncryption.KMS,
      encryptionKey: websiteKey,
      objectOwnership: ObjectOwnership.OBJECT_WRITER,
      publicReadAccess: false,
      blockPublicAccess: BlockPublicAccess.BLOCK_ALL,
    });
    // S3 Bucket to hold website files
    this.websiteBucket = new Bucket(this, 'WebsiteBucket', {
      versioned: true,
      enforceSSL: true,
      autoDeleteObjects: true,
      removalPolicy: RemovalPolicy.DESTROY,
      encryption: BucketEncryption.KMS,
      encryptionKey: websiteKey,
      objectOwnership: ObjectOwnership.BUCKET_OWNER_ENFORCED,
      publicReadAccess: false,
      blockPublicAccess: BlockPublicAccess.BLOCK_ALL,
      serverAccessLogsPrefix: 'website-access-logs',
      serverAccessLogsBucket: accessLogsBucket,
    });
    // Web ACL
    const wafStack = new CloudfrontWebAcl(this, 'waf');

    // Cloudfront Distribution
    const logBucket = new Bucket(this, 'DistributionLogBucket', {
      enforceSSL: true,
      autoDeleteObjects: true,
      removalPolicy: RemovalPolicy.DESTROY,
      encryption: BucketEncryption.KMS,
      encryptionKey: websiteKey,
      objectOwnership: ObjectOwnership.BUCKET_OWNER_PREFERRED,
      publicReadAccess: false,
      blockPublicAccess: BlockPublicAccess.BLOCK_ALL,
      serverAccessLogsPrefix: 'distribution-access-logs',
      serverAccessLogsBucket: accessLogsBucket,
    });
    const defaultRootObject = 'index.html';
    this.cloudFrontDistribution = new Distribution(
      this,
      'CloudfrontDistribution',
      {
        webAclId: wafStack.wafArn,
        enableLogging: true,
        logBucket: logBucket,
        defaultBehavior: {
          origin: S3BucketOrigin.withOriginAccessControl(this.websiteBucket),
          viewerProtocolPolicy: ViewerProtocolPolicy.REDIRECT_TO_HTTPS,
        },
        defaultRootObject,
        errorResponses: [
          {
            httpStatus: 404, // We need to redirect "key not found errors" to index.html for single page apps
            responseHttpStatus: 200,
            responsePagePath: \`/\${defaultRootObject}\`,
          },
          {
            httpStatus: 403, // We need to redirect reloads from paths (e.g. /foo/bar) to index.html for single page apps
            responseHttpStatus: 200,
            responsePagePath: \`/\${defaultRootObject}\`,
          },
        ],
      },
    );
    // Deploy Website
    this.bucketDeployment = new BucketDeployment(this, 'WebsiteDeployment', {
      sources: [
        Source.asset(websiteFilePath),
        Source.jsonData(
          DEFAULT_RUNTIME_CONFIG_FILENAME,
          RuntimeConfig.ensure(this).config,
        ),
      ],
      destinationBucket: this.websiteBucket,
      // Files in the distribution's edge caches will be invalidated after files are uploaded to the destination bucket.
      distribution: this.cloudFrontDistribution,
      memoryLimit: 1024,
    });
    new CfnOutput(this, 'DistributionDomainName', {
      value: this.cloudFrontDistribution.domainName,
    });
    new CfnOutput(this, \`\${websiteName}WebsiteBucketName\`, {
      value: this.websiteBucket.bucketName,
    });
  }
}

export class CloudfrontWebAcl extends Stack {
  public readonly wafArn;
  constructor(scope: Construct, id: string) {
    super(scope, id, {
      env: {
        region: 'us-east-1',
        account: Stack.of(scope).account,
      },
      crossRegionReferences: true,
    });

    this.wafArn = new CfnWebACL(this, 'WebAcl', {
      defaultAction: { allow: {} },
      scope: 'CLOUDFRONT',
      visibilityConfig: {
        cloudWatchMetricsEnabled: true,
        metricName: id,
        sampledRequestsEnabled: true,
      },
      rules: [
        {
          name: 'CRSRule',
          priority: 0,
          statement: {
            managedRuleGroupStatement: {
              name: 'AWSManagedRulesCommonRuleSet',
              vendorName: 'AWS',
            },
          },
          visibilityConfig: {
            cloudWatchMetricsEnabled: true,
            metricName: 'MetricForWebACLCDK-CRS',
            sampledRequestsEnabled: true,
          },
          overrideAction: {
            none: {},
          },
        },
      ],
    }).attrArn;
  }
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > packages/common/constructs/src/index.ts 1`] = `
"export * from './app/index.js';
export * from './core/index.js';
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > packages/common/constructs/tsconfig.json 1`] = `
"{
  "extends": "../../../tsconfig.base.json",
  "files": [],
  "include": [],
  "references": [
    {
      "path": "./tsconfig.lib.json"
    },
    {
      "path": "./tsconfig.spec.json"
    }
  ],
  "compilerOptions": {}
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > packages/common/constructs/tsconfig.lib.json 1`] = `
"{
  "extends": "../../../tsconfig.base.json",
  "compilerOptions": {
    "rootDir": ".",
    "outDir": "../../../dist/packages/common/constructs/tsc",
    "tsBuildInfoFile": "../../../dist/packages/common/constructs/tsc/tsconfig.lib.tsbuildinfo",
    "emitDeclarationOnly": false,
    "module": "nodenext",
    "moduleResolution": "nodenext",
    "types": ["node"]
  },
  "include": ["src/**/*.ts"],
  "references": [],
  "exclude": [
    "vite.config.ts",
    "vite.config.mts",
    "vitest.config.ts",
    "vitest.config.mts",
    "src/**/*.test.ts",
    "src/**/*.spec.ts",
    "src/**/*.test.tsx",
    "src/**/*.spec.tsx",
    "src/**/*.test.js",
    "src/**/*.spec.js",
    "src/**/*.test.jsx",
    "src/**/*.spec.jsx"
  ]
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > packages/common/constructs/tsconfig.spec.json 1`] = `
"{
  "extends": "../../../tsconfig.base.json",
  "compilerOptions": {
    "outDir": "./out-tsc/vitest",
    "types": [
      "vitest/globals",
      "vitest/importMeta",
      "vite/client",
      "node",
      "vitest"
    ],
    "module": "nodenext",
    "moduleResolution": "nodenext"
  },
  "include": [
    "vite.config.ts",
    "vite.config.mts",
    "vitest.config.ts",
    "vitest.config.mts",
    "src/**/*.test.ts",
    "src/**/*.spec.ts",
    "src/**/*.test.tsx",
    "src/**/*.spec.tsx",
    "src/**/*.test.js",
    "src/**/*.spec.js",
    "src/**/*.test.jsx",
    "src/**/*.spec.jsx",
    "src/**/*.d.ts"
  ],
  "references": [
    {
      "path": "./tsconfig.lib.json"
    }
  ]
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > packages/common/constructs/vite.config.ts 1`] = `
"import { defineConfig } from 'vite';

export default defineConfig(() => ({
  root: __dirname,
  cacheDir: '../../../node_modules/.vite/packages/common/constructs',
  plugins: [],
  // Uncomment this if you are using workers.
  // worker: {
  //  plugins: [ nxViteTsPaths() ],
  // },
  test: {
    name: '@proj/common-constructs',
    watch: false,
    globals: true,
    environment: 'jsdom',
    include: ['src/**/*.{test,spec}.{js,mjs,cjs,ts,mts,cts,jsx,tsx}'],
    reporters: ['default'],
    coverage: {
      reportsDirectory: './test-output/vitest/coverage',
      provider: 'v8' as const,
    },
    passWithNoTests: true,
  },
}));
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > pnpm-workspace.yaml 1`] = `
"packages:
  - 'packages/*'
  - 'test-app'
  - 'packages/common/*'
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > test-app/README.md 1`] = `
"# @proj/test-app

This library was generated with [@aws/nx-plugin](https://github.com/awslabs/nx-plugin-for-aws/).

## Building

Run \`npx nx build @proj/test-app [--skip-nx-cache]\` to build the application.

## Run dev server

Run \`npx nx serve @proj/test-app\`

## Running unit tests

Run \`npx nx test @proj/test-app\` to execute the unit tests via Vitest.

### Updating snapshots

To update snapshots, run the following command:

\`npx nx test @proj/test-app --configuration=update-snapshot\`

## Run lint

Run \`npx nx lint @proj/test-app\`

### Fixable issues

You can also automatically fix some lint errors by running the following command:

\`npx nx lint @proj/test-app --configuration=fix\`

### Runtime config

In order to integrate with cognito or trpc backends, you need to have a \`runtime-config.json\` file in your \`/public\` website directory. You can fetch this is follows:

\`npx nx run @proj/test-app:load:runtime-config\`

> [!IMPORTANT]
> Ensure you have AWS CLI and curl installed
> You have deployed your CDK infrastructure into the appropriate account
> You have assumed a role in the AWS account with sufficient permissions to call describe-stacks from cloudformation

## Useful links

- [React website reference docs](TODO)
- [Learn more about NX](https://nx.dev/getting-started/intro)
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > test-app/eslint.config.mjs 1`] = `
"import nx from '@nx/eslint-plugin';
import baseConfig from '../eslint.config.mjs';

export default [
  ...baseConfig,
  ...nx.configs['flat/react'],
  {
    files: ['**/*.ts', '**/*.tsx', '**/*.js', '**/*.jsx'],
    // Override or add rules here
    rules: {},
  },
];
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > test-app/index.html 1`] = `
"<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>TestApp</title>
    <base href="/" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="stylesheet" href="/src/styles.css" />
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > test-app/project.json 1`] = `
"{
  "name": "@proj/test-app",
  "$schema": "../node_modules/nx/schemas/project-schema.json",
  "sourceRoot": "test-app/src",
  "projectType": "application",
  "tags": [],
  "targets": {
    "build": {
      "dependsOn": ["lint", "compile", "bundle", "test"],
      "options": {
        "outputPath": "dist/test-app/bundle"
      }
    },
    "bundle": {
      "executor": "@nx/vite:build",
      "outputs": ["{options.outputPath}"],
      "defaultConfiguration": "production",
      "options": {
        "outputPath": "dist/test-app/bundle"
      },
      "configurations": {
        "development": {
          "mode": "development"
        },
        "production": {
          "mode": "production"
        }
      }
    },
    "compile": {
      "executor": "nx:run-commands",
      "outputs": ["{workspaceRoot}/dist/{projectRoot}/tsc"],
      "options": {
        "command": "tsc --build tsconfig.app.json",
        "cwd": "{projectRoot}"
      }
    },
    "lint": {
      "executor": "@nx/eslint:lint"
    },
    "load:runtime-config": {
      "executor": "nx:run-commands",
      "metadata": {
        "description": "Load runtime config from your deployed stack for dev purposes. You must set your AWS CLI credentials whilst calling 'pnpm exec nx run @proj/test-app:load:runtime-config'"
      },
      "options": {
        "command": "aws s3 cp s3://\`aws cloudformation describe-stacks --query \\"Stacks[?starts_with(StackName, 'proj-')][].Outputs[] | [?contains(OutputKey, 'TestAppWebsiteBucketName')].OutputValue\\" --output text\`/runtime-config.json './test-app/public/runtime-config.json'"
      }
    },
    "preview": {
      "dependsOn": ["build"],
      "executor": "@nx/vite:preview-server",
      "defaultConfiguration": "development",
      "options": {
        "buildTarget": "@proj/test-app:build"
      },
      "configurations": {
        "development": {
          "buildTarget": "@proj/test-app:build:development"
        },
        "production": {
          "buildTarget": "@proj/test-app:build:production"
        }
      }
    },
    "serve": {
      "executor": "@nx/vite:dev-server",
      "defaultConfiguration": "development",
      "options": {
        "buildTarget": "@proj/test-app:build"
      },
      "configurations": {
        "development": {
          "buildTarget": "@proj/test-app:build:development",
          "hmr": true
        },
        "production": {
          "buildTarget": "@proj/test-app:build:production",
          "hmr": false
        }
      }
    },
    "serve-local": {
      "executor": "@nx/vite:dev-server",
      "options": {
        "buildTarget": "@proj/test-app:build:development",
        "hmr": true,
        "mode": "serve-local"
      },
      "continuous": true
    },
    "serve-static": {
      "executor": "@nx/web:file-server",
      "dependsOn": ["build"],
      "options": {
        "buildTarget": "@proj/test-app:build",
        "spa": true
      }
    },
    "test": {
      "executor": "@nx/vite:test",
      "outputs": ["{options.reportsDirectory}"],
      "options": {
        "reportsDirectory": "../coverage/test-app"
      }
    }
  },
  "metadata": {
    "generator": "ts#react-website"
  }
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > test-app/public/favicon.ico 1`] = `
"    00     ï¿½%  6          ï¿½  ï¿½%       h  ï¿½6  (   0   \`           $                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  V/ V/ cV/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Y1 '                                B# pH [ï¿½f ï¿½ï¿½i ï¿½ï¿½i ï¿½ï¿½i ï¿½ï¿½i ï¿½ï¿½i ï¿½ï¿½i aï¿½j             ï¿½c ï¿½^ Rï¿½\\ ï¿½ï¿½Y ï¿½ï¿½U ï¿½ï¿½R ï¿½|N ï¿½xK uI &                                    V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X1 ï¿½Y2 L                                d= 9_; ï¿½X ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½k H            ï¿½c 8ï¿½a ï¿½] ï¿½ï¿½Z ï¿½ï¿½W ï¿½ï¿½S ï¿½}P ï¿½zM ï¿½vI                                     V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Y1 ï¿½Z3 L                            oD jA ï¿½\`; ï¿½_= ï¿½ï¿½c ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k Ãk     ï¿½j ï¿½f ï¿½ï¿½c ï¿½ï¿½\` ï¿½ï¿½] ï¿½ï¿½Y ï¿½ï¿½V ï¿½ï¿½R ï¿½}O C                                        V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Z2 ï¿½[3 L                            oD [nD ï¿½iA ï¿½X7 ï¿½oI ï¿½ï¿½j ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½m ï¿½k sï¿½i ï¿½ï¿½f ï¿½ï¿½b ï¿½ï¿½_ ï¿½ï¿½[ ï¿½ï¿½W ï¿½ï¿½T ï¿½yL                                         V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X1 ï¿½Z3 ï¿½\\4 M                        nD oE ï¿½qF ï¿½oE ï¿½f@ ï¿½X8 ï¿½ï¿½Z ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½k sï¿½k ï¿½ï¿½k ï¿½ï¿½h ï¿½ï¿½d ï¿½ï¿½a ï¿½ï¿½] ï¿½ï¿½Y Ë…W                                             V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½Y1 ï¿½[3 ï¿½\\4 P                    h= nD ï¿½pE ï¿½rG ï¿½sH ï¿½oF ï¿½a= ï¿½cA ï¿½ï¿½f ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½j ï¿½ï¿½f ï¿½ï¿½b ï¿½ï¿½_ ï¿½\\ S                                                V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Y2 ï¿½[4 ï¿½]5 Q                    mC 6oD ï¿½qF ï¿½sH ï¿½uJ ï¿½uJ ï¿½nF ï¿½]; ï¿½wO ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½h ï¿½ï¿½d ï¿½ï¿½\` ï¿½ï¿½\\                                         V/ 
V/ V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Y2 ï¿½\\4 ï¿½]5 Q                kA 
mC ï¿½oD ï¿½qF ï¿½tH ï¿½vJ ï¿½xL ï¿½vK ï¿½kD ï¿½^= ï¿½ï¿½_ ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½i ï¿½ï¿½e Ø”b (                                        V/ 	V/ ï¿½V/ eV/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Z2 ï¿½\\4 ï¿½^6 Q                lA XmC ï¿½oE ï¿½rG ï¿½tI ï¿½wK ï¿½yM ï¿½zN ï¿½uK ï¿½eA ï¿½jF ï¿½ï¿½h ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½j ï¿½ï¿½g e                                            W0 V/ RV/ ï¿½V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Z2 ï¿½\\4 ï¿½^6 Q            j@ kA ï¿½mC ï¿½pE ï¿½rG ï¿½uI ï¿½wK ï¿½yM ï¿½|O ï¿½{O ï¿½rJ ï¿½^= ï¿½|S ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½j ï¿½ï¿½h                                         ï¿½Z]5 iY1 ï¿½V/ GV/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X0 ï¿½Z2 ï¿½\\5 ï¿½^6 Q            i? kA ï¿½mC ï¿½pE ï¿½rG ï¿½uI ï¿½wK ï¿½zM ï¿½|O ï¿½}P ï¿½xN ï¿½eB ï¿½W: ï¿½ï¿½c ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½oï¿½ï¿½ï¿½$W                                ï¿½ï¿½Hï¿½ï¿½Hï¿½ï¿½KHÉ¦9ï¿½f>ï¿½X1 ï¿½V/ ï¿½V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X0 ï¿½Z2 ï¿½\\4 ï¿½^6 Q        g> 4i? ï¿½kA ï¿½mC ï¿½pE ï¿½rG ï¿½uI ï¿½wK ï¿½zM ï¿½|O ï¿½|P ï¿½vM ï¿½b@ ï¿½bA ï¿½ï¿½g ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½s	ï¿½Óµ]ï¿½ï¿½ï¿½ï¿½                        ï¿½ï¿½H-ï¿½ï¿½Hï¿½ï¿½ï¿½Jï¿½ï¿½ï¿½Gï¿½ï¿½ï¿½*ï¿½\`8ï¿½Y1 ï¿½V/ ï¿½V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Z2 ï¿½\\4 ï¿½^6 Q    d; 	f= ï¿½h? ï¿½kA ï¿½mC ï¿½pE ï¿½rG ï¿½tI ï¿½wK ï¿½yM ï¿½{O ï¿½yN ï¿½mF ï¿½^> ï¿½ï¿½] ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½l ï¿½Í«Hï¿½ï¿½Ú”ï¿½ï¿½Ù›ï¿½Ø–ï¿½Ø–ï¿½Ø–.ï¿½Ø˜rï¿½Öï¿½ï¿½ï¿½Oï¿½ß¾Dï¿½ï¿½ï¿½/ï¿½ï¿½hï¿½i@ï¿½]5 ï¿½Y1 ï¿½V/ ï¿½V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Z2 ï¿½\\4 ï¿½^5 Q    d; Uf< ï¿½h> ï¿½j@ ï¿½mC ï¿½oE ï¿½rG ï¿½tH ï¿½wK ï¿½yL ï¿½xM ï¿½qI ï¿½_= ï¿½vO ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½j ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½iï¿½ï¿½×ï¿½ï¿½Ø—ï¿½ï¿½Ø˜ï¿½ï¿½Ø—ï¿½ï¿½Öï¿½ï¿½ï¿½kï¿½ï¿½ï¿½Gï¿½ï¿½wï¿½mCï¿½e; ï¿½a8 ï¿½]5 ï¿½X1 ï¿½V/ ]V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Y2 ï¿½\\4 ï¿½]5 Pb: c: ï¿½e< ï¿½h> ï¿½j@ ï¿½lB ï¿½oD ï¿½qF ï¿½rG DwK }wK ï¿½sI ï¿½d@ ï¿½cA ï¿½ï¿½f ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½iï¿½ï¿½ï¿½$ï¿½ï¿½ï¿½Wï¿½ï¿½ï¿½pï¿½ï¿½ï¿½vï¿½ï¿½ï¿½nï¿½ï¿½ï¿½Yï¿½ï¿½ï¿½Iï¿½ï¿½ï¿½*ï¿½rGï¿½j@ ï¿½f< ï¿½a8 ï¿½\\4 ï¿½X1 ï¿½V/  V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Y1 ï¿½[3 ï¿½\\5 Qa8 wb: ï¿½e< ï¿½g> ï¿½i@ ï¿½lB ï¿½nD ï¿½pE ï¿½oC uI }sH ï¿½iB ï¿½Z: ï¿½ï¿½Z ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½j ï¿½ï¿½f ï¿½ï¿½eï¿½ï¿½ï¿½ï¿½Î©4ï¿½Ü¹Aï¿½Ş¼Bï¿½×´=ï¿½ï¿½ï¿½(ï¿½}Rï¿½nC ï¿½j@ ï¿½e< ï¿½\`8 ï¿½[4 ï¿½X1 ï¿½    V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X1 ï¿½[3 ï¿½]5 ï¿½\`7 ï¿½b9 ï¿½d; ï¿½f= ï¿½i? ï¿½kA ï¿½mC ï¿½oD *    qG }kD ï¿½Z9 ï¿½oI ï¿½ï¿½j ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½k ï¿½ï¿½k ï¿½ï¿½i ï¿½ï¿½e ï¿½ï¿½a ï¿½ï¿½] ï¿½ï¿½_ï¿½ï¿½gï¿½ï¿½g
ï¿½ï¿½[ï¿½xKï¿½rF ï¿½nC ï¿½i? ï¿½d; ï¿½_7 ï¿½[3 ï¿½X1     V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X0 ï¿½Z2 ï¿½\\4 ï¿½_6 ï¿½a8 ï¿½c: ï¿½f< ï¿½h> ï¿½j@ ï¿½lB q        jB }_< ï¿½\\; ï¿½ï¿½c ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k Ûk Cï¿½k ï¿½ï¿½j ï¿½ï¿½g ï¿½ï¿½c ï¿½ï¿½\` ï¿½ï¿½\\ ï¿½ï¿½X ï¿½ï¿½S ï¿½}O ï¿½yL ï¿½uI ï¿½qE ï¿½lA ï¿½g> ï¿½c: ï¿½^6 ï¿½[3 J        V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Y2 ï¿½\\4 ï¿½^6 ï¿½\`8 ï¿½b: ï¿½e; ï¿½g= ï¿½i? ï¿½kA         \`; }U6 ï¿½U ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k l    ï¿½k $ï¿½h ï¿½ï¿½d ï¿½ï¿½a ï¿½ï¿½^ ï¿½ï¿½Z ï¿½ï¿½V ï¿½ï¿½S ï¿½}O ï¿½xK ï¿½tH ï¿½oD ï¿½j@ ï¿½f< ï¿½a9 ï¿½^6 ZS,         V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X1 ï¿½[3 ï¿½]5 ï¿½_7 ï¿½a9 ï¿½d; ï¿½f< ï¿½g> M            T4 ~kE ï¿½ï¿½i ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k         ï¿½e ï¿½b ï¿½ï¿½_ ï¿½[ ï¿½ï¿½X ï¿½ï¿½T ï¿½Q ï¿½zM ï¿½vJ ï¿½rF ï¿½mB ï¿½i? ï¿½e; ï¿½a8 BW0             V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Z2 ï¿½\\4 ï¿½^6 ï¿½\`8 ï¿½b: ï¿½d; ï¿½g=             iC ~ï¿½a ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½k :                ï¿½\` ï¿½] @ï¿½Y ï¿½ï¿½V Ú€R ï¿½|O ï¿½xK ï¿½tH ï¿½pD ï¿½lA ï¿½h> he;                     V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Y1 ï¿½[3 ï¿½]5 ï¿½_7 ï¿½a8 ï¿½c: .                xL ~Q ï¿½ï¿½R ï¿½ï¿½S ï¿½ï¿½T ï¿½ï¿½T ï¿½ï¿½U ï¿½ï¿½W ï¿½ï¿½o                         ï¿½W ï¿½T Q ={M TwJ YsG JoD +kA                             V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X0 ï¿½Z2 ï¿½\\4 ï¿½^6 ï¿½\`7 w                    kA }lB ï¿½nC ï¿½oD ï¿½pF ï¿½rG ï¿½sH ï¿½sH ï¿½                                                                                        V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W/ ï¿½X1 ï¿½Z3 ï¿½\\4 ï¿½^6                     j@ }kA ï¿½lB ï¿½nC ï¿½oD ï¿½pE ï¿½qF ï¿½rG ï¿½                                                                                        V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Y2 ï¿½[3 R                        h> }i? ï¿½j@ ï¿½lB ï¿½mC ï¿½nC ï¿½oD ï¿½pE ï¿½                                                                                        V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Z2                         f= }g= ï¿½h? ï¿½j@ ï¿½kA ï¿½lB ï¿½mB ï¿½mC ï¿½                                                                                        V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ 2                            d; }e< ï¿½f= ï¿½g> ï¿½i? ï¿½j@ ï¿½j@ ï¿½kA ï¿½                                                                                        V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ~                                b9 }c: ï¿½d; ï¿½e< ï¿½f= ï¿½g> ï¿½h> ï¿½i? ï¿½                                                                                        V/ 
V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/                                 \`7 }a8 ï¿½b9 ï¿½c: ï¿½d; ï¿½e< ï¿½f< ï¿½f= ï¿½                                                                                        V/ V/ TV/ pV/ nV/ nV/ nV/ nV/ oV/ :                                    _6 6\`7 oa8 nb9 nc: nd; nd; pe; C                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½>ï¿½  ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ ï¿½  ï¿½ï¿½  ï¿½  ï¿½ï¿½  ï¿½  ï¿½ï¿½  ?ï¿½  ï¿½ï¿½  ï¿½  ï¿½ï¿½  ï¿½  ï¿½ï¿½  ï¿½ï¿½  ï¿½ï¿½  ï¿½  ï¿½ï¿½  >   ï¿½ï¿½     ï¿½ï¿½\`    ï¿½ï¿½\`    ï¿½ ï¿½    ï¿½ï¿½   ï¿½ï¿½   ï¿½ï¿½   ï¿½ï¿½?ï¿½  ï¿½ï¿½?ï¿½ï¿½  ï¿½ï¿½?ï¿½ï¿½  ï¿½ï¿½?ï¿½ï¿½  ï¿½ï¿½?ï¿½ï¿½  ï¿½ï¿½?ï¿½ï¿½  ï¿½?ï¿½?ï¿½ï¿½  ï¿½ï¿½?ï¿½ï¿½  ï¿½ï¿½?ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  (       @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             V/ V/ XV/ \\V/ \\V/ ]X1 /                    L, ~S Iï¿½i \`ï¿½i _ï¿½i _ï¿½i [ï¿½i         ï¿½_ ï¿½\\ Vï¿½X \\ï¿½S \\{N ^wJ ,                        V/ KV/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Y1 ï¿½                    d= BgA ï¿½b ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½s ï¿½c ï¿½ï¿½_ ï¿½ï¿½Z ï¿½ï¿½U ï¿½}P ï¿½xL 6                        V/ KV/ ï¿½V/ ï¿½V/ ï¿½X1 ï¿½Z3 ï¿½                pE mC ï¿½b= ï¿½pJ ï¿½ï¿½j ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½k Jï¿½k Aï¿½g ï¿½c ï¿½ï¿½] ï¿½ï¿½X ï¿½ï¿½T y                            V/ KV/ ï¿½V/ ï¿½V/ ï¿½Y1 ï¿½[3 ï¿½                oD fqF ï¿½nE ï¿½\`= ï¿½ï¿½Y ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k Ïk Ëj ï¿½ï¿½f ï¿½ï¿½\` ï¿½ï¿½[ ï¿½ï¿½V                             V/ KV/ ï¿½V/ ï¿½W/ ï¿½Z2 ï¿½\\4 ï¿½            mC #oD ï¿½rG ï¿½uI ï¿½lE ï¿½hD ï¿½ï¿½e ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½h ï¿½ï¿½c ï¿½^ F                        V/ V/ V/ KV/ ï¿½V/ ï¿½W0 ï¿½Z3 ï¿½]5 ï¿½        h> mC ï¿½pE ï¿½sH ï¿½wK ï¿½wL ï¿½hC ï¿½yP ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½i ï¿½ï¿½e ï¿½ï¿½[                         V/ *V/ zV/ KV/ ï¿½V/ ï¿½W0 ï¿½[3 ï¿½]5 ï¿½        kA @mB ï¿½pE ï¿½tI ï¿½xL ï¿½{N ï¿½wL ï¿½fC ï¿½ï¿½] ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½j Íšg                         ï¿½w 	]5\\W0 oV/ KV/ ï¿½V/ ï¿½W0 ï¿½[3 ï¿½]5 ï¿½    g> j@ ï¿½mB ï¿½qF ï¿½tI ï¿½xL ï¿½|O ï¿½|P ï¿½hC ï¿½mI ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½lï¿½ï¿½ï¿½ï¿½                ï¿½ï¿½Fï¿½ï¿½J ï¿½ï¿½NIÄ¢6ï¿½d<ï¿½V/ ï¿½V/ KV/ ï¿½V/ ï¿½W0 ï¿½[3 ï¿½]5 ï¿½    g= ci? ï¿½mB ï¿½pE ï¿½tH ï¿½xL ï¿½{N ï¿½wM ï¿½eB ï¿½ï¿½[ ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½j ï¿½ï¿½ï¿½3ï¿½ï¿½Ú‘Uï¿½İ©ï¿½Úœï¿½ÙœFï¿½ï¿½ukß¾DÒ½ï¿½1ï¿½ï¿½cï¿½]5 ï¿½W0 ï¿½V/ KV/ ï¿½V/ ï¿½W0 ï¿½Z3 ï¿½]5 ï¿½d; e< ï¿½i? ï¿½lB ï¿½pE ï¿½sH ï¿½wK ï¿½wL ï¿½hC ï¿½vN ï¿½ï¿½j ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½j ï¿½ï¿½zï¿½Ü¿^ï¿½ï¿½Öˆï¿½ï¿½×ï¿½ï¿½Ô‚ï¿½ï¿½ï¿½Zï¿½ï¿½ï¿½!ï¿½mCï¿½a8 ï¿½[4 ï¿½W0 ï¿½V/ KV/ ï¿½V/ ï¿½W/ ï¿½Z2 ï¿½\\4 ï¿½b9 ï¿½d; ï¿½h> ï¿½kA ï¿½oD ï¿½qF BuJ ï¿½mE ï¿½fB ï¿½ï¿½d ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½g ï¿½ï¿½{ï¿½Îª=ï¿½Ü½Mï¿½Ù¸Dï¿½ï¿½ï¿½'ï¿½uJï¿½h> ï¿½b9 ï¿½[3 ï¿½W0 6V/ KV/ ï¿½V/ ï¿½V/ ï¿½Y1 ï¿½\\4 ï¿½\`8 ï¿½c: ï¿½g= ï¿½j@ ï¿½mC ï¿½zK lD ï¿½_< ï¿½ï¿½W ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k Øj ï¿½ï¿½f ï¿½ï¿½_ ï¿½ï¿½_ï¿½ï¿½e
ï¿½ï¿½]	ï¿½wKï¿½nC ï¿½g= ï¿½\`7 ï¿½[3 L' V/ KV/ ï¿½V/ ï¿½V/ ï¿½X1 ï¿½[3 ï¿½_6 ï¿½b9 ï¿½e< ï¿½h? ï¿½kA %    \\9 ï¿½mG ï¿½ï¿½i ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k eï¿½k 9ï¿½g Õ”b ï¿½ï¿½] ï¿½ï¿½W ï¿½Q ï¿½yL ï¿½sG ï¿½lA ï¿½e< ï¿½\`7 ï¿½[3     V/ KV/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Z2 ï¿½]5 ï¿½a8 ï¿½d; ï¿½f= j       eA ï¿½ï¿½a ï¿½ï¿½l ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½k ï¿½ï¿½k     ï¿½d .ï¿½_ ï¿½ï¿½Z ï¿½U ï¿½}O ï¿½vJ ï¿½pE ï¿½j? ï¿½d; v_7         V/ KV/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X1 ï¿½\\4 ï¿½_7 ï¿½b9 ï¿½e;        |P ï¿½ï¿½Y ï¿½ï¿½Z ï¿½ï¿½[ ï¿½ï¿½\\ ï¿½a A            ï¿½\\ ï¿½W 7ï¿½R nzM ï¿½tH ï¿½nC \\i? !a9             V/ KV/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½W0 ï¿½Z2 ï¿½]5 ï¿½_7 G        j? lA ï¿½mC ï¿½oD ï¿½qF ï¿½sG ï¿½sH +                                                        V/ KV/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X1 ï¿½[3 ï¿½\`7         b8 i? ï¿½j@ ï¿½mB ï¿½nD ï¿½pE ï¿½pE +                                                        V/ KV/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½X1 )            _6 f= ï¿½g> ï¿½i@ ï¿½kA ï¿½lB ï¿½mC +                                                        V/ LV/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ q                ]4 c: ï¿½d; ï¿½f= ï¿½h> ï¿½i? ï¿½i? +                                                        V/ @V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/ ï¿½V/                 [2 \`8 ï¿½b9 ï¿½c: ï¿½e; ï¿½f< ï¿½f= $                                                        V/ V/ V/ V/ V/ V/                         _6 \`7 a9 c: d; d;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½0ï¿½ï¿½0ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½ ï¿½ï¿½   ï¿½ ï¿½ ï¿½00ï¿½p8ï¿½p?ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½(                                                                                                                                                                                                                                    V/ 'V/ ;W0 *Z3     ^: ï¿½] 2ï¿½k =ï¿½j %    ï¿½] #ï¿½V <{N (j?         V/ ï¿½V/ ï¿½X1 ï¿½\\4     h@ LvM ï¿½i ï¿½ï¿½k Êk Aï¿½c Æ‰Y ï¿½Q a            V/ ï¿½V/ ï¿½Z2 ï¿½[4 nC qF ï¿½lE ï¿½ï¿½Z ï¿½ï¿½l ï¿½ï¿½k ï¿½h ï¿½ï¿½\` ï¿½ï¿½V         V/ 	V/ ï¿½W0 ï¿½[3 ï¿½[4 mC rrG ï¿½wK ï¿½tL ï¿½ï¿½e ï¿½ï¿½k ï¿½ï¿½jï¿½d8        ï¿½ï¿½(
\\5VV/ ï¿½W0 ï¿½[3 ï¿½f= 1kA ï¿½rG ï¿½zM ï¿½qI ï¿½ï¿½^ ï¿½ï¿½k ï¿½ï¿½zï¿½ï¿½ï¿½z0ï¿½ï¿½#ï¿½ï¿½R^ï¿½}#ï¿½b:ï¿½V/ ï¿½W0 ï¿½Z3 ï¿½d; ï¿½j@ ï¿½qF ï¿½qH ï¿½zP ï¿½ï¿½j ï¿½ï¿½k ï¿½ï¿½rï¿½Æ¤Bï¿½Ú½]ã«†*ï¿½lCï¿½[3 ï¿½V/ ï¿½V/ ï¿½Z2 ï¿½a8 ï¿½g> ï¿½jA GlF Â“c ï¿½ï¿½l ï¿½ï¿½k ï¿½ï¿½e ï¿½aï¿½ï¿½^ï¿½sHï¿½c: ï¿½[4 7V/ ï¿½V/ ï¿½X1 ï¿½^6 ï¿½c: ï¿½^: ï¿½T Å’a ï¿½ï¿½d ï¿½ï¿½n 
ï¿½\` @ï¿½V ï¿½xK ï¿½mB ï¿½d; -    V/ ï¿½V/ ï¿½V/ ï¿½Z2 ï¿½_6  mB 
mC ï¿½pE ï¿½sG ï¿½        yL tH lA         V/ ï¿½V/ ï¿½V/ ï¿½W/ d    c: e< ï¿½h? ï¿½j@ ï¿½                            V/ RV/ |V/ hV/     _7 a9 ^d; }f< A                                                                                                                                                            ï¿½ï¿½  ï¿½ï¿½  ï¿½ï¿½  ï¿½ï¿½  O              c      ï¿½ï¿½  ï¿½ï¿½  ï¿½ï¿½  "
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > test-app/src/components/AppLayout/index.tsx 1`] = `
"import * as React from 'react';
import { createContext, useCallback, useEffect, useState } from 'react';
import Config from '../../config';

import {
  BreadcrumbGroup,
  BreadcrumbGroupProps,
  SideNavigation,
  TopNavigation,
} from '@cloudscape-design/components';
import CloudscapeAppLayout, {
  AppLayoutProps,
} from '@cloudscape-design/components/app-layout';
import { matchByPath, useLocation, useNavigate } from '@tanstack/react-router';

const getBreadcrumbs = (
  pathName: string,
  search: string,
  defaultBreadcrumb: string,
  availableRoutes?: string[],
) => {
  const segments = [
    defaultBreadcrumb,
    ...pathName.split('/').filter((segment) => segment !== ''),
  ];

  return segments.map((segment, i) => {
    const href =
      i === 0
        ? '/'
        : \`/\${segments
            .slice(1, i + 1)
            .join('/')
            .replace('//', '/')}\`;

    const matched =
      !availableRoutes || availableRoutes.find((r) => matchByPath(r, href, {}));

    return {
      href: matched ? \`\${href}\${search}\` : '#',
      text: segment,
    };
  });
};

export interface AppLayoutContext {
  appLayoutProps: AppLayoutProps;
  setAppLayoutProps: (props: AppLayoutProps) => void;
  displayHelpPanel: (helpContent: React.ReactNode) => void;
}

/**
 * Context for updating/retrieving the AppLayout.
 */
export const AppLayoutContext = createContext({
  appLayoutProps: {},
  // eslint-disable-next-line @typescript-eslint/no-empty-function
  setAppLayoutProps: (_: AppLayoutProps) => {},
  // eslint-disable-next-line @typescript-eslint/no-empty-function
  displayHelpPanel: (_: React.ReactNode) => {},
});

/**
 * Defines the App layout and contains logic for routing.
 */
const AppLayout: React.FC<React.PropsWithChildren> = ({ children }) => {
  const appLayout = React.useRef<AppLayoutProps.Ref>(null);
  const [appLayoutProps, setAppLayoutProps] = useState<AppLayoutProps>({});
  const setAppLayoutPropsSafe = useCallback(
    (props: AppLayoutProps) => {
      JSON.stringify(appLayoutProps) !== JSON.stringify(props) &&
        setAppLayoutProps(props);
    },
    [appLayoutProps],
  );

  const navigate = useNavigate();
  const [activeBreadcrumbs, setActiveBreadcrumbs] = useState<
    BreadcrumbGroupProps.Item[]
  >([{ text: '/', href: '/' }]);
  const { pathname, search } = useLocation();

  useEffect(() => {
    const breadcrumbs = getBreadcrumbs(
      pathname,
      Object.entries(search).reduce((p, [k, v]) => p + \`\${k}=\${v}\`, ''),
      '/',
    );
    setActiveBreadcrumbs(breadcrumbs);
  }, [pathname, search]);

  const onNavigate = useCallback(
    (e: CustomEvent<{ href: string; external?: boolean }>) => {
      if (!e.detail.external) {
        e.preventDefault();
        setAppLayoutPropsSafe({
          contentType: undefined,
        });
        navigate({ to: e.detail.href });
      }
    },
    [navigate, setAppLayoutPropsSafe],
  );

  return (
    <AppLayoutContext.Provider
      value={{
        appLayoutProps,
        setAppLayoutProps: setAppLayoutPropsSafe,
        displayHelpPanel: (helpContent: React.ReactNode) => {
          setAppLayoutPropsSafe({ tools: helpContent, toolsHide: false });
          appLayout.current?.openTools();
        },
      }}
    >
      <TopNavigation
        identity={{
          href: '/',
          title: Config.applicationName,
          logo: {
            src: Config.logo,
          },
        }}
      />
      <CloudscapeAppLayout
        ref={appLayout}
        breadcrumbs={
          <BreadcrumbGroup onFollow={onNavigate} items={activeBreadcrumbs} />
        }
        navigation={
          <SideNavigation
            header={{ text: Config.applicationName, href: '/' }}
            activeHref={pathname}
            onFollow={onNavigate}
            items={[{ text: 'Home', type: 'link', href: '/' }]}
          />
        }
        toolsHide
        content={children}
        {...appLayoutProps}
      />
    </AppLayoutContext.Provider>
  );
};

export default AppLayout;
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > test-app/src/config.ts 1`] = `
"export default {
  applicationName: 'test-app',
  logo: 'data:image/svg+xml;base64,PCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KDTwhLS0gVXBsb2FkZWQgdG86IFNWRyBSZXBvLCB3d3cuc3ZncmVwby5jb20sIFRyYW5zZm9ybWVkIGJ5OiBTVkcgUmVwbyBNaXhlciBUb29scyAtLT4KPHN2ZyBmaWxsPSIjMjQ4YmFlIiB3aWR0aD0iODAwcHgiIGhlaWdodD0iODAwcHgiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0cm9rZT0iIzI0OGJhZSI+Cg08ZyBpZD0iU1ZHUmVwb19iZ0NhcnJpZXIiIHN0cm9rZS13aWR0aD0iMCIvPgoNPGcgaWQ9IlNWR1JlcG9fdHJhY2VyQ2FycmllciIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+Cg08ZyBpZD0iU1ZHUmVwb19pY29uQ2FycmllciI+Cg08dGl0bGU+aW9uaWNvbnMtdjVfbG9nb3M8L3RpdGxlPgoNPHBhdGggZD0iTTQxMC42NiwxODAuNzJoMHEtNy42Ny0yLjYyLTE1LjQ1LTQuODgsMS4yOS01LjI1LDIuMzgtMTAuNTZjMTEuNy01Ni45LDQuMDUtMTAyLjc0LTIyLjA2LTExNy44My0yNS0xNC40OC02NiwuNjEtMTA3LjM2LDM2LjY5cS02LjEsNS4zNC0xMS45NSwxMS0zLjktMy43Ni04LTcuMzZjLTQzLjM1LTM4LjU4LTg2LjgtNTQuODMtMTEyLjg4LTM5LjY5LTI1LDE0LjUxLTMyLjQzLDU3LjYtMjEuOSwxMTEuNTNxMS41OCw4LDMuNTUsMTUuOTNjLTYuMTUsMS43NS0xMi4wOSwzLjYyLTE3Ljc3LDUuNkM0OC40NiwxOTguOSwxNiwyMjYuNzMsMTYsMjU1LjU5YzAsMjkuODIsMzQuODQsNTkuNzIsODcuNzcsNzcuODVxNi40NCwyLjE5LDEzLDQuMDdRMTE0LjY0LDM0NiwxMTMsMzU0LjY4Yy0xMCw1My0yLjIsOTUuMDcsMjIuNzUsMTA5LjQ5LDI1Ljc3LDE0Ljg5LDY5LS40MSwxMTEuMTQtMzcuMzFxNS00LjM4LDEwLTkuMjUsNi4zMiw2LjExLDEzLDExLjg2YzQwLjgsMzUuMTgsODEuMDksNDkuMzksMTA2LDM0LjkzLDI1Ljc1LTE0Ljk0LDM0LjEyLTYwLjE0LDIzLjI1LTExNS4xM3EtMS4yNS02LjMtMi44OC0xMi44Niw0LjU2LTEuMzUsOC45My0yLjc5YzU1LTE4LjI3LDkwLjgzLTQ3LjgxLDkwLjgzLTc4QzQ5NiwyMjYuNjIsNDYyLjUsMTk4LjYxLDQxMC42NiwxODAuNzJabS0xMjktODEuMDhjMzUuNDMtMzAuOTEsNjguNTUtNDMuMTEsODMuNjUtMzQuMzloMGMxNi4wNyw5LjI5LDIyLjMyLDQ2Ljc1LDEyLjIyLDk1Ljg4cS0xLDQuOC0yLjE2LDkuNTdhNDg3LjgzLDQ4Ny44MywwLDAsMC02NC4xOC0xMC4xNiw0ODEuMjcsNDgxLjI3LDAsMCwwLTQwLjU3LTUwLjc1UTI3NiwxMDQuNTcsMjgxLjY0LDk5LjY0Wk0xNTcuNzMsMjgwLjI1cTYuNTEsMTIuNiwxMy42MSwyNC44OSw3LjIzLDEyLjU0LDE1LjA3LDI0LjcxYTQzNS4yOCw0MzUuMjgsMCwwLDEtNDQuMjQtNy4xM0MxNDYuNDEsMzA5LDE1MS42MywyOTQuNzUsMTU3LjczLDI4MC4yNVptMC00OC4zM2MtNi0xNC4xOS0xMS4wOC0yOC4xNS0xNS4yNS00MS42MywxMy43LTMuMDcsMjguMy01LjU4LDQzLjUyLTcuNDhxLTcuNjUsMTEuOTQtMTQuNzIsMjQuMjNUMTU3LjcsMjMxLjkyWm0xMC45LDI0LjE3cTkuNDgtMTkuNzcsMjAuNDItMzguNzhoMHExMC45My0xOSwyMy4yNy0zNy4xM2MxNC4yOC0xLjA4LDI4LjkyLTEuNjUsNDMuNzEtMS42NXMyOS41Mi41Nyw0My43OSwxLjY2cTEyLjIxLDE4LjA5LDIzLjEzLDM3dDIwLjY5LDM4LjZRMzM0LDI3NS42MywzMjMsMjk0LjczaDBxLTEwLjkxLDE5LTIzLDM3LjI0Yy0xNC4yNSwxLTI5LDEuNTUtNDQsMS41NXMtMjkuNDctLjQ3LTQzLjQ2LTEuMzhxLTEyLjQzLTE4LjE5LTIzLjQ2LTM3LjI5VDE2OC42LDI1Ni4wOVpNMzQwLjc1LDMwNXE3LjI1LTEyLjU4LDEzLjkyLTI1LjQ5aDBhNDQwLjQxLDQ0MC40MSwwLDAsMSwxNi4xMiw0Mi4zMkE0MzQuNDQsNDM0LjQ0LDAsMCwxLDMyNiwzMjkuNDhRMzMzLjYyLDMxNy4zOSwzNDAuNzUsMzA1Wm0xMy43Mi03My4wN3EtNi42NC0xMi42NS0xMy44MS0yNWgwcS03LTEyLjE4LTE0LjU5LTI0LjA2YzE1LjMxLDEuOTQsMzAsNC41Miw0My43Nyw3LjY3QTQzOS44OSw0MzkuODksMCwwLDEsMzU0LjQ3LDIzMS45M1pNMjU2LjIzLDEyNC40OGgwYTQzOS43NSw0MzkuNzUsMCwwLDEsMjguMjUsMzQuMThxLTI4LjM1LTEuMzUtNTYuNzQsMEMyMzcuMDcsMTQ2LjMyLDI0Ni42MiwxMzQuODcsMjU2LjIzLDEyNC40OFpNMTQ1LjY2LDY1Ljg2YzE2LjA2LTkuMzIsNTEuNTcsNCw4OSwzNy4yNywyLjM5LDIuMTMsNC44LDQuMzYsNy4yLDYuNjdBNDkxLjM3LDQ5MS4zNywwLDAsMCwyMDEsMTYwLjUxYTQ5OS4xMiw0OTkuMTIsMCwwLDAtNjQuMDYsMTBxLTEuODMtNy4zNi0zLjMtMTQuODJoMEMxMjQuNTksMTA5LjQ2LDEzMC41OCw3NC42MSwxNDUuNjYsNjUuODZaTTEyMi4yNSwzMTcuNzFxLTYtMS43MS0xMS44NS0zLjcxYy0yMy40LTgtNDIuNzMtMTguNDQtNTYtMjkuODFDNDIuNTIsMjc0LDM2LjUsMjYzLjgzLDM2LjUsMjU1LjU5YzAtMTcuNTEsMjYuMDYtMzkuODUsNjkuNTItNTVxOC4xOS0yLjg1LDE2LjUyLTUuMjFhNDkzLjU0LDQ5My41NCwwLDAsMCwyMy40LDYwLjc1QTUwMi40Niw1MDIuNDYsMCwwLDAsMTIyLjI1LDMxNy43MVptMTExLjEzLDkzLjY3Yy0xOC42MywxNi4zMi0zNy4yOSwyNy44OS01My43NCwzMy43MmgwYy0xNC43OCw1LjIzLTI2LjU1LDUuMzgtMzMuNjYsMS4yNy0xNS4xNC04Ljc1LTIxLjQ0LTQyLjU0LTEyLjg1LTg3Ljg2cTEuNTMtOCwzLjUtMTZhNDgwLjg1LDQ4MC44NSwwLDAsMCw2NC42OSw5LjM5LDUwMS4yLDUwMS4yLDAsMCwwLDQxLjIsNTFDMjM5LjU0LDQwNS44MywyMzYuNDksNDA4LjY1LDIzMy4zOCw0MTEuMzhabTIzLjQyLTIzLjIyYy05LjcyLTEwLjUxLTE5LjQyLTIyLjE0LTI4Ljg4LTM0LjY0cTEzLjc5LjU0LDI4LjA4LjU0YzkuNzgsMCwxOS40Ni0uMjEsMjktLjY0QTQzOS4zMyw0MzkuMzMsMCwwLDEsMjU2LjgsMzg4LjE2Wm0xMjQuNTIsMjguNTljLTIuODYsMTUuNDQtOC42MSwyNS43NC0xNS43MiwyOS44Ni0xNS4xMyw4Ljc4LTQ3LjQ4LTIuNjMtODIuMzYtMzIuNzItNC0zLjQ0LTgtNy4xMy0xMi4wNy0xMWE0ODQuNTQsNDg0LjU0LDAsMCwwLDQwLjIzLTUxLjIsNDc3Ljg0LDQ3Ny44NCwwLDAsMCw2NS0xMC4wNXExLjQ3LDUuOTQsMi42LDExLjY0aDBDMzgzLjgxLDM3Ny41OCwzODQuNSwzOTkuNTYsMzgxLjMyLDQxNi43NVptMTcuNC0xMDIuNjRoMGMtMi42Mi44Ny01LjMyLDEuNzEtOC4wNiwyLjUzYTQ4My4yNiw0ODMuMjYsMCwwLDAtMjQuMzEtNjAuOTQsNDgxLjUyLDQ4MS41MiwwLDAsMCwyMy4zNi02MC4wNmM0LjkxLDEuNDMsOS42OCwyLjkzLDE0LjI3LDQuNTIsNDQuNDIsMTUuMzIsNzEuNTIsMzgsNzEuNTIsNTUuNDNDNDc1LjUsMjc0LjE5LDQ0Ni4yMywyOTguMzMsMzk4LjcyLDMxNC4xMVoiLz4KDTxwYXRoIGQ9Ik0yNTYsMjk4LjU1YTQzLDQzLDAsMSwwLTQyLjg2LTQzQTQyLjkxLDQyLjkxLDAsMCwwLDI1NiwyOTguNTVaIi8+Cg08L2c+Cg08L3N2Zz4=',
};
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > test-app/src/hooks/useAppLayout.tsx 1`] = `
"import { useContext } from 'react';
import { AppLayoutContext } from '../components/AppLayout';

export const useAppLayout = (): AppLayoutContext =>
  useContext(AppLayoutContext);
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > test-app/src/main.tsx 1`] = `
"import React from 'react';
import { createRoot } from 'react-dom/client';
import { I18nProvider } from '@cloudscape-design/components/i18n';
import messages from '@cloudscape-design/components/i18n/messages/all.en';
import '@cloudscape-design/global-styles/index.css';
import { RouterProvider, createRouter } from '@tanstack/react-router';
import { routeTree } from './routeTree.gen';

// eslint-disable-next-line @typescript-eslint/no-empty-object-type
export type RouterProviderContext = {};

const router = createRouter({
  routeTree,
  context: {},
});

// Register the router instance for type safety
declare module '@tanstack/react-router' {
  interface Register {
    router: typeof router;
  }
}

const App = () => {
  return <RouterProvider router={router} context={{}} />;
};

const root = document.getElementById('root');
root &&
  createRoot(root).render(
    <React.StrictMode>
      <I18nProvider locale="en" messages={[messages]}>
        <App />
      </I18nProvider>
    </React.StrictMode>,
  );
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > test-app/src/routeTree.gen.ts 1`] = `
"/* eslint-disable */

// @ts-nocheck

// noinspection JSUnusedGlobalSymbols

// This file was automatically generated by TanStack Router.
// You should NOT make any changes in this file as it will be overwritten.
// Additionally, you should also exclude this file from your linter and/or formatter to prevent it from being checked or modified.

// Import Routes

import { Route as rootRoute } from './routes/__root';
import { Route as IndexImport } from './routes/index';
import { Route as WelcomeIndexImport } from './routes/welcome/index';

// Create/Update Routes

const IndexRoute = IndexImport.update({
  id: '/',
  path: '/',
  getParentRoute: () => rootRoute,
} as any);

const WelcomeIndexRoute = WelcomeIndexImport.update({
  id: '/welcome/',
  path: '/welcome/',
  getParentRoute: () => rootRoute,
} as any);

// Populate the FileRoutesByPath interface

declare module '@tanstack/react-router' {
  interface FileRoutesByPath {
    '/': {
      id: '/';
      path: '/';
      fullPath: '/';
      preLoaderRoute: typeof IndexImport;
      parentRoute: typeof rootRoute;
    };
    '/welcome/': {
      id: '/welcome/';
      path: '/welcome';
      fullPath: '/welcome';
      preLoaderRoute: typeof WelcomeIndexImport;
      parentRoute: typeof rootRoute;
    };
  }
}

// Create and export the route tree

export interface FileRoutesByFullPath {
  '/': typeof IndexRoute;
  '/welcome': typeof WelcomeIndexRoute;
}

export interface FileRoutesByTo {
  '/': typeof IndexRoute;
  '/welcome': typeof WelcomeIndexRoute;
}

export interface FileRoutesById {
  __root__: typeof rootRoute;
  '/': typeof IndexRoute;
  '/welcome/': typeof WelcomeIndexRoute;
}

export interface FileRouteTypes {
  fileRoutesByFullPath: FileRoutesByFullPath;
  fullPaths: '/' | '/welcome';
  fileRoutesByTo: FileRoutesByTo;
  to: '/' | '/welcome';
  id: '__root__' | '/' | '/welcome/';
  fileRoutesById: FileRoutesById;
}

export interface RootRouteChildren {
  IndexRoute: typeof IndexRoute;
  WelcomeIndexRoute: typeof WelcomeIndexRoute;
}

const rootRouteChildren: RootRouteChildren = {
  IndexRoute: IndexRoute,
  WelcomeIndexRoute: WelcomeIndexRoute,
};

export const routeTree = rootRoute
  ._addFileChildren(rootRouteChildren)
  ._addFileTypes<FileRouteTypes>();

/* ROUTE_MANIFEST_START
{
  "routes": {
    "__root__": {
      "filePath": "__root.tsx",
      "children": [
        "/",
        "/welcome/"
      ]
    },
    "/": {
      "filePath": "index.tsx"
    },
    "/welcome/": {
      "filePath": "welcome/index.tsx"
    }
  }
}
ROUTE_MANIFEST_END */
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > test-app/src/routes/__root.tsx 1`] = `
"import { createRootRouteWithContext } from '@tanstack/react-router';
import AppLayout from '../components/AppLayout';
import { RouterProviderContext } from '../main';
import { Outlet } from '@tanstack/react-router';

export const Route = createRootRouteWithContext<RouterProviderContext>()({
  component: () => (
    <AppLayout>
      <Outlet />
    </AppLayout>
  ),
});
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > test-app/src/routes/index.tsx 1`] = `
"import {
  ContentLayout,
  Header,
  SpaceBetween,
  Container,
} from '@cloudscape-design/components';
import { createFileRoute } from '@tanstack/react-router';

export const Route = createFileRoute('/')({
  component: RouteComponent,
});

function RouteComponent() {
  return (
    <ContentLayout header={<Header>Welcome</Header>}>
      <SpaceBetween size="l">
        <Container>Welcome to your new React website!</Container>
      </SpaceBetween>
    </ContentLayout>
  );
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > test-app/src/styles.css 1`] = `
"@import 'tailwindcss';
/* You can add global styles to this file, and also import other style files */
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > test-app/tsconfig.app.json 1`] = `
"{
  "extends": "../tsconfig.base.json",
  "compilerOptions": {
    "outDir": "../dist/test-app/tsc",
    "tsBuildInfoFile": "../dist/test-app/tsc/tsconfig.lib.tsbuildinfo",
    "jsx": "react-jsx",
    "lib": ["DOM"],
    "types": [
      "node",
      "@nx/react/typings/cssmodule.d.ts",
      "@nx/react/typings/image.d.ts",
      "vite/client"
    ]
  },
  "exclude": [
    "src/**/*.spec.ts",
    "src/**/*.test.ts",
    "src/**/*.spec.tsx",
    "src/**/*.test.tsx",
    "src/**/*.spec.js",
    "src/**/*.test.js",
    "src/**/*.spec.jsx",
    "src/**/*.test.jsx",
    "vite.config.ts",
    "vite.config.mts",
    "vitest.config.ts",
    "vitest.config.mts"
  ],
  "include": ["src/**/*.js", "src/**/*.jsx", "src/**/*.ts", "src/**/*.tsx"]
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > test-app/tsconfig.json 1`] = `
"{
  "files": [],
  "include": [],
  "references": [
    {
      "path": "./tsconfig.app.json"
    },
    {
      "path": "./tsconfig.spec.json"
    }
  ],
  "extends": "../tsconfig.base.json",
  "compilerOptions": {
    "moduleResolution": "Bundler",
    "module": "Preserve"
  }
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > test-app/tsconfig.spec.json 1`] = `
"{
  "extends": "../tsconfig.base.json",
  "compilerOptions": {
    "outDir": "./out-tsc/vitest",
    "types": [
      "vitest/globals",
      "vitest/importMeta",
      "vite/client",
      "node",
      "vitest",
      "@nx/react/typings/cssmodule.d.ts",
      "@nx/react/typings/image.d.ts"
    ]
  },
  "include": [
    "vite.config.ts",
    "vite.config.mts",
    "vitest.config.ts",
    "vitest.config.mts",
    "src/**/*.test.ts",
    "src/**/*.spec.ts",
    "src/**/*.test.tsx",
    "src/**/*.spec.tsx",
    "src/**/*.test.js",
    "src/**/*.spec.js",
    "src/**/*.test.jsx",
    "src/**/*.spec.jsx",
    "src/**/*.d.ts"
  ],
  "references": [
    {
      "path": "./tsconfig.app.json"
    }
  ]
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > test-app/vite.config.ts 1`] = `
"import tailwindcss from '@tailwindcss/vite';
import tsconfigPaths from 'vite-tsconfig-paths';
import { resolve } from 'path';
import { tanstackRouter } from '@tanstack/router-plugin/vite';
/// <reference types='vitest' />
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig(() => ({
  define: {
    global: {},
  },
  root: __dirname,
  cacheDir: '../node_modules/.vite/test-app',
  server: {
    port: 4200,
    host: 'localhost',
  },
  preview: {
    port: 4300,
    host: 'localhost',
  },
  plugins: [
    tanstackRouter({
      routesDirectory: resolve(__dirname, 'src/routes'),
      generatedRouteTree: resolve(__dirname, 'src/routeTree.gen.ts'),
    }),
    react(),
    tailwindcss(),
    tsconfigPaths(),
  ],
  build: {
    outDir: '../dist/test-app',
    emptyOutDir: true,
    reportCompressedSize: true,
    commonjsOptions: {
      transformMixedEsModules: true,
    },
  },
  test: {
    name: '@proj/test-app',
    watch: false,
    globals: true,
    environment: 'jsdom',
    include: ['{src,tests}/**/*.{test,spec}.{js,mjs,cjs,ts,mts,cts,jsx,tsx}'],
    reporters: ['default'],
    coverage: {
      reportsDirectory: './test-output/vitest/coverage',
      provider: 'v8' as const,
    },
    passWithNoTests: true,
  },
}));
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > tsconfig.base.json 1`] = `
"{
  "compilerOptions": {
    "paths": {
      ":proj/test-app": ["test-app/src/index.ts"],
      ":proj/common-constructs": ["packages/common/constructs/src/index.ts"]
    },
    "baseUrl": ".",
    "rootDir": "."
  }
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > tsconfig.json 1`] = `
"{
  "references": [
    {
      "path": "./test-app"
    },
    {
      "path": "./packages/common/constructs"
    }
  ]
}
"
`;

exports[`react-website generator > Tanstack router integration > should generate website with router correctly > vitest.workspace.ts 1`] = `
"export default [
  '**/vite.config.{mjs,js,ts,mts}',
  '**/vitest.config.{mjs,js,ts,mts}',
];
"
`;

exports[`react-website generator > should configure TypeScript correctly > tsconfig.json 1`] = `
{
  "compilerOptions": {
    "module": "Preserve",
    "moduleResolution": "Bundler",
  },
  "extends": "../tsconfig.base.json",
  "files": [],
  "include": [],
  "references": [
    {
      "path": "./tsconfig.app.json",
    },
    {
      "path": "./tsconfig.spec.json",
    },
  ],
}
`;

exports[`react-website generator > should configure vite correctly > vite.config.ts 1`] = `
"import tailwindcss from '@tailwindcss/vite';
import tsconfigPaths from 'vite-tsconfig-paths';
import { resolve } from 'path';
import { tanstackRouter } from '@tanstack/router-plugin/vite';
/// <reference types='vitest' />
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig(() => ({
  define: {
    global: {},
  },
  root: __dirname,
  cacheDir: '../node_modules/.vite/test-app',
  server: {
    port: 4200,
    host: 'localhost',
  },
  preview: {
    port: 4300,
    host: 'localhost',
  },
  plugins: [
    tanstackRouter({
      routesDirectory: resolve(__dirname, 'src/routes'),
      generatedRouteTree: resolve(__dirname, 'src/routeTree.gen.ts'),
    }),
    react(),
    tailwindcss(),
    tsconfigPaths(),
  ],
  build: {
    outDir: '../dist/test-app',
    emptyOutDir: true,
    reportCompressedSize: true,
    commonjsOptions: {
      transformMixedEsModules: true,
    },
  },
  test: {
    name: '@proj/test-app',
    watch: false,
    globals: true,
    environment: 'jsdom',
    include: ['{src,tests}/**/*.{test,spec}.{js,mjs,cjs,ts,mts,cts,jsx,tsx}'],
    reporters: ['default'],
    coverage: {
      reportsDirectory: './test-output/vitest/coverage',
      provider: 'v8' as const,
    },
    passWithNoTests: true,
  },
}));
"
`;

exports[`react-website generator > should generate base files and structure > app-layout.tsx 1`] = `
"import * as React from 'react';
import { createContext, useCallback, useEffect, useState } from 'react';
import Config from '../../config';

import {
  BreadcrumbGroup,
  BreadcrumbGroupProps,
  SideNavigation,
  TopNavigation,
} from '@cloudscape-design/components';
import CloudscapeAppLayout, {
  AppLayoutProps,
} from '@cloudscape-design/components/app-layout';
import { matchByPath, useLocation, useNavigate } from '@tanstack/react-router';

const getBreadcrumbs = (
  pathName: string,
  search: string,
  defaultBreadcrumb: string,
  availableRoutes?: string[],
) => {
  const segments = [
    defaultBreadcrumb,
    ...pathName.split('/').filter((segment) => segment !== ''),
  ];

  return segments.map((segment, i) => {
    const href =
      i === 0
        ? '/'
        : \`/\${segments
            .slice(1, i + 1)
            .join('/')
            .replace('//', '/')}\`;

    const matched =
      !availableRoutes || availableRoutes.find((r) => matchByPath(r, href, {}));

    return {
      href: matched ? \`\${href}\${search}\` : '#',
      text: segment,
    };
  });
};

export interface AppLayoutContext {
  appLayoutProps: AppLayoutProps;
  setAppLayoutProps: (props: AppLayoutProps) => void;
  displayHelpPanel: (helpContent: React.ReactNode) => void;
}

/**
 * Context for updating/retrieving the AppLayout.
 */
export const AppLayoutContext = createContext({
  appLayoutProps: {},
  // eslint-disable-next-line @typescript-eslint/no-empty-function
  setAppLayoutProps: (_: AppLayoutProps) => {},
  // eslint-disable-next-line @typescript-eslint/no-empty-function
  displayHelpPanel: (_: React.ReactNode) => {},
});

/**
 * Defines the App layout and contains logic for routing.
 */
const AppLayout: React.FC<React.PropsWithChildren> = ({ children }) => {
  const appLayout = React.useRef<AppLayoutProps.Ref>(null);
  const [appLayoutProps, setAppLayoutProps] = useState<AppLayoutProps>({});
  const setAppLayoutPropsSafe = useCallback(
    (props: AppLayoutProps) => {
      JSON.stringify(appLayoutProps) !== JSON.stringify(props) &&
        setAppLayoutProps(props);
    },
    [appLayoutProps],
  );

  const navigate = useNavigate();
  const [activeBreadcrumbs, setActiveBreadcrumbs] = useState<
    BreadcrumbGroupProps.Item[]
  >([{ text: '/', href: '/' }]);
  const { pathname, search } = useLocation();

  useEffect(() => {
    const breadcrumbs = getBreadcrumbs(
      pathname,
      Object.entries(search).reduce((p, [k, v]) => p + \`\${k}=\${v}\`, ''),
      '/',
    );
    setActiveBreadcrumbs(breadcrumbs);
  }, [pathname, search]);

  const onNavigate = useCallback(
    (e: CustomEvent<{ href: string; external?: boolean }>) => {
      if (!e.detail.external) {
        e.preventDefault();
        setAppLayoutPropsSafe({
          contentType: undefined,
        });
        navigate({ to: e.detail.href });
      }
    },
    [navigate, setAppLayoutPropsSafe],
  );

  return (
    <AppLayoutContext.Provider
      value={{
        appLayoutProps,
        setAppLayoutProps: setAppLayoutPropsSafe,
        displayHelpPanel: (helpContent: React.ReactNode) => {
          setAppLayoutPropsSafe({ tools: helpContent, toolsHide: false });
          appLayout.current?.openTools();
        },
      }}
    >
      <TopNavigation
        identity={{
          href: '/',
          title: Config.applicationName,
          logo: {
            src: Config.logo,
          },
        }}
      />
      <CloudscapeAppLayout
        ref={appLayout}
        breadcrumbs={
          <BreadcrumbGroup onFollow={onNavigate} items={activeBreadcrumbs} />
        }
        navigation={
          <SideNavigation
            header={{ text: Config.applicationName, href: '/' }}
            activeHref={pathname}
            onFollow={onNavigate}
            items={[{ text: 'Home', type: 'link', href: '/' }]}
          />
        }
        toolsHide
        content={children}
        {...appLayoutProps}
      />
    </AppLayoutContext.Provider>
  );
};

export default AppLayout;
"
`;

exports[`react-website generator > should generate base files and structure > config.ts 1`] = `
"export default {
  applicationName: 'test-app',
  logo: 'data:image/svg+xml;base64,PCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KDTwhLS0gVXBsb2FkZWQgdG86IFNWRyBSZXBvLCB3d3cuc3ZncmVwby5jb20sIFRyYW5zZm9ybWVkIGJ5OiBTVkcgUmVwbyBNaXhlciBUb29scyAtLT4KPHN2ZyBmaWxsPSIjMjQ4YmFlIiB3aWR0aD0iODAwcHgiIGhlaWdodD0iODAwcHgiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0cm9rZT0iIzI0OGJhZSI+Cg08ZyBpZD0iU1ZHUmVwb19iZ0NhcnJpZXIiIHN0cm9rZS13aWR0aD0iMCIvPgoNPGcgaWQ9IlNWR1JlcG9fdHJhY2VyQ2FycmllciIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+Cg08ZyBpZD0iU1ZHUmVwb19pY29uQ2FycmllciI+Cg08dGl0bGU+aW9uaWNvbnMtdjVfbG9nb3M8L3RpdGxlPgoNPHBhdGggZD0iTTQxMC42NiwxODAuNzJoMHEtNy42Ny0yLjYyLTE1LjQ1LTQuODgsMS4yOS01LjI1LDIuMzgtMTAuNTZjMTEuNy01Ni45LDQuMDUtMTAyLjc0LTIyLjA2LTExNy44My0yNS0xNC40OC02NiwuNjEtMTA3LjM2LDM2LjY5cS02LjEsNS4zNC0xMS45NSwxMS0zLjktMy43Ni04LTcuMzZjLTQzLjM1LTM4LjU4LTg2LjgtNTQuODMtMTEyLjg4LTM5LjY5LTI1LDE0LjUxLTMyLjQzLDU3LjYtMjEuOSwxMTEuNTNxMS41OCw4LDMuNTUsMTUuOTNjLTYuMTUsMS43NS0xMi4wOSwzLjYyLTE3Ljc3LDUuNkM0OC40NiwxOTguOSwxNiwyMjYuNzMsMTYsMjU1LjU5YzAsMjkuODIsMzQuODQsNTkuNzIsODcuNzcsNzcuODVxNi40NCwyLjE5LDEzLDQuMDdRMTE0LjY0LDM0NiwxMTMsMzU0LjY4Yy0xMCw1My0yLjIsOTUuMDcsMjIuNzUsMTA5LjQ5LDI1Ljc3LDE0Ljg5LDY5LS40MSwxMTEuMTQtMzcuMzFxNS00LjM4LDEwLTkuMjUsNi4zMiw2LjExLDEzLDExLjg2YzQwLjgsMzUuMTgsODEuMDksNDkuMzksMTA2LDM0LjkzLDI1Ljc1LTE0Ljk0LDM0LjEyLTYwLjE0LDIzLjI1LTExNS4xM3EtMS4yNS02LjMtMi44OC0xMi44Niw0LjU2LTEuMzUsOC45My0yLjc5YzU1LTE4LjI3LDkwLjgzLTQ3LjgxLDkwLjgzLTc4QzQ5NiwyMjYuNjIsNDYyLjUsMTk4LjYxLDQxMC42NiwxODAuNzJabS0xMjktODEuMDhjMzUuNDMtMzAuOTEsNjguNTUtNDMuMTEsODMuNjUtMzQuMzloMGMxNi4wNyw5LjI5LDIyLjMyLDQ2Ljc1LDEyLjIyLDk1Ljg4cS0xLDQuOC0yLjE2LDkuNTdhNDg3LjgzLDQ4Ny44MywwLDAsMC02NC4xOC0xMC4xNiw0ODEuMjcsNDgxLjI3LDAsMCwwLTQwLjU3LTUwLjc1UTI3NiwxMDQuNTcsMjgxLjY0LDk5LjY0Wk0xNTcuNzMsMjgwLjI1cTYuNTEsMTIuNiwxMy42MSwyNC44OSw3LjIzLDEyLjU0LDE1LjA3LDI0LjcxYTQzNS4yOCw0MzUuMjgsMCwwLDEtNDQuMjQtNy4xM0MxNDYuNDEsMzA5LDE1MS42MywyOTQuNzUsMTU3LjczLDI4MC4yNVptMC00OC4zM2MtNi0xNC4xOS0xMS4wOC0yOC4xNS0xNS4yNS00MS42MywxMy43LTMuMDcsMjguMy01LjU4LDQzLjUyLTcuNDhxLTcuNjUsMTEuOTQtMTQuNzIsMjQuMjNUMTU3LjcsMjMxLjkyWm0xMC45LDI0LjE3cTkuNDgtMTkuNzcsMjAuNDItMzguNzhoMHExMC45My0xOSwyMy4yNy0zNy4xM2MxNC4yOC0xLjA4LDI4LjkyLTEuNjUsNDMuNzEtMS42NXMyOS41Mi41Nyw0My43OSwxLjY2cTEyLjIxLDE4LjA5LDIzLjEzLDM3dDIwLjY5LDM4LjZRMzM0LDI3NS42MywzMjMsMjk0LjczaDBxLTEwLjkxLDE5LTIzLDM3LjI0Yy0xNC4yNSwxLTI5LDEuNTUtNDQsMS41NXMtMjkuNDctLjQ3LTQzLjQ2LTEuMzhxLTEyLjQzLTE4LjE5LTIzLjQ2LTM3LjI5VDE2OC42LDI1Ni4wOVpNMzQwLjc1LDMwNXE3LjI1LTEyLjU4LDEzLjkyLTI1LjQ5aDBhNDQwLjQxLDQ0MC40MSwwLDAsMSwxNi4xMiw0Mi4zMkE0MzQuNDQsNDM0LjQ0LDAsMCwxLDMyNiwzMjkuNDhRMzMzLjYyLDMxNy4zOSwzNDAuNzUsMzA1Wm0xMy43Mi03My4wN3EtNi42NC0xMi42NS0xMy44MS0yNWgwcS03LTEyLjE4LTE0LjU5LTI0LjA2YzE1LjMxLDEuOTQsMzAsNC41Miw0My43Nyw3LjY3QTQzOS44OSw0MzkuODksMCwwLDEsMzU0LjQ3LDIzMS45M1pNMjU2LjIzLDEyNC40OGgwYTQzOS43NSw0MzkuNzUsMCwwLDEsMjguMjUsMzQuMThxLTI4LjM1LTEuMzUtNTYuNzQsMEMyMzcuMDcsMTQ2LjMyLDI0Ni42MiwxMzQuODcsMjU2LjIzLDEyNC40OFpNMTQ1LjY2LDY1Ljg2YzE2LjA2LTkuMzIsNTEuNTcsNCw4OSwzNy4yNywyLjM5LDIuMTMsNC44LDQuMzYsNy4yLDYuNjdBNDkxLjM3LDQ5MS4zNywwLDAsMCwyMDEsMTYwLjUxYTQ5OS4xMiw0OTkuMTIsMCwwLDAtNjQuMDYsMTBxLTEuODMtNy4zNi0zLjMtMTQuODJoMEMxMjQuNTksMTA5LjQ2LDEzMC41OCw3NC42MSwxNDUuNjYsNjUuODZaTTEyMi4yNSwzMTcuNzFxLTYtMS43MS0xMS44NS0zLjcxYy0yMy40LTgtNDIuNzMtMTguNDQtNTYtMjkuODFDNDIuNTIsMjc0LDM2LjUsMjYzLjgzLDM2LjUsMjU1LjU5YzAtMTcuNTEsMjYuMDYtMzkuODUsNjkuNTItNTVxOC4xOS0yLjg1LDE2LjUyLTUuMjFhNDkzLjU0LDQ5My41NCwwLDAsMCwyMy40LDYwLjc1QTUwMi40Niw1MDIuNDYsMCwwLDAsMTIyLjI1LDMxNy43MVptMTExLjEzLDkzLjY3Yy0xOC42MywxNi4zMi0zNy4yOSwyNy44OS01My43NCwzMy43MmgwYy0xNC43OCw1LjIzLTI2LjU1LDUuMzgtMzMuNjYsMS4yNy0xNS4xNC04Ljc1LTIxLjQ0LTQyLjU0LTEyLjg1LTg3Ljg2cTEuNTMtOCwzLjUtMTZhNDgwLjg1LDQ4MC44NSwwLDAsMCw2NC42OSw5LjM5LDUwMS4yLDUwMS4yLDAsMCwwLDQxLjIsNTFDMjM5LjU0LDQwNS44MywyMzYuNDksNDA4LjY1LDIzMy4zOCw0MTEuMzhabTIzLjQyLTIzLjIyYy05LjcyLTEwLjUxLTE5LjQyLTIyLjE0LTI4Ljg4LTM0LjY0cTEzLjc5LjU0LDI4LjA4LjU0YzkuNzgsMCwxOS40Ni0uMjEsMjktLjY0QTQzOS4zMyw0MzkuMzMsMCwwLDEsMjU2LjgsMzg4LjE2Wm0xMjQuNTIsMjguNTljLTIuODYsMTUuNDQtOC42MSwyNS43NC0xNS43MiwyOS44Ni0xNS4xMyw4Ljc4LTQ3LjQ4LTIuNjMtODIuMzYtMzIuNzItNC0zLjQ0LTgtNy4xMy0xMi4wNy0xMWE0ODQuNTQsNDg0LjU0LDAsMCwwLDQwLjIzLTUxLjIsNDc3Ljg0LDQ3Ny44NCwwLDAsMCw2NS0xMC4wNXExLjQ3LDUuOTQsMi42LDExLjY0aDBDMzgzLjgxLDM3Ny41OCwzODQuNSwzOTkuNTYsMzgxLjMyLDQxNi43NVptMTcuNC0xMDIuNjRoMGMtMi42Mi44Ny01LjMyLDEuNzEtOC4wNiwyLjUzYTQ4My4yNiw0ODMuMjYsMCwwLDAtMjQuMzEtNjAuOTQsNDgxLjUyLDQ4MS41MiwwLDAsMCwyMy4zNi02MC4wNmM0LjkxLDEuNDMsOS42OCwyLjkzLDE0LjI3LDQuNTIsNDQuNDIsMTUuMzIsNzEuNTIsMzgsNzEuNTIsNTUuNDNDNDc1LjUsMjc0LjE5LDQ0Ni4yMywyOTguMzMsMzk4LjcyLDMxNC4xMVoiLz4KDTxwYXRoIGQ9Ik0yNTYsMjk4LjU1YTQzLDQzLDAsMSwwLTQyLjg2LTQzQTQyLjkxLDQyLjkxLDAsMCwwLDI1NiwyOTguNTVaIi8+Cg08L2c+Cg08L3N2Zz4=',
};
"
`;

exports[`react-website generator > should generate base files and structure > index.tsx 1`] = `
"import {
  ContentLayout,
  Header,
  SpaceBetween,
  Container,
} from '@cloudscape-design/components';
import { createFileRoute } from '@tanstack/react-router';

export const Route = createFileRoute('/')({
  component: RouteComponent,
});

function RouteComponent() {
  return (
    <ContentLayout header={<Header>Welcome</Header>}>
      <SpaceBetween size="l">
        <Container>Welcome to your new React website!</Container>
      </SpaceBetween>
    </ContentLayout>
  );
}
"
`;

exports[`react-website generator > should generate base files and structure > main.tsx 1`] = `
"import React from 'react';
import { createRoot } from 'react-dom/client';
import { I18nProvider } from '@cloudscape-design/components/i18n';
import messages from '@cloudscape-design/components/i18n/messages/all.en';
import '@cloudscape-design/global-styles/index.css';
import { RouterProvider, createRouter } from '@tanstack/react-router';
import { routeTree } from './routeTree.gen';

// eslint-disable-next-line @typescript-eslint/no-empty-object-type
export type RouterProviderContext = {};

const router = createRouter({
  routeTree,
  context: {},
});

// Register the router instance for type safety
declare module '@tanstack/react-router' {
  interface Register {
    router: typeof router;
  }
}

const App = () => {
  return <RouterProvider router={router} context={{}} />;
};

const root = document.getElementById('root');
root &&
  createRoot(root).render(
    <React.StrictMode>
      <I18nProvider locale="en" messages={[messages]}>
        <App />
      </I18nProvider>
    </React.StrictMode>,
  );
"
`;

exports[`react-website generator > should generate shared constructs > common/constructs-app-index.ts 1`] = `
"export * from './test-app.js';
"
`;

exports[`react-website generator > should generate shared constructs > common/constructs-core-index.ts 1`] = `
"export * from './static-website.js';
export * from './app.js';
export * from './runtime-config.js';
"
`;

exports[`react-website generator > should generate shared constructs > common/constructs-core-static-website.ts 1`] = `
"import { CfnOutput, RemovalPolicy, Stack } from 'aws-cdk-lib';
import { Distribution, ViewerProtocolPolicy } from 'aws-cdk-lib/aws-cloudfront';
import { S3BucketOrigin } from 'aws-cdk-lib/aws-cloudfront-origins';
import {
  BlockPublicAccess,
  Bucket,
  BucketEncryption,
  IBucket,
  ObjectOwnership,
} from 'aws-cdk-lib/aws-s3';
import { BucketDeployment, Source } from 'aws-cdk-lib/aws-s3-deployment';
import { Construct } from 'constructs';
import { RuntimeConfig } from './runtime-config.js';
import { Key } from 'aws-cdk-lib/aws-kms';
import { CfnWebACL } from 'aws-cdk-lib/aws-wafv2';
const DEFAULT_RUNTIME_CONFIG_FILENAME = 'runtime-config.json';

export interface StaticWebsiteProps {
  readonly websiteName: string;
  readonly websiteFilePath: string;
}

/**
 * Deploys a Static Website using by default a private S3 bucket as an origin and Cloudfront as the entrypoint.
 *
 * This construct configures a webAcl containing rules that are generally applicable to web applications. This
 * provides protection against exploitation of a wide range of vulnerabilities, including some of the high risk
 * and commonly occurring vulnerabilities described in OWASP publications such as OWASP Top 10.
 *
 */
export class StaticWebsite extends Construct {
  public readonly websiteBucket: IBucket;
  public readonly cloudFrontDistribution: Distribution;
  public readonly bucketDeployment: BucketDeployment;

  constructor(
    scope: Construct,
    id: string,
    { websiteFilePath, websiteName }: StaticWebsiteProps,
  ) {
    super(scope, id);
    this.node.setContext(
      '@aws-cdk/aws-s3:serverAccessLogsUseBucketPolicy',
      true,
    );

    const websiteKey = new Key(this, 'WebsiteKey', {
      enableKeyRotation: true,
    });

    const accessLogsBucket = new Bucket(this, 'AccessLogsBucket', {
      versioned: false,
      enforceSSL: true,
      autoDeleteObjects: true,
      removalPolicy: RemovalPolicy.DESTROY,
      encryption: BucketEncryption.KMS,
      encryptionKey: websiteKey,
      objectOwnership: ObjectOwnership.OBJECT_WRITER,
      publicReadAccess: false,
      blockPublicAccess: BlockPublicAccess.BLOCK_ALL,
    });
    // S3 Bucket to hold website files
    this.websiteBucket = new Bucket(this, 'WebsiteBucket', {
      versioned: true,
      enforceSSL: true,
      autoDeleteObjects: true,
      removalPolicy: RemovalPolicy.DESTROY,
      encryption: BucketEncryption.KMS,
      encryptionKey: websiteKey,
      objectOwnership: ObjectOwnership.BUCKET_OWNER_ENFORCED,
      publicReadAccess: false,
      blockPublicAccess: BlockPublicAccess.BLOCK_ALL,
      serverAccessLogsPrefix: 'website-access-logs',
      serverAccessLogsBucket: accessLogsBucket,
    });
    // Web ACL
    const wafStack = new CloudfrontWebAcl(this, 'waf');

    // Cloudfront Distribution
    const logBucket = new Bucket(this, 'DistributionLogBucket', {
      enforceSSL: true,
      autoDeleteObjects: true,
      removalPolicy: RemovalPolicy.DESTROY,
      encryption: BucketEncryption.KMS,
      encryptionKey: websiteKey,
      objectOwnership: ObjectOwnership.BUCKET_OWNER_PREFERRED,
      publicReadAccess: false,
      blockPublicAccess: BlockPublicAccess.BLOCK_ALL,
      serverAccessLogsPrefix: 'distribution-access-logs',
      serverAccessLogsBucket: accessLogsBucket,
    });
    const defaultRootObject = 'index.html';
    this.cloudFrontDistribution = new Distribution(
      this,
      'CloudfrontDistribution',
      {
        webAclId: wafStack.wafArn,
        enableLogging: true,
        logBucket: logBucket,
        defaultBehavior: {
          origin: S3BucketOrigin.withOriginAccessControl(this.websiteBucket),
          viewerProtocolPolicy: ViewerProtocolPolicy.REDIRECT_TO_HTTPS,
        },
        defaultRootObject,
        errorResponses: [
          {
            httpStatus: 404, // We need to redirect "key not found errors" to index.html for single page apps
            responseHttpStatus: 200,
            responsePagePath: \`/\${defaultRootObject}\`,
          },
          {
            httpStatus: 403, // We need to redirect reloads from paths (e.g. /foo/bar) to index.html for single page apps
            responseHttpStatus: 200,
            responsePagePath: \`/\${defaultRootObject}\`,
          },
        ],
      },
    );
    // Deploy Website
    this.bucketDeployment = new BucketDeployment(this, 'WebsiteDeployment', {
      sources: [
        Source.asset(websiteFilePath),
        Source.jsonData(
          DEFAULT_RUNTIME_CONFIG_FILENAME,
          RuntimeConfig.ensure(this).config,
        ),
      ],
      destinationBucket: this.websiteBucket,
      // Files in the distribution's edge caches will be invalidated after files are uploaded to the destination bucket.
      distribution: this.cloudFrontDistribution,
      memoryLimit: 1024,
    });
    new CfnOutput(this, 'DistributionDomainName', {
      value: this.cloudFrontDistribution.domainName,
    });
    new CfnOutput(this, \`\${websiteName}WebsiteBucketName\`, {
      value: this.websiteBucket.bucketName,
    });
  }
}

export class CloudfrontWebAcl extends Stack {
  public readonly wafArn;
  constructor(scope: Construct, id: string) {
    super(scope, id, {
      env: {
        region: 'us-east-1',
        account: Stack.of(scope).account,
      },
      crossRegionReferences: true,
    });

    this.wafArn = new CfnWebACL(this, 'WebAcl', {
      defaultAction: { allow: {} },
      scope: 'CLOUDFRONT',
      visibilityConfig: {
        cloudWatchMetricsEnabled: true,
        metricName: id,
        sampledRequestsEnabled: true,
      },
      rules: [
        {
          name: 'CRSRule',
          priority: 0,
          statement: {
            managedRuleGroupStatement: {
              name: 'AWSManagedRulesCommonRuleSet',
              vendorName: 'AWS',
            },
          },
          visibilityConfig: {
            cloudWatchMetricsEnabled: true,
            metricName: 'MetricForWebACLCDK-CRS',
            sampledRequestsEnabled: true,
          },
          overrideAction: {
            none: {},
          },
        },
      ],
    }).attrArn;
  }
}
"
`;

exports[`react-website generator > should generate shared constructs > test-app.ts 1`] = `
"import * as url from 'url';
import { Construct } from 'constructs';
import { StaticWebsite } from '../../core/index.js';

export class TestApp extends StaticWebsite {
  constructor(scope: Construct, id: string) {
    super(scope, id, {
      websiteName: 'TestApp',
      websiteFilePath: url.fileURLToPath(
        new URL('../../../../../../dist/test-app/bundle', import.meta.url),
      ),
    });
  }
}
"
`;

exports[`react-website generator > should handle custom directory option > custom-dir-main.tsx 1`] = `
"import React from 'react';
import { createRoot } from 'react-dom/client';
import { I18nProvider } from '@cloudscape-design/components/i18n';
import messages from '@cloudscape-design/components/i18n/messages/all.en';
import '@cloudscape-design/global-styles/index.css';
import { RouterProvider, createRouter } from '@tanstack/react-router';
import { routeTree } from './routeTree.gen';

// eslint-disable-next-line @typescript-eslint/no-empty-object-type
export type RouterProviderContext = {};

const router = createRouter({
  routeTree,
  context: {},
});

// Register the router instance for type safety
declare module '@tanstack/react-router' {
  interface Register {
    router: typeof router;
  }
}

const App = () => {
  return <RouterProvider router={router} context={{}} />;
};

const root = document.getElementById('root');
root &&
  createRoot(root).render(
    <React.StrictMode>
      <I18nProvider locale="en" messages={[messages]}>
        <App />
      </I18nProvider>
    </React.StrictMode>,
  );
"
`;

exports[`react-website generator > should handle npm scope prefix correctly > scoped-dependencies 1`] = `
{
  "@cloudscape-design/board-components": "3.0.117",
  "@cloudscape-design/components": "3.0.1075",
  "@cloudscape-design/global-styles": "1.0.45",
  "@tanstack/react-router": "1.131.28",
  "aws-cdk-lib": "2.213.0",
  "constructs": "10.4.2",
  "react": "19.0.0",
  "react-dom": "19.0.0",
  "tailwindcss": "4.1.12",
}
`;
