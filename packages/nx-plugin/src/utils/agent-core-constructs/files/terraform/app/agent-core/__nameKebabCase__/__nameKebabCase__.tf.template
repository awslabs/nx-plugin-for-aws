variable "env" {
  description = "Environment variables to pass to the agent core runtime"
  type        = map(string)
  default     = {}
}

variable "additional_iam_policy_statements" {
  description = "Additional IAM policy statements to attach to the agent core runtime role"
  type = list(object({
    Effect   = string
    Action   = list(string)
    Resource = list(string)
  }))
  default = []
}

variable "tags" {
  description = "Tags to apply to resources"
  type        = map(string)
  default     = {}
}

module "agent_core_runtime" {
  source = "../../../core/agent-core"
  agent_runtime_name = "<%= nameClassName %>"
  docker_image_tag = "<%= dockerImageTag %>"
  server_protocol = "<%= serverProtocol %>"
#  customJWTAuthorizer = {
#    discoveryUrl = "https://xxx/.well-known/openid-configuration",
#    allowedClients = [ "xxx" ]
#  }

  env = var.env
  additional_iam_policy_statements = var.additional_iam_policy_statements
  tags = var.tags
}

output "agent_core_runtime_role_arn" {
  description = "ARN of the agent core runtime role"
  value       = module.agent_core_runtime.agent_core_runtime_role_arn
}
